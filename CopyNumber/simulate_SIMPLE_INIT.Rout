
R version 4.3.3 (2024-02-29) -- "Angel Food Cake"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(patchwork)
> library(loo)
This is loo version 2.8.0
- Online documentation and vignettes at mc-stan.org/loo
- As of v2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the 'cores' argument or set options(mc.cores = NUM_CORES) for an entire session. 
> library(bayesplot)
This is bayesplot version 1.11.1
- Online documentation and vignettes at mc-stan.org/bayesplot
- bayesplot theme set to bayesplot::theme_default()
   * Does _not_ affect other ggplot2 plots
   * See ?bayesplot_theme_set for details on theme setting
> library(cmdstanr)
This is cmdstanr version 0.8.1
- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr
- CmdStan path: /u/cdslab/scocomello/.cmdstan/cmdstan-2.34.1
- CmdStan version: 2.34.1
> library(factoextra)
Loading required package: ggplot2
Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(stringr) #for plotting add in the right script
> library(fossil) #RI and ARI computation
Loading required package: sp
Loading required package: maps
Loading required package: shapefiles
Loading required package: foreign

Attaching package: ‘shapefiles’

The following objects are masked from ‘package:foreign’:

    read.dbf, write.dbf

> library(gridExtra)

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine

> library(ppclust)
> 
> set.seed(133)
> 
> 
> 
> #setwd("C:/Users/sarac/CDS_git/Copy-Number-Timing/CopyNumber/")
> #orfeo
> 
> sim_list = c(0,6,7,8,9,10,11,12,13,14,15)
> number_clocks_list = c(2,2,2,2,3,3,3,3,4,4,4)
> number_events_list = c(6,10,20,30,6,10,20,30,10,20,30)
> epsilon_list = c(0.20,0.20,0.20,0.20,0.20,0.20,0.20,0.20,0.15,0.15,0.15)
> for (i in (1:length(sim_list))) {
+ 
+ 
+ 
+ 
+     # setwd("D:/scratch/Copy_Number_Timing/CopyNumber")
+     setwd("/orfeo/cephfs/scratch/cdslab/scocomello/Copy_Number_Timing/CopyNumber")
+ 
+     original_dir <- getwd()
+ 
+     source("./CNTiming/R/simulate_functions.R")
+     source("./CNTiming/R/fitting_functions.R")
+     source("./CNTiming/R/plotting_functions.R")
+ 
+ 
+     self_name = as.character(sim_list[i])
+     new_dir = paste0("../",self_name) #relative path of the new created directory where to save the simulation results
+     dir.create(new_dir)
+ 
+     number_events = number_events_list[i]
+     number_clocks = number_clocks_list[i]
+ 
+     INIT = TRUE
+     epsilon = epsilon_list[i]
+     n_simulations = 20
+     purity = 0.99
+ 
+     vector_karyo <- c("2:0", "2:1", "2:2")
+     weights_karyo <- c(0.33, 0.33, 0.33)
+ 
+ 
+     # get simulation parametes
+     coverage = 100 # average number of reads that align to a reference base
+     mu = 1e-4 # mutation rate
+     w = 1e-2 # cell division rate
+     l = 1e7 # length of the segment
+     time_interval = 20
+ 
+ 
+     options(bitmapType='cairo')
+ 
+ 
+ 
+ 
+     for(i in 1:n_simulations){
+       # Create a unique directory for each iteration
+       iter_dir <- paste0("/simulation_iteration_", i)
+       iter_dir <- paste0(new_dir,iter_dir)
+       dir.create(iter_dir)
+       setwd(iter_dir)
+       dir.create(paste0("./plots"), showWarnings = TRUE)
+       dir.create(paste0("./results"), showWarnings = FALSE)
+       
+       
+ 
+       vector_tau = rep(0, number_clocks)
+       
+       for (j in 1:number_clocks){
+         vector_tau[j] = runif(1, 0)
+         if (j != 1){
+           while (!all ( abs(vector_tau[1:j-1] - vector_tau[j]) > epsilon  )   ){
+             vector_tau[j] = runif(1, 0)
+           }
+         }
+       }
+       weights_tau <- rep(1/number_clocks, number_clocks)
+       
+       data <- get_taus_karyo(number_events, vector_tau, vector_karyo, weights_tau, weights_karyo)
+       simulation_data_all_segments = get_simulation(data$taus, data$karyo, purity, coverage = 100) # the other parameters have default value assigned if none is specified
+       simulation_data_all_segments <- simulation_data_all_segments[order(simulation_data_all_segments$segment_id), ]
+ 
+ 
+       saveRDS(simulation_data_all_segments, "./results/all_sim_input_prepare_input_data.rds")
+ 
+ 
+ 
+       
+       Subtitle <- vector("list", (length(unique(simulation_data_all_segments$segment_id))+1))
+       Subtitle[[1]]  <- paste0("Number of mutations per segment: ")
+       num_mutations_all_segments <- c()
+ 
+         for (i in seq_along(unique(simulation_data_all_segments$segment_id))) {
+         segment <- unique(simulation_data_all_segments$segment_id)[i]
+         num_mutations <- nrow(simulation_data_all_segments %>% filter(segment_id == segment))
+         num_mutations_all_segments <- c(num_mutations_all_segments, num_mutations)
+         Subtitle[[i+1]] <- paste0(segment, "=", num_mutations," ")
+       }
+       
+       Subtitle <- paste(Subtitle, collapse = "   ")
+       cat(Subtitle)
+ 
+       mean_mut <- mean(num_mutations_all_segments)
+       max_mut <- max(num_mutations_all_segments)
+       min_mut <- min(num_mutations_all_segments)
+ 
+       Subtitle_short <- paste0("Mutations per segment: average =", mean_mut, ",  min = ", min_mut, ", max = ", max_mut )
+ 
+ 
+       #add statistics on number of mutations from the simulation
+       
+       simulation_params <- list(
+         vector_tau = vector_tau,
+         vector_karyo = vector_karyo,
+         weights_tau = weights_tau,
+         weights_karyo = weights_karyo,
+         taus = data$taus,
+         karyo = data$karyo,
+         purity = purity,
+         number_events = number_events, # = nrow(vector-tau) / nrow(vector_karyo)
+         number_clocks = number_clocks, # = unique(vector_tau)
+         epsilon = epsilon
+       )
+ 
+ 
+ 
+       simulation_data_plot = simulation_data_all_segments %>% mutate (tau = round(tau, 2))
+       plot_data <- simulation_data_plot %>% 
+         ggplot(mapping = aes(x = NV / DP, fill = segment_name)) +
+         geom_histogram(alpha = .5, position = "identity") +
+         labs(
+           title = "Distribution on the VAF for each segment in the simulated data",
+           subtitle = paste0(Subtitle_short)
+         )+
+         facet_wrap(vars(karyotype, tau, segment_name), scales = "free_x", strip.position = "bottom") +
+         theme_minimal() +
+         theme(
+         panel.background = element_rect(fill = "white", color = NA),  # White panel background
+         plot.background = element_rect(fill = "white", color = NA),   # White plot background
+         strip.background = element_rect(fill = "white", color = NA),  # White strip background
+         strip.placement = "outside",   # Place facet labels outside
+         axis.text.x = element_text(angle = 360, hjust = 1, color = "black", size = 8),  # Rotate and adjust x-axis text
+         axis.ticks.x = element_line(color = "black"),  # Black x-axis ticks
+         panel.spacing = unit(1, "lines"),  # Adjust space between facets
+         strip.text.x = element_text(size = 10, color = "black"),  # Adjust and color strip text
+         axis.line = element_line(color = "black"),  # Black axis lines
+         axis.title.x = element_text(color = "black"),  # Black x-axis title
+         axis.title.y = element_text(color = "black")   # Black y-axis title
+       )+
+        xlim(0, 1)
+ 
+ 
+       #save plot of the simulated data in which we can see each single segment VAF distribution
+       ggsave("./plots/simulation_data.png", plot = plot_data, width = 12 + simulation_params$number_events, height = 10 + simulation_params$number_events + (simulation_params$number_events/1.3), limitsize = FALSE,   device = png) 
+       #simulation_params can be substituted in relation with simulation_data variables
+       
+       
+       #in fit model selection best K the plots for each K inference is directly saved 
+       results <- fit_model_selection_best_K(simulation_data_all_segments, data$karyo, purity, INIT = INIT, simulation_params = simulation_params)
+       saveRDS(results, paste0("./results/results_simulation",i,".rds"))
+       
+ 
+       
+       
+       
+       model_selection_plot = plotting_model_selection(results)
+       model_selection_plot
+       ggsave("./plots/model_selection_plot.png", plot = model_selection_plot, width = 12, height = 10,  device = png)
+       
+       model_selection <- results$model_selection_tibble
+       saveRDS(model_selection, "./results/model_selection.rds")
+       
+ 
+       
+       setwd(original_dir)
+       
+     }
+ 
+ }
Loading required package: StanHeaders

rstan version 2.32.6 (Stan version 2.32.2)

For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)
For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,
change `threads_per_chain` option:
rstan_options(threads_per_chain = 1)


Attaching package: ‘tidyr’

The following object is masked from ‘package:rstan’:

    extract


Attaching package: ‘matrixStats’

The following object is masked from ‘package:dplyr’:

    count

Number of mutations per segment:    1=289    2=226    3=440    4=316    5=286    6=404 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
w = 1
  w = 1
  w = 1
  w = 1
  w = 1
  w = 1
 tau = 0.68299177068126
 phi = 1
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002115 seconds 
1000 transitions using 10 leapfrog steps per transition would take 21.15 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6291.473             1.000            1.000 
     2        -6055.382             0.519            1.000 
     3        -6046.203             0.347            0.039 
     4        -6048.995             0.260            0.039 
     5        -6048.066             0.208            0.002 
     6        -6048.014             0.174            0.002 
     7        -6040.772             0.149            0.001 
     8        -6044.296             0.130            0.001 
     9        -6042.614             0.116            0.001 
    10        -6040.711             0.104            0.001 
    11        -6039.225             0.095            0.000 
    12        -6040.108             0.087            0.000 
    13        -6039.171             0.080            0.000 
    14        -6038.654             0.075            0.000 
    15        -6039.108             0.070            0.000 
    16        -6036.828             0.065            0.000 
    17        -6037.472             0.061            0.000 
    18        -6035.540             0.058            0.000 
    19        -6035.397             0.055            0.000 
    20        -6035.458             0.052            0.000 
    21        -6035.079             0.050            0.000 
    22        -6035.552             0.048            0.000 
    23        -6034.310             0.045            0.000 
    24        -6034.774             0.044            0.000 
    25        -6035.131             0.042            0.000 
    26        -6034.611             0.040            0.000 
    27        -6032.583             0.039            0.000 
    28        -6035.233             0.037            0.000 
    29        -6033.864             0.036            0.000 
    30        -6035.534             0.035            0.000 
    31        -6033.962             0.034            0.000 
    32        -6031.812             0.033            0.000 
    33        -6033.212             0.032            0.000 
    34        -6032.324             0.031            0.000 
    35        -6032.629             0.030            0.000 
    36        -6032.943             0.029            0.000 
    37        -6035.926             0.028            0.000 
    38        -6033.965             0.028            0.000 
    39        -6032.783             0.027            0.000 
    40        -6032.424             0.026            0.000 
    41        -6034.588             0.026            0.000 
    42        -6032.628             0.025            0.000 
    43        -6031.339             0.024            0.000 
    44        -6031.732             0.024            0.000 
    45        -6031.856             0.023            0.000 
    46        -6032.009             0.023            0.000 
    47        -6032.869             0.022            0.000 
    48        -6031.456             0.022            0.000 
    49        -6031.640             0.021            0.000 
    50        -6031.337             0.021            0.000 
    51        -6031.546             0.021            0.000 
    52        -6034.027             0.020            0.000 
    53        -6031.432             0.020            0.000 
    54        -6034.635             0.019            0.000 
    55        -6033.027             0.019            0.000 
    56        -6031.586             0.019            0.000 
    57        -6031.305             0.018            0.000 
    58        -6031.771             0.018            0.000 
    59        -6031.898             0.018            0.000 
    60        -6033.053             0.018            0.000 
    61        -6031.458             0.017            0.000 
    62        -6031.181             0.017            0.000 
    63        -6030.775             0.017            0.000 
    64        -6031.192             0.016            0.000 
    65        -6031.093             0.016            0.000 
    66        -6031.218             0.016            0.000 
    67        -6030.844             0.016            0.000 
    68        -6030.653             0.015            0.000 
    69        -6030.494             0.015            0.000 
    70        -6031.542             0.015            0.000 
    71        -6030.982             0.015            0.000 
    72        -6030.449             0.015            0.000 
    73        -6030.839             0.014            0.000 
    74        -6031.294             0.014            0.000 
    75        -6032.623             0.014            0.000 
    76        -6032.497             0.014            0.000 
    77        -6030.791             0.014            0.000 
    78        -6030.810             0.014            0.000 
    79        -6030.340             0.013            0.000 
    80        -6030.781             0.013            0.000 
    81        -6030.836             0.013            0.000 
    82        -6031.111             0.013            0.000 
    83        -6030.682             0.013            0.000 
    84        -6030.341             0.013            0.000 
    85        -6030.920             0.012            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  14.3 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.6829918

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -6046.2
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.001923 seconds 
1000 transitions using 10 leapfrog steps per transition would take 19.23 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6203.150             1.000            1.000 
     2        -6136.987             0.505            1.000 
     3        -6060.139             0.341            0.013 
     4        -6043.396             0.257            0.013 
     5        -6040.328             0.205            0.011 
     6        -6038.763             0.171            0.011 
     7        -6036.187             0.147            0.003 
     8        -6051.498             0.129            0.003 
     9        -6038.833             0.115            0.003 
    10        -6038.318             0.103            0.003 
    11        -6036.527             0.094            0.002 
    12        -6035.858             0.086            0.002 
    13        -6041.132             0.079            0.001 
    14        -6034.928             0.074            0.001 
    15        -6034.652             0.069            0.001 
    16        -6036.317             0.065            0.001 
    17        -6033.265             0.061            0.001 
    18        -6032.465             0.058            0.001 
    19        -6036.500             0.055            0.001 
    20        -6032.986             0.052            0.001 
    21        -6032.766             0.049            0.001 
    22        -6031.816             0.047            0.001 
    23        -6032.814             0.045            0.001 
    24        -6031.943             0.043            0.001 
    25        -6034.447             0.042            0.000 
    26        -6034.044             0.040            0.000 
    27        -6031.045             0.038            0.000 
    28        -6032.148             0.037            0.000 
    29        -6033.827             0.036            0.000 
    30        -6031.779             0.035            0.000 
    31        -6032.798             0.034            0.000 
    32        -6030.987             0.032            0.000 
    33        -6033.258             0.032            0.000 
    34        -6031.994             0.031            0.000 
    35        -6031.002             0.030            0.000 
    36        -6031.732             0.029            0.000 
    37        -6030.882             0.028            0.000 
    38        -6031.292             0.027            0.000 
    39        -6031.989             0.027            0.000 
    40        -6030.719             0.026            0.000 
    41        -6031.103             0.025            0.000 
    42        -6030.725             0.025            0.000 
    43        -6031.092             0.024            0.000 
    44        -6030.905             0.024            0.000 
    45        -6031.588             0.023            0.000 
    46        -6037.207             0.023            0.000 
    47        -6032.860             0.022            0.000 
    48        -6031.452             0.022            0.000 
    49        -6030.759             0.021            0.000 
    50        -6031.020             0.021            0.000 
    51        -6030.769             0.020            0.000 
    52        -6030.622             0.020            0.000 
    53        -6030.829             0.020            0.000 
    54        -6031.146             0.019            0.000 
    55        -6030.652             0.019            0.000 
    56        -6030.599             0.019            0.000 
    57        -6030.386             0.018            0.000 
    58        -6030.673             0.018            0.000 
    59        -6030.676             0.018            0.000 
    60        -6031.055             0.017            0.000 
    61        -6031.129             0.017            0.000 
    62        -6031.366             0.017            0.000 
    63        -6031.714             0.017            0.000 
    64        -6031.438             0.016            0.000 
    65        -6031.194             0.016            0.000 
    66        -6030.349             0.016            0.000 
    67        -6030.660             0.016            0.000 
    68        -6032.206             0.015            0.000 
    69        -6032.768             0.015            0.000 
    70        -6031.219             0.015            0.000 
    71        -6031.553             0.015            0.000 
    72        -6031.476             0.015            0.000 
    73        -6030.404             0.014            0.000 
    74        -6030.523             0.014            0.000 
    75        -6030.479             0.014            0.000 
    76        -6030.907             0.014            0.000 
    77        -6030.310             0.014            0.000 
    78        -6031.028             0.013            0.000 
    79        -6031.826             0.013            0.000 
    80        -6030.820             0.013            0.000 
    81        -6030.569             0.013            0.000 
    82        -6030.507             0.013            0.000 
    83        -6030.206             0.013            0.000 
    84        -6030.211             0.012            0.000 
    85        -6030.625             0.012            0.000 
    86        -6030.487             0.012            0.000 
    87        -6030.819             0.012            0.000 
    88        -6030.378             0.012            0.000 
    89        -6031.334             0.012            0.000 
    90        -6033.877             0.012            0.000 
    91        -6030.440             0.012            0.000 
    92        -6030.310             0.011            0.000 
    93        -6030.591             0.011            0.000 
    94        -6030.340             0.011            0.000 
    95        -6030.287             0.011            0.000 
    96        -6030.775             0.011            0.000 
    97        -6031.385             0.011            0.000 
    98        -6031.292             0.011            0.000 
    99        -6030.633             0.011            0.000 
   100        -6030.269             0.010            0.000 
   101        -6030.578             0.010            0.000 
   102        -6030.398             0.010            0.000 
   103        -6030.753             0.010            0.000 
   104        -6031.700             0.010            0.000 
   105        -6030.779             0.010            0.000 
   106        -6030.646             0.010            0.000 
   107        -6030.449             0.010            0.000 
   108        -6030.317             0.010            0.000 
   109        -6030.283             0.010            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  16.1 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.6829918

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -6060.14
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.001796 seconds 
1000 transitions using 10 leapfrog steps per transition would take 17.96 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6089.243             1.000            1.000 
     2        -6658.289             0.543            1.000 
     3        -6051.054             0.395            0.100 
     4        -6045.492             0.297            0.100 
     5        -6045.785             0.237            0.085 
     6        -6043.410             0.198            0.085 
     7        -6042.772             0.170            0.001 
     8        -6038.135             0.149            0.001 
     9        -6040.897             0.132            0.001 
    10        -6040.719             0.119            0.001 
    11        -6036.469             0.108            0.001 
    12        -6038.123             0.099            0.001 
    13        -6036.668             0.092            0.000 
    14        -6038.126             0.085            0.000 
    15        -6036.263             0.079            0.000 
    16        -6033.625             0.074            0.000 
    17        -6036.601             0.070            0.000 
    18        -6035.669             0.066            0.000 
    19        -6036.866             0.063            0.000 
    20        -6034.185             0.060            0.000 
    21        -6035.162             0.057            0.000 
    22        -6036.526             0.054            0.000 
    23        -6037.220             0.052            0.000 
    24        -6034.803             0.050            0.000 
    25        -6032.774             0.048            0.000 
    26        -6034.231             0.046            0.000 
    27        -6035.065             0.044            0.000 
    28        -6033.741             0.043            0.000 
    29        -6033.473             0.041            0.000 
    30        -6033.901             0.040            0.000 
    31        -6033.538             0.039            0.000 
    32        -6032.822             0.037            0.000 
    33        -6031.941             0.036            0.000 
    34        -6032.572             0.035            0.000 
    35        -6031.884             0.034            0.000 
    36        -6032.313             0.033            0.000 
    37        -6031.671             0.032            0.000 
    38        -6033.773             0.031            0.000 
    39        -6032.462             0.031            0.000 
    40        -6032.164             0.030            0.000 
    41        -6031.010             0.029            0.000 
    42        -6032.452             0.028            0.000 
    43        -6031.284             0.028            0.000 
    44        -6032.237             0.027            0.000 
    45        -6031.181             0.027            0.000 
    46        -6031.784             0.026            0.000 
    47        -6035.092             0.025            0.000 
    48        -6032.370             0.025            0.000 
    49        -6031.474             0.024            0.000 
    50        -6031.865             0.024            0.000 
    51        -6031.511             0.023            0.000 
    52        -6031.376             0.023            0.000 
    53        -6031.326             0.023            0.000 
    54        -6031.455             0.022            0.000 
    55        -6030.767             0.022            0.000 
    56        -6032.280             0.021            0.000 
    57        -6030.502             0.021            0.000 
    58        -6031.227             0.021            0.000 
    59        -6031.076             0.020            0.000 
    60        -6032.151             0.020            0.000 
    61        -6031.785             0.020            0.000 
    62        -6034.315             0.019            0.000 
    63        -6030.664             0.019            0.000 
    64        -6030.959             0.019            0.000 
    65        -6030.569             0.018            0.000 
    66        -6031.295             0.018            0.000 
    67        -6030.599             0.018            0.000 
    68        -6030.089             0.018            0.000 
    69        -6030.410             0.017            0.000 
    70        -6031.340             0.017            0.000 
    71        -6031.066             0.017            0.000 
    72        -6030.341             0.017            0.000 
    73        -6031.104             0.016            0.000 
    74        -6030.978             0.016            0.000 
    75        -6033.011             0.016            0.000 
    76        -6031.384             0.016            0.000 
    77        -6031.404             0.016            0.000 
    78        -6030.371             0.015            0.000 
    79        -6030.566             0.015            0.000 
    80        -6030.633             0.015            0.000 
    81        -6031.905             0.015            0.000 
    82        -6030.578             0.015            0.000 
    83        -6030.397             0.014            0.000 
    84        -6030.356             0.014            0.000 
    85        -6031.006             0.014            0.000 
    86        -6030.416             0.014            0.000 
    87        -6030.513             0.014            0.000 
    88        -6030.740             0.014            0.000 
    89        -6031.135             0.014            0.000 
    90        -6033.177             0.013            0.000 
    91        -6032.802             0.013            0.000 
    92        -6031.087             0.013            0.000 
    93        -6030.281             0.013            0.000 
    94        -6030.467             0.013            0.000 
    95        -6030.299             0.013            0.000 
    96        -6030.607             0.013            0.000 
    97        -6030.440             0.012            0.000 
    98        -6030.391             0.012            0.000 
    99        -6030.731             0.012            0.000 
   100        -6030.795             0.012            0.000 
   101        -6030.753             0.012            0.000 
   102        -6031.463             0.012            0.000 
   103        -6031.352             0.012            0.000 
   104        -6030.493             0.012            0.000 
   105        -6030.844             0.011            0.000 
   106        -6030.607             0.011            0.000 
   107        -6030.443             0.011            0.000 
   108        -6031.270             0.011            0.000 
   109        -6030.159             0.011            0.000 
   110        -6030.654             0.011            0.000 
   111        -6031.421             0.011            0.000 
   112        -6031.489             0.011            0.000 
   113        -6030.463             0.011            0.000 
   114        -6030.277             0.011            0.000 
   115        -6031.257             0.010            0.000 
   116        -6031.346             0.010            0.000 
   117        -6030.447             0.010            0.000 
   118        -6030.650             0.010            0.000 
   119        -6030.322             0.010            0.000 
   120        -6030.370             0.010            0.000 
   121        -6030.464             0.010            0.000 
   122        -6030.860             0.010            0.000 
   123        -6030.494             0.010            0.000 
   124        -6030.563             0.010            0.000 
   125        -6030.348             0.010            0.000 
   126        -6030.308             0.010            0.000 
   127        -6030.621             0.009            0.000 
   128        -6030.450             0.009            0.000 
   129        -6030.991             0.009            0.000 
   130        -6031.389             0.009            0.000 
   131        -6031.572             0.009            0.000 
   132        -6030.589             0.009            0.000 
   133        -6030.796             0.009            0.000 
   134        -6030.872             0.009            0.000 
   135        -6030.323             0.009            0.000 
   136        -6030.480             0.009            0.000 
   137        -6030.406             0.009            0.000 
   138        -6030.330             0.009            0.000 
   139        -6030.803             0.009            0.000 
   140        -6030.405             0.009            0.000 
   141        -6031.164             0.009            0.000 
   142        -6031.207             0.008            0.000 
   143        -6030.324             0.008            0.000 
   144        -6030.644             0.008            0.000 
   145        -6030.396             0.008            0.000 
   146        -6030.724             0.008            0.000 
   147        -6030.236             0.008            0.000 
   148        -6030.783             0.008            0.000 
   149        -6030.659             0.008            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  19.1 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.6829918

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -6051.05
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.001805 seconds 
1000 transitions using 10 leapfrog steps per transition would take 18.05 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6220.679             1.000            1.000 
     2        -6200.090             0.502            1.000 
     3        -6060.996             0.342            0.023 
     4        -6047.468             0.257            0.023 
     5        -6043.885             0.206            0.003 
     6        -6047.392             0.172            0.003 
     7        -6040.560             0.147            0.002 
     8        -6039.257             0.129            0.002 
     9        -6042.420             0.115            0.001 
    10        -6039.339             0.103            0.001 
    11        -6036.662             0.094            0.001 
    12        -6038.058             0.086            0.001 
    13        -6036.342             0.079            0.001 
    14        -6034.271             0.074            0.001 
    15        -6041.485             0.069            0.001 
    16        -6037.411             0.065            0.001 
    17        -6036.094             0.061            0.001 
    18        -6033.719             0.058            0.001 
    19        -6039.119             0.055            0.001 
    20        -6034.118             0.052            0.001 
    21        -6034.722             0.049            0.001 
    22        -6036.131             0.047            0.001 
    23        -6035.746             0.045            0.001 
    24        -6034.847             0.043            0.001 
    25        -6034.877             0.042            0.001 
    26        -6034.688             0.040            0.001 
    27        -6034.025             0.038            0.000 
    28        -6033.387             0.037            0.000 
    29        -6032.847             0.036            0.000 
    30        -6033.285             0.035            0.000 
    31        -6034.153             0.034            0.000 
    32        -6035.047             0.032            0.000 
    33        -6034.360             0.031            0.000 
    34        -6033.684             0.031            0.000 
    35        -6034.239             0.030            0.000 
    36        -6033.296             0.029            0.000 
    37        -6034.984             0.028            0.000 
    38        -6034.365             0.027            0.000 
    39        -6032.895             0.027            0.000 
    40        -6034.383             0.026            0.000 
    41        -6033.742             0.025            0.000 
    42        -6038.244             0.025            0.000 
    43        -6032.396             0.024            0.000 
    44        -6031.561             0.024            0.000 
    45        -6031.805             0.023            0.000 
    46        -6031.533             0.023            0.000 
    47        -6031.323             0.022            0.000 
    48        -6031.866             0.022            0.000 
    49        -6031.591             0.021            0.000 
    50        -6033.650             0.021            0.000 
    51        -6031.745             0.020            0.000 
    52        -6031.550             0.020            0.000 
    53        -6035.226             0.020            0.000 
    54        -6034.235             0.019            0.000 
    55        -6031.625             0.019            0.000 
    56        -6031.938             0.019            0.000 
    57        -6031.280             0.018            0.000 
    58        -6031.988             0.018            0.000 
    59        -6031.618             0.018            0.000 
    60        -6030.816             0.017            0.000 
    61        -6031.132             0.017            0.000 
    62        -6033.083             0.017            0.000 
    63        -6030.727             0.017            0.000 
    64        -6030.639             0.016            0.000 
    65        -6030.681             0.016            0.000 
    66        -6031.122             0.016            0.000 
    67        -6032.328             0.016            0.000 
    68        -6031.010             0.015            0.000 
    69        -6031.673             0.015            0.000 
    70        -6030.526             0.015            0.000 
    71        -6030.508             0.015            0.000 
    72        -6030.539             0.015            0.000 
    73        -6030.304             0.014            0.000 
    74        -6031.614             0.014            0.000 
    75        -6030.741             0.014            0.000 
    76        -6030.367             0.014            0.000 
    77        -6033.091             0.014            0.000 
    78        -6030.595             0.013            0.000 
    79        -6030.482             0.013            0.000 
    80        -6030.601             0.013            0.000 
    81        -6031.013             0.013            0.000 
    82        -6031.083             0.013            0.000 
    83        -6030.606             0.013            0.000 
    84        -6031.449             0.012            0.000 
    85        -6030.872             0.012            0.000 
    86        -6031.354             0.012            0.000 
    87        -6031.105             0.012            0.000 
    88        -6030.773             0.012            0.000 
    89        -6030.271             0.012            0.000 
    90        -6030.519             0.012            0.000 
    91        -6030.982             0.012            0.000 
    92        -6032.187             0.011            0.000 
    93        -6031.330             0.011            0.000 
    94        -6031.735             0.011            0.000 
    95        -6030.609             0.011            0.000 
    96        -6030.914             0.011            0.000 
    97        -6030.390             0.011            0.000 
    98        -6030.588             0.011            0.000 
    99        -6030.645             0.011            0.000 
   100        -6031.005             0.010            0.000 
   101        -6030.314             0.010            0.000 
   102        -6030.480             0.010            0.000 
   103        -6030.962             0.010            0.000 
   104        -6030.817             0.010            0.000 
   105        -6030.485             0.010            0.000 
   106        -6030.621             0.010            0.000 
   107        -6030.701             0.010            0.000 
   108        -6030.168             0.010            0.000 
   109        -6030.473             0.010            0.000 
   110        -6030.805             0.010            0.000 
   111        -6031.142             0.009            0.000 
   112        -6030.678             0.009            0.000 
   113        -6031.361             0.009            0.000 
   114        -6030.542             0.009            0.000 
   115        -6030.748             0.009            0.000 
   116        -6030.788             0.009            0.000 
   117        -6031.044             0.009            0.000 
   118        -6030.401             0.009            0.000 
   119        -6030.494             0.009            0.000 
   120        -6030.209             0.009            0.000 
   121        -6030.784             0.009            0.000 
   122        -6031.872             0.009            0.000 
   123        -6031.340             0.009            0.000 
   124        -6031.816             0.008            0.000 
   125        -6030.720             0.008            0.000 
   126        -6030.600             0.008            0.000 
   127        -6030.632             0.008            0.000 
   128        -6030.428             0.008            0.000 
   129        -6030.311             0.008            0.000 
   130        -6030.488             0.008            0.000 
   131        -6030.415             0.008            0.000 
   132        -6030.652             0.008            0.000 
   133        -6030.472             0.008            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  18.1 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.6829918

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -6061
 mode of lp__ = unnormalized_log_lik = -6029.34last value = -6028.93 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -6029.34last value = -6028.93 dimension of lp__ = 1
 mode of lp_approx after rowSums = -1.49129 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -1.49129 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-6027.66003last value = -6026.89717dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-6027.66003last value = -6026.89717dimension of log_lik = 1896
[1] "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1"
[1] "post 1" "post 1" "post 1" "post 1" "post 1" "post 1"
[1] "post_k 1"
[1] "post_k_entr 0.000280999859476977" "post_k_entr 0.000218999890482057"
[3] "post_k_entr 0.000425999786965096" "post_k_entr 0.000308999845474683"
[5] "post_k_entr 0.000274999862477468" "post_k_entr 0.000385999806968374"
[1] "post_k_entr last step -0.00189599905184465"
[1] "res_entropy last step -0.00189599905184465"
[1] "entropy -0.00189599905184465"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=281    segment 2=219    segment 3=426    segment 4=309    segment 5=275    segment 6=386 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=289    2=226    3=440    4=316    5=286    6=404 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
w = 0.00280133561124954
  w = 0.999564463875791
  w = 0.999738910172734
  w = 0.00525531812003945
  w = 0.000905759337595715
  w = 0.998840913449026
  w = 0.99719866438875
  w = 0.000435536124208931
  w = 0.000261089827266229
  w = 0.994744681879961
  w = 0.999094240662404
  w = 0.00115908655097415
 tau = 0.8414539838361
  tau = 0.524582540308217
 phi = 0.5
  phi = 0.5
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003186 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.86 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6120.618             1.000            1.000 
     2        -6178.958             0.505            1.000 
     3        -5985.603             0.347            0.032 
     4        -5949.440             0.262            0.032 
     5        -5940.146             0.210            0.009 
     6        -5940.763             0.175            0.009 
     7        -5940.140             0.150            0.006 
     8        -5938.875             0.131            0.006 
     9        -5937.141             0.117            0.002 
    10        -5938.157             0.105            0.002 
    11        -5937.486             0.095            0.000 
    12        -5937.117             0.088            0.000 
    13        -5935.718             0.081            0.000 
    14        -5934.749             0.075            0.000 
    15        -5935.300             0.070            0.000 
    16        -5935.925             0.066            0.000 
    17        -5935.129             0.062            0.000 
    18        -5935.254             0.058            0.000 
    19        -5936.358             0.055            0.000 
    20        -5936.430             0.053            0.000 
    21        -5935.107             0.050            0.000 
    22        -5934.522             0.048            0.000 
    23        -5933.785             0.046            0.000 
    24        -5933.174             0.044            0.000 
    25        -5934.134             0.042            0.000 
    26        -5933.151             0.040            0.000 
    27        -5933.917             0.039            0.000 
    28        -5932.048             0.038            0.000 
    29        -5932.557             0.036            0.000 
    30        -5932.520             0.035            0.000 
    31        -5932.737             0.034            0.000 
    32        -5932.873             0.033            0.000 
    33        -5931.279             0.032            0.000 
    34        -5933.103             0.031            0.000 
    35        -5932.348             0.030            0.000 
    36        -5932.322             0.029            0.000 
    37        -5933.543             0.028            0.000 
    38        -5934.167             0.028            0.000 
    39        -5932.331             0.027            0.000 
    40        -5931.717             0.026            0.000 
    41        -5932.546             0.026            0.000 
    42        -5932.500             0.025            0.000 
    43        -5932.041             0.025            0.000 
    44        -5931.673             0.024            0.000 
    45        -5931.533             0.023            0.000 
    46        -5932.464             0.023            0.000 
    47        -5932.055             0.022            0.000 
    48        -5932.015             0.022            0.000 
    49        -5931.305             0.022            0.000 
    50        -5932.465             0.021            0.000 
    51        -5931.849             0.021            0.000 
    52        -5931.469             0.020            0.000 
    53        -5933.498             0.020            0.000 
    54        -5934.074             0.020            0.000 
    55        -5932.920             0.019            0.000 
    56        -5931.532             0.019            0.000 
    57        -5931.686             0.019            0.000 
    58        -5931.219             0.018            0.000 
    59        -5931.331             0.018            0.000 
    60        -5931.557             0.018            0.000 
    61        -5932.169             0.017            0.000 
    62        -5931.361             0.017            0.000 
    63        -5931.422             0.017            0.000 
    64        -5932.568             0.017            0.000 
    65        -5931.728             0.016            0.000 
    66        -5933.013             0.016            0.000 
    67        -5931.751             0.016            0.000 
    68        -5931.048             0.016            0.000 
    69        -5930.977             0.015            0.000 
    70        -5931.037             0.015            0.000 
    71        -5931.753             0.015            0.000 
    72        -5932.499             0.015            0.000 
    73        -5931.246             0.014            0.000 
    74        -5931.684             0.014            0.000 
    75        -5932.072             0.014            0.000 
    76        -5931.577             0.014            0.000 
    77        -5931.252             0.014            0.000 
    78        -5931.241             0.014            0.000 
    79        -5932.185             0.013            0.000 
    80        -5931.739             0.013            0.000 
    81        -5930.702             0.013            0.000 
    82        -5931.749             0.013            0.000 
    83        -5931.496             0.013            0.000 
    84        -5930.995             0.013            0.000 
    85        -5931.979             0.012            0.000 
    86        -5931.175             0.012            0.000 
    87        -5931.778             0.012            0.000 
    88        -5932.923             0.012            0.000 
    89        -5932.316             0.012            0.000 
    90        -5931.823             0.012            0.000 
    91        -5931.028             0.012            0.000 
    92        -5931.928             0.012            0.000 
    93        -5930.922             0.011            0.000 
    94        -5931.538             0.011            0.000 
    95        -5932.943             0.011            0.000 
    96        -5931.752             0.011            0.000 
    97        -5931.814             0.011            0.000 
    98        -5932.408             0.011            0.000 
    99        -5932.409             0.011            0.000 
   100        -5932.549             0.011            0.000 
   101        -5931.630             0.011            0.000 
   102        -5932.191             0.010            0.000 
   103        -5932.843             0.010            0.000 
   104        -5931.120             0.010            0.000 
   105        -5931.198             0.010            0.000 
   106        -5932.698             0.010            0.000 
   107        -5932.492             0.010            0.000 
   108        -5932.157             0.010            0.000 
   109        -5932.107             0.010            0.000 
   110        -5931.323             0.010            0.000 
   111        -5930.775             0.010            0.000 
   112        -5932.175             0.009            0.000 
   113        -5931.715             0.009            0.000 
   114        -5931.270             0.009            0.000 
   115        -5931.350             0.009            0.000 
   116        -5931.991             0.009            0.000 
   117        -5932.118             0.009            0.000 
   118        -5931.907             0.009            0.000 
   119        -5932.015             0.009            0.000 
   120        -5932.226             0.009            0.000 
   121        -5931.627             0.009            0.000 
   122        -5932.108             0.009            0.000 
   123        -5931.221             0.009            0.000 
   124        -5931.236             0.009            0.000 
   125        -5930.691             0.009            0.000 
   126        -5932.163             0.008            0.000 
   127        -5931.952             0.008            0.000 
   128        -5932.146             0.008            0.000 
   129        -5931.099             0.008            0.000 
   130        -5930.942             0.008            0.000 
   131        -5931.516             0.008            0.000 
   132        -5931.060             0.008            0.000 
   133        -5931.699             0.008            0.000 
   134        -5931.433             0.008            0.000 
   135        -5931.470             0.008            0.000 
   136        -5931.868             0.008            0.000 
   137        -5931.118             0.008            0.000 
   138        -5931.695             0.008            0.000 
   139        -5932.109             0.008            0.000 
   140        -5931.517             0.008            0.000 
   141        -5931.086             0.008            0.000 
   142        -5931.647             0.007            0.000 
   143        -5931.247             0.007            0.000 
   144        -5931.322             0.007            0.000 
   145        -5931.435             0.007            0.000 
   146        -5931.657             0.007            0.000 
   147        -5930.862             0.007            0.000 
   148        -5931.386             0.007            0.000 
   149        -5931.177             0.007            0.000 
   150        -5931.457             0.007            0.000 
   151        -5931.038             0.007            0.000 
   152        -5931.224             0.007            0.000 
   153        -5931.221             0.007            0.000 
   154        -5931.332             0.007            0.000 
   155        -5932.142             0.007            0.000 
   156        -5932.289             0.007            0.000 
   157        -5930.744             0.007            0.000 
   158        -5931.616             0.007            0.000 
   159        -5930.695             0.007            0.000 
   160        -5931.426             0.007            0.000 
   161        -5931.669             0.007            0.000 
   162        -5931.210             0.007            0.000 
   163        -5931.070             0.007            0.000 
   164        -5932.743             0.007            0.000 
   165        -5932.146             0.006            0.000 
   166        -5931.610             0.006            0.000 
   167        -5932.118             0.006            0.000 
   168        -5931.154             0.006            0.000 
   169        -5931.680             0.006            0.000 
   170        -5932.239             0.006            0.000 
   171        -5931.099             0.006            0.000 
   172        -5931.241             0.006            0.000 
   173        -5931.448             0.006            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  67.0 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553181 0.9947446819
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5985.6
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003199 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.99 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6109.216             1.000            1.000 
     2        -6022.145             0.507            1.000 
     3        -5959.344             0.342            0.014 
     4        -5951.736             0.257            0.014 
     5        -5951.985             0.205            0.011 
     6        -5949.863             0.171            0.011 
     7        -5946.409             0.147            0.001 
     8        -5941.385             0.129            0.001 
     9        -5942.851             0.114            0.001 
    10        -5940.889             0.103            0.001 
    11        -5941.258             0.094            0.001 
    12        -5940.643             0.086            0.001 
    13        -5938.964             0.079            0.000 
    14        -5937.592             0.074            0.000 
    15        -5938.646             0.069            0.000 
    16        -5937.464             0.064            0.000 
    17        -5937.468             0.061            0.000 
    18        -5936.399             0.057            0.000 
    19        -5935.664             0.054            0.000 
    20        -5935.663             0.052            0.000 
    21        -5933.657             0.049            0.000 
    22        -5934.101             0.047            0.000 
    23        -5934.132             0.045            0.000 
    24        -5934.349             0.043            0.000 
    25        -5934.861             0.041            0.000 
    26        -5933.171             0.040            0.000 
    27        -5936.876             0.038            0.000 
    28        -5934.727             0.037            0.000 
    29        -5934.278             0.036            0.000 
    30        -5934.325             0.034            0.000 
    31        -5933.945             0.033            0.000 
    32        -5933.355             0.032            0.000 
    33        -5933.984             0.031            0.000 
    34        -5933.401             0.030            0.000 
    35        -5932.811             0.029            0.000 
    36        -5933.317             0.029            0.000 
    37        -5933.534             0.028            0.000 
    38        -5932.909             0.027            0.000 
    39        -5932.874             0.026            0.000 
    40        -5932.118             0.026            0.000 
    41        -5933.261             0.025            0.000 
    42        -5932.121             0.025            0.000 
    43        -5932.310             0.024            0.000 
    44        -5931.877             0.023            0.000 
    45        -5933.584             0.023            0.000 
    46        -5932.132             0.022            0.000 
    47        -5932.411             0.022            0.000 
    48        -5932.690             0.022            0.000 
    49        -5932.472             0.021            0.000 
    50        -5932.732             0.021            0.000 
    51        -5931.472             0.020            0.000 
    52        -5933.022             0.020            0.000 
    53        -5932.618             0.020            0.000 
    54        -5933.186             0.019            0.000 
    55        -5932.612             0.019            0.000 
    56        -5932.129             0.018            0.000 
    57        -5933.174             0.018            0.000 
    58        -5931.883             0.018            0.000 
    59        -5931.754             0.018            0.000 
    60        -5931.139             0.017            0.000 
    61        -5931.106             0.017            0.000 
    62        -5931.416             0.017            0.000 
    63        -5931.898             0.016            0.000 
    64        -5932.059             0.016            0.000 
    65        -5934.467             0.016            0.000 
    66        -5930.880             0.016            0.000 
    67        -5932.138             0.015            0.000 
    68        -5931.761             0.015            0.000 
    69        -5931.888             0.015            0.000 
    70        -5931.902             0.015            0.000 
    71        -5931.616             0.015            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  30.5 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553181 0.9947446819
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5959.34
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003208 seconds 
1000 transitions using 10 leapfrog steps per transition would take 32.08 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6047.477             1.000            1.000 
     2        -6071.129             0.502            1.000 
     3        -6014.044             0.338            0.009 
     4        -5953.423             0.256            0.010 
     5        -5942.779             0.205            0.009 
     6        -5941.941             0.171            0.009 
     7        -5940.577             0.147            0.004 
     8        -5942.334             0.128            0.004 
     9        -5943.129             0.114            0.002 
    10        -5939.522             0.103            0.002 
    11        -5939.154             0.093            0.001 
    12        -5937.267             0.086            0.001 
    13        -5936.526             0.079            0.000 
    14        -5936.577             0.073            0.000 
    15        -5937.222             0.068            0.000 
    16        -5937.460             0.064            0.000 
    17        -5936.646             0.060            0.000 
    18        -5935.522             0.057            0.000 
    19        -5934.840             0.054            0.000 
    20        -5934.607             0.051            0.000 
    21        -5934.480             0.049            0.000 
    22        -5933.841             0.047            0.000 
    23        -5933.638             0.045            0.000 
    24        -5937.427             0.043            0.000 
    25        -5934.737             0.041            0.000 
    26        -5934.468             0.040            0.000 
    27        -5932.783             0.038            0.000 
    28        -5933.551             0.037            0.000 
    29        -5933.377             0.036            0.000 
    30        -5933.365             0.034            0.000 
    31        -5934.368             0.033            0.000 
    32        -5934.186             0.032            0.000 
    33        -5935.520             0.031            0.000 
    34        -5934.581             0.030            0.000 
    35        -5933.660             0.029            0.000 
    36        -5933.499             0.029            0.000 
    37        -5933.365             0.028            0.000 
    38        -5931.801             0.027            0.000 
    39        -5933.031             0.026            0.000 
    40        -5932.620             0.026            0.000 
    41        -5933.391             0.025            0.000 
    42        -5932.826             0.025            0.000 
    43        -5931.833             0.024            0.000 
    44        -5932.692             0.023            0.000 
    45        -5932.032             0.023            0.000 
    46        -5931.409             0.022            0.000 
    47        -5932.129             0.022            0.000 
    48        -5932.966             0.022            0.000 
    49        -5934.314             0.021            0.000 
    50        -5933.858             0.021            0.000 
    51        -5931.935             0.020            0.000 
    52        -5932.953             0.020            0.000 
    53        -5931.682             0.019            0.000 
    54        -5931.658             0.019            0.000 
    55        -5932.469             0.019            0.000 
    56        -5931.069             0.018            0.000 
    57        -5932.444             0.018            0.000 
    58        -5932.325             0.018            0.000 
    59        -5932.296             0.018            0.000 
    60        -5933.611             0.017            0.000 
    61        -5932.488             0.017            0.000 
    62        -5932.016             0.017            0.000 
    63        -5931.647             0.016            0.000 
    64        -5932.045             0.016            0.000 
    65        -5931.553             0.016            0.000 
    66        -5931.757             0.016            0.000 
    67        -5932.660             0.015            0.000 
    68        -5932.138             0.015            0.000 
    69        -5933.141             0.015            0.000 
    70        -5932.099             0.015            0.000 
    71        -5933.175             0.015            0.000 
    72        -5934.126             0.014            0.000 
    73        -5932.810             0.014            0.000 
    74        -5932.193             0.014            0.000 
    75        -5931.636             0.014            0.000 
    76        -5931.908             0.014            0.000 
    77        -5932.059             0.013            0.000 
    78        -5932.243             0.013            0.000 
    79        -5931.570             0.013            0.000 
    80        -5932.154             0.013            0.000 
    81        -5932.203             0.013            0.000 
    82        -5933.149             0.013            0.000 
    83        -5932.029             0.012            0.000 
    84        -5931.731             0.012            0.000 
    85        -5931.974             0.012            0.000 
    86        -5931.537             0.012            0.000 
    87        -5931.539             0.012            0.000 
    88        -5932.453             0.012            0.000 
    89        -5933.404             0.012            0.000 
    90        -5931.583             0.012            0.000 
    91        -5931.770             0.011            0.000 
    92        -5932.026             0.011            0.000 
    93        -5931.844             0.011            0.000 
    94        -5932.509             0.011            0.000 
    95        -5931.860             0.011            0.000 
    96        -5931.212             0.011            0.000 
    97        -5931.977             0.011            0.000 
    98        -5932.443             0.011            0.000 
    99        -5931.881             0.010            0.000 
   100        -5931.943             0.010            0.000 
   101        -5931.006             0.010            0.000 
   102        -5931.192             0.010            0.000 
   103        -5931.299             0.010            0.000 
   104        -5932.654             0.010            0.000 
   105        -5931.817             0.010            0.000 
   106        -5931.623             0.010            0.000 
   107        -5931.854             0.010            0.000 
   108        -5931.513             0.010            0.000 
   109        -5931.382             0.010            0.000 
   110        -5931.315             0.009            0.000 
   111        -5931.774             0.009            0.000 
   112        -5931.247             0.009            0.000 
   113        -5931.300             0.009            0.000 
   114        -5931.879             0.009            0.000 
   115        -5931.511             0.009            0.000 
   116        -5932.040             0.009            0.000 
   117        -5931.766             0.009            0.000 
   118        -5931.667             0.009            0.000 
   119        -5931.019             0.009            0.000 
   120        -5931.838             0.009            0.000 
   121        -5932.111             0.009            0.000 
   122        -5931.845             0.009            0.000 
   123        -5931.282             0.008            0.000 
   124        -5932.487             0.008            0.000 
   125        -5931.480             0.008            0.000 
   126        -5931.329             0.008            0.000 
   127        -5931.020             0.008            0.000 
   128        -5931.426             0.008            0.000 
   129        -5931.992             0.008            0.000 
   130        -5931.312             0.008            0.000 
   131        -5931.002             0.008            0.000 
   132        -5931.237             0.008            0.000 
   133        -5931.599             0.008            0.000 
   134        -5931.937             0.008            0.000 
   135        -5930.776             0.008            0.000 
   136        -5931.447             0.008            0.000 
   137        -5931.384             0.008            0.000 
   138        -5932.374             0.008            0.000 
   139        -5930.953             0.007            0.000 
   140        -5932.150             0.007            0.000 
   141        -5932.341             0.007            0.000 
   142        -5932.424             0.007            0.000 
   143        -5931.212             0.007            0.000 
   144        -5931.129             0.007            0.000 
   145        -5931.347             0.007            0.000 
   146        -5931.498             0.007            0.000 
   147        -5930.944             0.007            0.000 
   148        -5932.007             0.007            0.000 
   149        -5931.224             0.007            0.000 
   150        -5932.030             0.007            0.000 
   151        -5931.601             0.007            0.000 
   152        -5931.095             0.007            0.000 
   153        -5932.256             0.007            0.000 
   154        -5931.754             0.007            0.000 
   155        -5932.296             0.007            0.000 
   156        -5931.000             0.007            0.000 
   157        -5931.088             0.007            0.000 
   158        -5931.420             0.007            0.000 
   159        -5931.083             0.007            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  52.5 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553181 0.9947446819
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -6014.04
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003216 seconds 
1000 transitions using 10 leapfrog steps per transition would take 32.16 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6073.568             1.000            1.000 
     2        -5980.477             0.508            1.000 
     3        -5961.102             0.340            0.016 
     4        -5962.672             0.255            0.016 
     5        -5952.055             0.204            0.003 
     6        -5951.753             0.170            0.003 
     7        -5947.598             0.146            0.002 
     8        -5946.204             0.128            0.002 
     9        -5947.282             0.114            0.001 
    10        -5943.674             0.102            0.001 
    11        -5941.644             0.093            0.001 
    12        -5942.554             0.085            0.001 
    13        -5940.458             0.079            0.000 
    14        -5940.675             0.073            0.000 
    15        -5941.011             0.068            0.000 
    16        -5936.688             0.064            0.000 
    17        -5937.993             0.060            0.000 
    18        -5939.503             0.057            0.000 
    19        -5936.983             0.054            0.000 
    20        -5938.329             0.051            0.000 
    21        -5937.701             0.049            0.000 
    22        -5937.964             0.047            0.000 
    23        -5934.935             0.045            0.000 
    24        -5934.903             0.043            0.000 
    25        -5937.277             0.041            0.000 
    26        -5933.903             0.040            0.000 
    27        -5934.986             0.038            0.000 
    28        -5934.277             0.037            0.000 
    29        -5934.794             0.035            0.000 
    30        -5934.812             0.034            0.000 
    31        -5933.971             0.033            0.000 
    32        -5936.540             0.032            0.000 
    33        -5934.777             0.031            0.000 
    34        -5935.429             0.030            0.000 
    35        -5933.436             0.029            0.000 
    36        -5934.030             0.029            0.000 
    37        -5934.174             0.028            0.000 
    38        -5933.303             0.027            0.000 
    39        -5931.315             0.026            0.000 
    40        -5934.722             0.026            0.000 
    41        -5933.932             0.025            0.000 
    42        -5935.090             0.025            0.000 
    43        -5933.958             0.024            0.000 
    44        -5933.987             0.023            0.000 
    45        -5933.612             0.023            0.000 
    46        -5933.526             0.022            0.000 
    47        -5932.361             0.022            0.000 
    48        -5932.848             0.021            0.000 
    49        -5933.986             0.021            0.000 
    50        -5933.244             0.021            0.000 
    51        -5932.106             0.020            0.000 
    52        -5934.343             0.020            0.000 
    53        -5935.197             0.019            0.000 
    54        -5932.903             0.019            0.000 
    55        -5933.208             0.019            0.000 
    56        -5932.764             0.018            0.000 
    57        -5931.978             0.018            0.000 
    58        -5931.881             0.018            0.000 
    59        -5932.751             0.018            0.000 
    60        -5932.705             0.017            0.000 
    61        -5931.691             0.017            0.000 
    62        -5932.203             0.017            0.000 
    63        -5931.591             0.016            0.000 
    64        -5931.119             0.016            0.000 
    65        -5931.902             0.016            0.000 
    66        -5930.852             0.016            0.000 
    67        -5931.384             0.015            0.000 
    68        -5932.041             0.015            0.000 
    69        -5931.256             0.015            0.000 
    70        -5932.762             0.015            0.000 
    71        -5932.317             0.015            0.000 
    72        -5931.437             0.014            0.000 
    73        -5931.469             0.014            0.000 
    74        -5933.207             0.014            0.000 
    75        -5932.234             0.014            0.000 
    76        -5933.453             0.014            0.000 
    77        -5931.652             0.013            0.000 
    78        -5931.490             0.013            0.000 
    79        -5931.301             0.013            0.000 
    80        -5932.234             0.013            0.000 
    81        -5932.004             0.013            0.000 
    82        -5933.079             0.013            0.000 
    83        -5931.620             0.012            0.000 
    84        -5931.373             0.012            0.000 
    85        -5931.635             0.012            0.000 
    86        -5932.725             0.012            0.000 
    87        -5932.268             0.012            0.000 
    88        -5932.090             0.012            0.000 
    89        -5932.594             0.012            0.000 
    90        -5931.583             0.012            0.000 
    91        -5931.377             0.011            0.000 
    92        -5931.157             0.011            0.000 
    93        -5932.686             0.011            0.000 
    94        -5932.293             0.011            0.000 
    95        -5931.433             0.011            0.000 
    96        -5931.931             0.011            0.000 
    97        -5932.145             0.011            0.000 
    98        -5932.156             0.011            0.000 
    99        -5931.328             0.010            0.000 
   100        -5931.591             0.010            0.000 
   101        -5931.891             0.010            0.000 
   102        -5933.164             0.010            0.000 
   103        -5930.721             0.010            0.000 
   104        -5931.188             0.010            0.000 
   105        -5931.729             0.010            0.000 
   106        -5930.991             0.010            0.000 
   107        -5931.403             0.010            0.000 
   108        -5931.876             0.010            0.000 
   109        -5930.928             0.010            0.000 
   110        -5931.719             0.009            0.000 
   111        -5932.557             0.009            0.000 
   112        -5931.025             0.009            0.000 
   113        -5931.023             0.009            0.000 
   114        -5932.165             0.009            0.000 
   115        -5931.091             0.009            0.000 
   116        -5933.340             0.009            0.000 
   117        -5931.450             0.009            0.000 
   118        -5932.452             0.009            0.000 
   119        -5930.557             0.009            0.000 
   120        -5930.758             0.009            0.000 
   121        -5932.484             0.009            0.000 
   122        -5930.880             0.009            0.000 
   123        -5932.350             0.008            0.000 
   124        -5931.922             0.008            0.000 
   125        -5931.714             0.008            0.000 
   126        -5931.240             0.008            0.000 
   127        -5933.471             0.008            0.000 
   128        -5932.230             0.008            0.000 
   129        -5931.955             0.008            0.000 
   130        -5930.964             0.008            0.000 
   131        -5931.292             0.008            0.000 
   132        -5931.406             0.008            0.000 
   133        -5931.695             0.008            0.000 
   134        -5931.011             0.008            0.000 
   135        -5932.776             0.008            0.000 
   136        -5931.895             0.008            0.000 
   137        -5931.108             0.008            0.000 
   138        -5931.151             0.008            0.000 
   139        -5932.233             0.008            0.000 
   140        -5931.135             0.007            0.000 
   141        -5931.235             0.007            0.000 
   142        -5931.974             0.007            0.000 
   143        -5930.983             0.007            0.000 
   144        -5931.299             0.007            0.000 
   145        -5932.349             0.007            0.000 
   146        -5931.380             0.007            0.000 
   147        -5932.018             0.007            0.000 
   148        -5930.772             0.007            0.000 
   149        -5931.115             0.007            0.000 
   150        -5931.011             0.007            0.000 
   151        -5932.026             0.007            0.000 
   152        -5931.733             0.007            0.000 
   153        -5931.196             0.007            0.000 
   154        -5931.555             0.007            0.000 
   155        -5931.714             0.007            0.000 
   156        -5931.835             0.007            0.000 
   157        -5931.549             0.007            0.000 
   158        -5931.276             0.007            0.000 
   159        -5932.380             0.007            0.000 
   160        -5931.799             0.007            0.000 
   161        -5931.653             0.006            0.000 
   162        -5931.275             0.006            0.000 
   163        -5931.811             0.006            0.000 
   164        -5931.696             0.006            0.000 
   165        -5930.864             0.006            0.000 
   166        -5931.553             0.006            0.000 
   167        -5932.032             0.006            0.000 
   168        -5931.375             0.006            0.000 
   169        -5931.794             0.006            0.000 
   170        -5931.976             0.006            0.000 
   171        -5932.754             0.006            0.000 
   172        -5931.234             0.006            0.000 
   173        -5931.905             0.006            0.000 
   174        -5932.010             0.006            0.000 
   175        -5931.119             0.006            0.000 
   176        -5931.890             0.006            0.000 
   177        -5931.699             0.006            0.000 
   178        -5931.595             0.006            0.000 
   179        -5931.383             0.006            0.000 
   180        -5931.512             0.006            0.000 
   181        -5930.970             0.006            0.000 
   182        -5930.663             0.006            0.000 
   183        -5931.743             0.006            0.000 
   184        -5932.493             0.006            0.000 
   185        -5932.108             0.006            0.000 
   186        -5931.325             0.006            0.000 
   187        -5931.524             0.006            0.000 
   188        -5931.016             0.006            0.000 
   189        -5931.222             0.006            0.000 
   190        -5930.638             0.006            0.000 
   191        -5930.781             0.005            0.000 
   192        -5931.182             0.005            0.000 
   193        -5931.685             0.005            0.000 
   194        -5931.400             0.005            0.000 
   195        -5931.223             0.005            0.000 
   196        -5931.629             0.005            0.000 
   197        -5931.349             0.005            0.000 
   198        -5930.912             0.005            0.000 
   199        -5931.067             0.005            0.000 
   200        -5930.710             0.005            0.000 
   201        -5931.030             0.005            0.000 
   202        -5931.328             0.005            0.000 
   203        -5931.801             0.005            0.000 
   204        -5932.139             0.005            0.000 
   205        -5930.496             0.005            0.000 
   206        -5931.480             0.005            0.000 
   207        -5931.194             0.005            0.000 
   208        -5931.757             0.005            0.000 
   209        -5931.047             0.005            0.000 
   210        -5931.483             0.005            0.000 
   211        -5930.948             0.005            0.000 
   212        -5932.026             0.005            0.000 
   213        -5931.125             0.005            0.000 
   214        -5930.901             0.005            0.000 
   215        -5931.442             0.005            0.000 
   216        -5930.908             0.005            0.000 
   217        -5930.931             0.005            0.000 
   218        -5932.093             0.005            0.000 
   219        -5930.815             0.005            0.000 
   220        -5931.047             0.005            0.000 
   221        -5930.887             0.005            0.000 
   222        -5931.514             0.005            0.000 
   223        -5931.529             0.005            0.000 
   224        -5932.077             0.005            0.000 
   225        -5931.426             0.005            0.000 
   226        -5932.150             0.005            0.000 
   227        -5931.290             0.005            0.000 
   228        -5931.664             0.005            0.000 
   229        -5930.782             0.005            0.000 
   230        -5931.666             0.005            0.000 
   231        -5930.880             0.005            0.000 
   232        -5932.252             0.005            0.000 
   233        -5931.479             0.005            0.000 
   234        -5931.077             0.004            0.000 
   235        -5931.376             0.004            0.000 
   236        -5931.389             0.004            0.000 
   237        -5931.278             0.004            0.000 
   238        -5931.076             0.004            0.000 
   239        -5930.844             0.004            0.000 
   240        -5931.247             0.004            0.000 
   241        -5931.782             0.004            0.000 
   242        -5931.124             0.004            0.000 
   243        -5931.862             0.004            0.000 
   244        -5931.076             0.004            0.000 
   245        -5931.093             0.004            0.000 
   246        -5931.616             0.004            0.000 
   247        -5931.053             0.004            0.000 
   248        -5930.924             0.004            0.000 
   249        -5930.947             0.004            0.000 
   250        -5931.222             0.004            0.000 
   251        -5930.836             0.004            0.000 
   252        -5931.749             0.004            0.000 
   253        -5931.747             0.004            0.000 
   254        -5931.092             0.004            0.000 
   255        -5931.244             0.004            0.000 
   256        -5930.784             0.004            0.000 
   257        -5931.029             0.004            0.000 
   258        -5931.120             0.004            0.000 
   259        -5931.367             0.004            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  58.5 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553181 0.9947446819
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5961.1
 mode of lp__ = unnormalized_log_lik = -5940.68last value = -5941.35 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -5940.68last value = -5941.35 dimension of lp__ = 1
 mode of lp_approx after rowSums = -3.94767 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -3.94767 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-5914.41547last value = -5914.07346dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-5914.41547last value = -5914.07346dimension of log_lik = 1896
 [1] "w_ICL 0.0550675"   "w_ICL 0.982135"    "w_ICL 0.999864"   
 [4] "w_ICL 0.0121203"   "w_ICL 0.999963"    "w_ICL 0.000836688"
 [7] "w_ICL 0.0446272"   "w_ICL 0.993635"    "w_ICL 0.012851"   
[10] "w_ICL 0.990733"    "w_ICL 0.996352"    "w_ICL 0.00278738" 
 [1] "post 0.0550675"   "post 0.982135"    "post 0.999864"    "post 0.0121203"  
 [5] "post 0.999963"    "post 0.000836688" "post 0.0446272"   "post 0.993635"   
 [9] "post 0.012851"    "post 0.990733"    "post 0.996352"    "post 0.00278738" 
[1] "post_k 0.0550675"
[1] "post_k_entr -44.8617770831265" "post_k_entr -34.9634490434331"
[3] "post_k_entr -68.0110926598288" "post_k_entr -49.3319897462138"
[5] "post_k_entr -43.9038743696078" "post_k_entr -61.625074569704" 
[1] "post_k_entr last step 302.697257471914"
[1] "res_entropy last step 302.697257471914"
[1] "post_k 0.982135"
[1] "post_k_entr -4.97467282588076" "post_k_entr -3.87705818102451"
[3] "post_k_entr -7.54167481788329" "post_k_entr -5.47036976226746"
[5] "post_k_entr -4.8684520537979"  "post_k_entr -6.83353633733087"
[1] "post_k_entr last step 33.5657639781848"
[1] "res_entropy last step 336.263021450099"
[1] "entropy 336.263021450099"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=281    segment 2=219    segment 3=426    segment 4=309    segment 5=275    segment 6=386 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=289    2=226    3=440    4=316    5=286    6=404 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.4950000 0.9900000
[2,] 0.4950000 0.9900000
[3,] 0.2487437 0.4974874
[4,] 0.4950000 0.9900000
[5,] 0.4950000 0.9900000
[6,] 0.3311037 0.6622074
[1] "2:0" "2:0" "2:2" "2:0" "2:0" "2:1"
w = 0.0028013355772667
  w = 0.999564463875254
  w = 0.999738910172404
  w = 0.00525531816144822
  w = 0.000905759319388529
  w = 0.998840913448961
  w = 0.997198664422733
  w = 0.000435536124745496
  w = 0.000261089827596184
  w = 0.994744681838552
  w = 0.999094240680611
  w = 0.00115908655103958
 tau = 0.84145398383607
  tau = 0.524582540309359
 phi = 0.5
  phi = 0.5
 kappa = 5[1] "These are the values used for initializing the model c(0.0028013355772667, 0.999564463875254, 0.999738910172404, 0.00525531816144822, 0.000905759319388529, 0.998840913448961, 0.997198664422733, 0.000435536124745496, 0.000261089827596184, 0.994744681838552, 0.999094240680611, 0.00115908655103958)"
[2] "These are the values used for initializing the model c(0.84145398383607, 0.524582540309359)"                                                                                                                                                                                                             
[3] "These are the values used for initializing the model c(0.5, 0.5)"                                                                                                                                                                                                                                        
[4] "These are the values used for initializing the model 5"                                                                                                                                                                                                                                                  
Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003179 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.79 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6200.478             1.000            1.000 
     2        -6157.277             0.504            1.000 
     3        -6040.587             0.342            0.019 
     4        -5951.458             0.260            0.019 
     5        -5946.308             0.208            0.015 
     6        -5939.321             0.174            0.015 
     7        -5936.680             0.149            0.007 
     8        -5935.714             0.130            0.007 
     9        -5937.161             0.116            0.001 
    10        -5936.184             0.104            0.001 
    11        -5933.724             0.095            0.001 
    12        -5934.278             0.087            0.001 
    13        -5934.684             0.080            0.000 
    14        -5934.306             0.075            0.000 
    15        -5933.545             0.070            0.000 
    16        -5933.817             0.065            0.000 
    17        -5934.433             0.061            0.000 
    18        -5932.493             0.058            0.000 
    19        -5932.610             0.055            0.000 
    20        -5932.808             0.052            0.000 
    21        -5932.961             0.050            0.000 
    22        -5932.515             0.048            0.000 
    23        -5933.482             0.045            0.000 
    24        -5932.564             0.044            0.000 
    25        -5934.314             0.042            0.000 
    26        -5933.861             0.040            0.000 
    27        -5931.858             0.039            0.000 
    28        -5933.253             0.037            0.000 
    29        -5933.277             0.036            0.000 
    30        -5931.547             0.035            0.000 
    31        -5933.034             0.034            0.000 
    32        -5931.769             0.033            0.000 
    33        -5933.065             0.032            0.000 
    34        -5932.165             0.031            0.000 
    35        -5932.597             0.030            0.000 
    36        -5932.494             0.029            0.000 
    37        -5931.707             0.028            0.000 
    38        -5932.150             0.028            0.000 
    39        -5932.358             0.027            0.000 
    40        -5931.820             0.026            0.000 
    41        -5932.035             0.026            0.000 
    42        -5932.439             0.025            0.000 
    43        -5934.286             0.024            0.000 
    44        -5933.226             0.024            0.000 
    45        -5932.817             0.023            0.000 
    46        -5932.847             0.023            0.000 
    47        -5932.699             0.022            0.000 
    48        -5931.757             0.022            0.000 
    49        -5933.084             0.021            0.000 
    50        -5932.330             0.021            0.000 
    51        -5931.818             0.021            0.000 
    52        -5932.211             0.020            0.000 
    53        -5932.288             0.020            0.000 
    54        -5933.289             0.019            0.000 
    55        -5933.095             0.019            0.000 
    56        -5932.195             0.019            0.000 
    57        -5931.742             0.018            0.000 
    58        -5932.733             0.018            0.000 
    59        -5932.072             0.018            0.000 
    60        -5931.539             0.018            0.000 
    61        -5931.353             0.017            0.000 
    62        -5932.236             0.017            0.000 
    63        -5932.117             0.017            0.000 
    64        -5931.556             0.016            0.000 
    65        -5931.689             0.016            0.000 
    66        -5931.381             0.016            0.000 
    67        -5931.741             0.016            0.000 
    68        -5931.357             0.015            0.000 
    69        -5932.540             0.015            0.000 
    70        -5933.278             0.015            0.000 
    71        -5932.976             0.015            0.000 
    72        -5930.971             0.015            0.000 
    73        -5931.733             0.014            0.000 
    74        -5932.319             0.014            0.000 
    75        -5931.733             0.014            0.000 
    76        -5932.735             0.014            0.000 
    77        -5931.722             0.014            0.000 
    78        -5931.541             0.013            0.000 
    79        -5932.329             0.013            0.000 
    80        -5931.615             0.013            0.000 
    81        -5931.240             0.013            0.000 
    82        -5932.176             0.013            0.000 
    83        -5931.733             0.013            0.000 
    84        -5932.745             0.013            0.000 
    85        -5931.428             0.012            0.000 
    86        -5931.583             0.012            0.000 
    87        -5931.625             0.012            0.000 
    88        -5931.460             0.012            0.000 
    89        -5931.161             0.012            0.000 
    90        -5931.397             0.012            0.000 
    91        -5931.953             0.012            0.000 
    92        -5932.553             0.011            0.000 
    93        -5932.216             0.011            0.000 
    94        -5932.070             0.011            0.000 
    95        -5932.649             0.011            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  34.0 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553182 0.9947446818
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -6040.59
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003172 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.72 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6095.660             1.000            1.000 
     2        -6128.253             0.503            1.000 
     3        -5973.455             0.344            0.026 
     4        -5949.839             0.259            0.026 
     5        -5947.869             0.207            0.005 
     6        -5947.014             0.173            0.005 
     7        -5944.910             0.148            0.004 
     8        -5942.596             0.130            0.004 
     9        -5941.327             0.115            0.000 
    10        -5938.780             0.104            0.000 
    11        -5942.369             0.094            0.000 
    12        -5940.427             0.086            0.000 
    13        -5940.001             0.080            0.000 
    14        -5939.329             0.074            0.000 
    15        -5938.263             0.069            0.000 
    16        -5940.064             0.065            0.000 
    17        -5938.591             0.061            0.000 
    18        -5937.805             0.058            0.000 
    19        -5936.320             0.055            0.000 
    20        -5938.006             0.052            0.000 
    21        -5935.430             0.050            0.000 
    22        -5935.139             0.047            0.000 
    23        -5934.948             0.045            0.000 
    24        -5934.888             0.043            0.000 
    25        -5935.212             0.042            0.000 
    26        -5935.430             0.040            0.000 
    27        -5934.141             0.039            0.000 
    28        -5934.479             0.037            0.000 
    29        -5935.778             0.036            0.000 
    30        -5933.425             0.035            0.000 
    31        -5932.701             0.034            0.000 
    32        -5934.232             0.033            0.000 
    33        -5933.723             0.032            0.000 
    34        -5932.523             0.031            0.000 
    35        -5933.077             0.030            0.000 
    36        -5933.256             0.029            0.000 
    37        -5933.312             0.028            0.000 
    38        -5933.352             0.027            0.000 
    39        -5934.194             0.027            0.000 
    40        -5932.588             0.026            0.000 
    41        -5932.023             0.025            0.000 
    42        -5932.240             0.025            0.000 
    43        -5933.066             0.024            0.000 
    44        -5932.461             0.024            0.000 
    45        -5933.332             0.023            0.000 
    46        -5933.211             0.023            0.000 
    47        -5931.748             0.022            0.000 
    48        -5932.116             0.022            0.000 
    49        -5933.218             0.021            0.000 
    50        -5933.712             0.021            0.000 
    51        -5931.765             0.020            0.000 
    52        -5932.302             0.020            0.000 
    53        -5933.040             0.020            0.000 
    54        -5932.450             0.019            0.000 
    55        -5933.930             0.019            0.000 
    56        -5932.348             0.019            0.000 
    57        -5931.637             0.018            0.000 
    58        -5932.042             0.018            0.000 
    59        -5931.920             0.018            0.000 
    60        -5930.987             0.017            0.000 
    61        -5932.317             0.017            0.000 
    62        -5931.518             0.017            0.000 
    63        -5932.011             0.017            0.000 
    64        -5931.617             0.016            0.000 
    65        -5931.901             0.016            0.000 
    66        -5931.621             0.016            0.000 
    67        -5934.519             0.016            0.000 
    68        -5931.899             0.015            0.000 
    69        -5931.780             0.015            0.000 
    70        -5931.046             0.015            0.000 
    71        -5931.666             0.015            0.000 
    72        -5931.610             0.015            0.000 
    73        -5932.079             0.014            0.000 
    74        -5931.728             0.014            0.000 
    75        -5931.537             0.014            0.000 
    76        -5930.899             0.014            0.000 
    77        -5931.378             0.014            0.000 
    78        -5932.716             0.013            0.000 
    79        -5931.759             0.013            0.000 
    80        -5932.373             0.013            0.000 
    81        -5932.095             0.013            0.000 
    82        -5931.026             0.013            0.000 
    83        -5932.585             0.013            0.000 
    84        -5931.137             0.012            0.000 
    85        -5931.570             0.012            0.000 
    86        -5931.171             0.012            0.000 
    87        -5931.310             0.012            0.000 
    88        -5931.337             0.012            0.000 
    89        -5931.331             0.012            0.000 
    90        -5932.144             0.012            0.000 
    91        -5931.671             0.012            0.000 
    92        -5932.006             0.011            0.000 
    93        -5931.999             0.011            0.000 
    94        -5931.843             0.011            0.000 
    95        -5932.087             0.011            0.000 
    96        -5931.922             0.011            0.000 
    97        -5932.017             0.011            0.000 
    98        -5931.626             0.011            0.000 
    99        -5931.700             0.011            0.000 
   100        -5931.450             0.010            0.000 
   101        -5931.127             0.010            0.000 
   102        -5931.914             0.010            0.000 
   103        -5931.341             0.010            0.000 
   104        -5934.096             0.010            0.000 
   105        -5931.729             0.010            0.000 
   106        -5932.865             0.010            0.000 
   107        -5931.486             0.010            0.000 
   108        -5931.917             0.010            0.000 
   109        -5931.160             0.010            0.000 
   110        -5931.444             0.010            0.000 
   111        -5931.032             0.009            0.000 
   112        -5931.336             0.009            0.000 
   113        -5931.094             0.009            0.000 
   114        -5931.904             0.009            0.000 
   115        -5931.972             0.009            0.000 
   116        -5931.284             0.009            0.000 
   117        -5932.437             0.009            0.000 
   118        -5931.750             0.009            0.000 
   119        -5931.564             0.009            0.000 
   120        -5931.419             0.009            0.000 
   121        -5932.289             0.009            0.000 
   122        -5932.183             0.009            0.000 
   123        -5931.529             0.009            0.000 
   124        -5931.516             0.008            0.000 
   125        -5931.216             0.008            0.000 
   126        -5931.398             0.008            0.000 
   127        -5932.123             0.008            0.000 
   128        -5931.302             0.008            0.000 
   129        -5931.900             0.008            0.000 
   130        -5931.089             0.008            0.000 
   131        -5932.126             0.008            0.000 
   132        -5931.605             0.008            0.000 
   133        -5931.110             0.008            0.000 
   134        -5931.654             0.008            0.000 
   135        -5931.963             0.008            0.000 
   136        -5931.089             0.008            0.000 
   137        -5930.696             0.008            0.000 
   138        -5931.063             0.008            0.000 
   139        -5931.359             0.008            0.000 
   140        -5931.513             0.008            0.000 
   141        -5931.585             0.007            0.000 
   142        -5930.859             0.007            0.000 
   143        -5931.117             0.007            0.000 
   144        -5931.260             0.007            0.000 
   145        -5931.350             0.007            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  41.3 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553182 0.9947446818
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5973.45
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003163 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.63 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6066.833             1.000            1.000 
     2        -6328.379             0.521            1.000 
     3        -5974.587             0.367            0.059 
     4        -5949.405             0.276            0.059 
     5        -5956.613             0.221            0.041 
     6        -5949.419             0.185            0.041 
     7        -5945.559             0.158            0.004 
     8        -5943.431             0.139            0.004 
     9        -5943.548             0.123            0.001 
    10        -5942.058             0.111            0.001 
    11        -5945.313             0.101            0.001 
    12        -5942.640             0.092            0.001 
    13        -5942.969             0.085            0.001 
    14        -5938.656             0.079            0.001 
    15        -5937.037             0.074            0.001 
    16        -5937.227             0.069            0.001 
    17        -5938.504             0.065            0.001 
    18        -5938.964             0.062            0.001 
    19        -5937.943             0.058            0.000 
    20        -5936.355             0.056            0.000 
    21        -5936.617             0.053            0.000 
    22        -5938.352             0.051            0.000 
    23        -5935.207             0.048            0.000 
    24        -5934.397             0.046            0.000 
    25        -5934.791             0.044            0.000 
    26        -5935.714             0.043            0.000 
    27        -5935.221             0.041            0.000 
    28        -5934.460             0.040            0.000 
    29        -5934.897             0.038            0.000 
    30        -5934.537             0.037            0.000 
    31        -5935.567             0.036            0.000 
    32        -5933.693             0.035            0.000 
    33        -5933.294             0.034            0.000 
    34        -5933.232             0.033            0.000 
    35        -5934.872             0.032            0.000 
    36        -5936.693             0.031            0.000 
    37        -5932.536             0.030            0.000 
    38        -5933.928             0.029            0.000 
    39        -5933.868             0.029            0.000 
    40        -5933.292             0.028            0.000 
    41        -5935.401             0.027            0.000 
    42        -5933.914             0.027            0.000 
    43        -5932.741             0.026            0.000 
    44        -5932.654             0.025            0.000 
    45        -5932.412             0.025            0.000 
    46        -5933.602             0.024            0.000 
    47        -5932.561             0.024            0.000 
    48        -5934.674             0.023            0.000 
    49        -5933.187             0.023            0.000 
    50        -5932.290             0.022            0.000 
    51        -5931.845             0.022            0.000 
    52        -5932.262             0.021            0.000 
    53        -5932.191             0.021            0.000 
    54        -5932.066             0.021            0.000 
    55        -5932.135             0.020            0.000 
    56        -5932.349             0.020            0.000 
    57        -5933.386             0.020            0.000 
    58        -5933.372             0.019            0.000 
    59        -5932.567             0.019            0.000 
    60        -5932.542             0.019            0.000 
    61        -5931.468             0.018            0.000 
    62        -5933.473             0.018            0.000 
    63        -5934.048             0.018            0.000 
    64        -5933.220             0.017            0.000 
    65        -5935.309             0.017            0.000 
    66        -5932.073             0.017            0.000 
    67        -5934.081             0.017            0.000 
    68        -5932.094             0.016            0.000 
    69        -5931.789             0.016            0.000 
    70        -5931.504             0.016            0.000 
    71        -5931.824             0.016            0.000 
    72        -5932.520             0.016            0.000 
    73        -5931.410             0.015            0.000 
    74        -5932.369             0.015            0.000 
    75        -5931.483             0.015            0.000 
    76        -5930.849             0.015            0.000 
    77        -5931.318             0.015            0.000 
    78        -5932.423             0.014            0.000 
    79        -5930.998             0.014            0.000 
    80        -5932.421             0.014            0.000 
    81        -5932.176             0.014            0.000 
    82        -5931.441             0.014            0.000 
    83        -5931.486             0.014            0.000 
    84        -5932.807             0.013            0.000 
    85        -5931.267             0.013            0.000 
    86        -5932.899             0.013            0.000 
    87        -5932.438             0.013            0.000 
    88        -5930.936             0.013            0.000 
    89        -5931.422             0.013            0.000 
    90        -5933.044             0.012            0.000 
    91        -5932.297             0.012            0.000 
    92        -5931.234             0.012            0.000 
    93        -5933.357             0.012            0.000 
    94        -5930.917             0.012            0.000 
    95        -5932.884             0.012            0.000 
    96        -5932.214             0.012            0.000 
    97        -5931.519             0.012            0.000 
    98        -5931.432             0.011            0.000 
    99        -5931.598             0.011            0.000 
   100        -5931.853             0.011            0.000 
   101        -5931.271             0.011            0.000 
   102        -5931.900             0.011            0.000 
   103        -5932.734             0.011            0.000 
   104        -5931.829             0.011            0.000 
   105        -5931.270             0.011            0.000 
   106        -5931.329             0.011            0.000 
   107        -5931.174             0.011            0.000 
   108        -5932.071             0.010            0.000 
   109        -5931.781             0.010            0.000 
   110        -5932.335             0.010            0.000 
   111        -5932.079             0.010            0.000 
   112        -5931.686             0.010            0.000 
   113        -5931.259             0.010            0.000 
   114        -5931.095             0.010            0.000 
   115        -5931.154             0.010            0.000 
   116        -5932.082             0.010            0.000 
   117        -5931.215             0.010            0.000 
   118        -5931.391             0.010            0.000 
   119        -5931.710             0.009            0.000 
   120        -5931.478             0.009            0.000 
   121        -5931.540             0.009            0.000 
   122        -5931.761             0.009            0.000 
   123        -5932.225             0.009            0.000 
   124        -5931.878             0.009            0.000 
   125        -5932.336             0.009            0.000 
   126        -5931.517             0.009            0.000 
   127        -5931.128             0.009            0.000 
   128        -5930.689             0.009            0.000 
   129        -5931.666             0.009            0.000 
   130        -5931.469             0.009            0.000 
   131        -5931.044             0.009            0.000 
   132        -5931.319             0.009            0.000 
   133        -5932.293             0.008            0.000 
   134        -5931.894             0.008            0.000 
   135        -5931.325             0.008            0.000 
   136        -5931.082             0.008            0.000 
   137        -5930.961             0.008            0.000 
   138        -5931.901             0.008            0.000 
   139        -5931.373             0.008            0.000 
   140        -5932.319             0.008            0.000 
   141        -5932.586             0.008            0.000 
   142        -5931.925             0.008            0.000 
   143        -5931.119             0.008            0.000 
   144        -5931.800             0.008            0.000 
   145        -5931.422             0.008            0.000 
   146        -5931.879             0.008            0.000 
   147        -5931.746             0.008            0.000 
   148        -5931.951             0.008            0.000 
   149        -5932.457             0.008            0.000 
   150        -5932.296             0.008            0.000 
   151        -5932.369             0.007            0.000 
   152        -5931.220             0.007            0.000 
   153        -5931.478             0.007            0.000 
   154        -5932.168             0.007            0.000 
   155        -5931.058             0.007            0.000 
   156        -5931.430             0.007            0.000 
   157        -5931.185             0.007            0.000 
   158        -5931.801             0.007            0.000 
   159        -5931.589             0.007            0.000 
   160        -5931.479             0.007            0.000 
   161        -5931.019             0.007            0.000 
   162        -5932.406             0.007            0.000 
   163        -5931.575             0.007            0.000 
   164        -5931.337             0.007            0.000 
   165        -5931.190             0.007            0.000 
   166        -5930.933             0.007            0.000 
   167        -5931.268             0.007            0.000 
   168        -5931.562             0.007            0.000 
   169        -5932.084             0.007            0.000 
   170        -5931.711             0.007            0.000 
   171        -5931.141             0.007            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  38.5 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553182 0.9947446818
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5974.59
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.003155 seconds 
1000 transitions using 10 leapfrog steps per transition would take 31.55 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -6060.657             1.000            1.000 
     2        -6041.700             0.502            1.000 
     3        -5986.097             0.337            0.009 
     4        -5966.582             0.254            0.009 
     5        -5954.079             0.204            0.003 
     6        -5960.756             0.170            0.003 
     7        -5948.208             0.146            0.003 
     8        -5946.237             0.128            0.003 
     9        -5946.977             0.113            0.002 
    10        -5947.180             0.102            0.002 
    11        -5941.360             0.093            0.002 
    12        -5942.338             0.085            0.002 
    13        -5941.461             0.079            0.001 
    14        -5938.182             0.073            0.001 
    15        -5937.947             0.068            0.001 
    16        -5944.394             0.064            0.001 
    17        -5939.583             0.060            0.001 
    18        -5937.262             0.057            0.001 
    19        -5938.764             0.054            0.001 
    20        -5935.915             0.051            0.001 
    21        -5935.976             0.049            0.001 
    22        -5936.472             0.047            0.001 
    23        -5935.117             0.045            0.000 
    24        -5936.703             0.043            0.000 
    25        -5935.365             0.041            0.000 
    26        -5935.489             0.040            0.000 
    27        -5936.896             0.038            0.000 
    28        -5935.395             0.037            0.000 
    29        -5935.442             0.035            0.000 
    30        -5938.291             0.034            0.000 
    31        -5935.218             0.033            0.000 
    32        -5934.828             0.032            0.000 
    33        -5933.845             0.031            0.000 
    34        -5933.282             0.030            0.000 
    35        -5934.046             0.029            0.000 
    36        -5934.631             0.029            0.000 
    37        -5934.640             0.028            0.000 
    38        -5933.191             0.027            0.000 
    39        -5933.311             0.026            0.000 
    40        -5934.489             0.026            0.000 
    41        -5933.426             0.025            0.000 
    42        -5932.823             0.025            0.000 
    43        -5933.281             0.024            0.000 
    44        -5932.575             0.023            0.000 
    45        -5933.484             0.023            0.000 
    46        -5932.161             0.022            0.000 
    47        -5932.671             0.022            0.000 
    48        -5934.696             0.021            0.000 
    49        -5933.217             0.021            0.000 
    50        -5933.112             0.021            0.000 
    51        -5934.059             0.020            0.000 
    52        -5931.781             0.020            0.000 
    53        -5932.743             0.019            0.000 
    54        -5932.314             0.019            0.000 
    55        -5931.133             0.019            0.000 
    56        -5933.349             0.018            0.000 
    57        -5932.163             0.018            0.000 
    58        -5932.217             0.018            0.000 
    59        -5932.466             0.018            0.000 
    60        -5932.910             0.017            0.000 
    61        -5931.263             0.017            0.000 
    62        -5931.353             0.017            0.000 
    63        -5931.185             0.016            0.000 
    64        -5931.355             0.016            0.000 
    65        -5931.783             0.016            0.000 
    66        -5932.672             0.016            0.000 
    67        -5933.160             0.015            0.000 
    68        -5932.202             0.015            0.000 
    69        -5932.192             0.015            0.000 
    70        -5933.128             0.015            0.000 
    71        -5931.405             0.015            0.000 
    72        -5931.571             0.014            0.000 
    73        -5932.192             0.014            0.000 
    74        -5931.650             0.014            0.000 
    75        -5931.598             0.014            0.000 
    76        -5931.532             0.014            0.000 
    77        -5932.007             0.013            0.000 
    78        -5931.506             0.013            0.000 
    79        -5931.587             0.013            0.000 
    80        -5931.035             0.013            0.000 
    81        -5931.347             0.013            0.000 
    82        -5931.189             0.013            0.000 
    83        -5932.852             0.012            0.000 
    84        -5931.954             0.012            0.000 
    85        -5933.013             0.012            0.000 
    86        -5931.761             0.012            0.000 
    87        -5933.066             0.012            0.000 
    88        -5932.780             0.012            0.000 
    89        -5931.687             0.012            0.000 
    90        -5932.592             0.012            0.000 
    91        -5932.196             0.011            0.000 
    92        -5932.163             0.011            0.000 
    93        -5931.371             0.011            0.000 
    94        -5931.278             0.011            0.000 
    95        -5931.659             0.011            0.000 
    96        -5931.161             0.011            0.000 
    97        -5931.963             0.011            0.000 
    98        -5931.694             0.011            0.000 
    99        -5932.027             0.010            0.000 
   100        -5932.241             0.010            0.000 
   101        -5932.366             0.010            0.000 
   102        -5930.903             0.010            0.000 
   103        -5930.561             0.010            0.000 
   104        -5931.080             0.010            0.000 
   105        -5931.148             0.010            0.000 
   106        -5931.444             0.010            0.000 
   107        -5930.952             0.010            0.000 
   108        -5931.523             0.010            0.000 
   109        -5932.547             0.010            0.000 
   110        -5931.553             0.009            0.000 
   111        -5931.173             0.009            0.000 
   112        -5931.054             0.009            0.000 
   113        -5932.020             0.009            0.000 
   114        -5930.967             0.009            0.000 
   115        -5930.913             0.009            0.000 
   116        -5931.752             0.009            0.000 
   117        -5932.007             0.009            0.000 
   118        -5930.995             0.009            0.000 
   119        -5931.352             0.009            0.000 
   120        -5932.292             0.009            0.000 
   121        -5931.946             0.009            0.000 
   122        -5931.081             0.009            0.000 
   123        -5933.119             0.008            0.000 
   124        -5931.278             0.008            0.000 
   125        -5931.193             0.008            0.000 
   126        -5931.767             0.008            0.000 
   127        -5931.795             0.008            0.000 
   128        -5931.427             0.008            0.000 
   129        -5931.217             0.008            0.000 
   130        -5931.357             0.008            0.000 
   131        -5931.813             0.008            0.000 
   132        -5931.392             0.008            0.000 
   133        -5931.570             0.008            0.000 
   134        -5932.111             0.008            0.000 
   135        -5931.163             0.008            0.000 
   136        -5931.483             0.008            0.000 
   137        -5932.346             0.008            0.000 
   138        -5932.066             0.008            0.000 
   139        -5930.931             0.007            0.000 
   140        -5931.223             0.007            0.000 
   141        -5932.086             0.007            0.000 
   142        -5930.741             0.007            0.000 
   143        -5931.120             0.007            0.000 
   144        -5932.494             0.007            0.000 
   145        -5932.199             0.007            0.000 
   146        -5933.575             0.007            0.000 
   147        -5932.029             0.007            0.000 
   148        -5931.717             0.007            0.000 
   149        -5931.577             0.007            0.000 
   150        -5930.818             0.007            0.000 
   151        -5930.571             0.007            0.000 
   152        -5931.222             0.007            0.000 
   153        -5932.174             0.007            0.000 
   154        -5931.122             0.007            0.000 
   155        -5931.958             0.007            0.000 
   156        -5932.150             0.007            0.000 
   157        -5931.566             0.007            0.000 
   158        -5931.504             0.007            0.000 
   159        -5931.673             0.007            0.000 
   160        -5931.588             0.007            0.000 
   161        -5931.323             0.006            0.000 
   162        -5931.283             0.006            0.000 
   163        -5932.300             0.006            0.000 
   164        -5931.163             0.006            0.000 
   165        -5932.360             0.006            0.000 
   166        -5930.527             0.006            0.000 
   167        -5931.193             0.006            0.000 
   168        -5931.414             0.006            0.000 
   169        -5931.662             0.006            0.000 
   170        -5931.188             0.006            0.000 
   171        -5932.141             0.006            0.000 
   172        -5931.714             0.006            0.000 
   173        -5932.546             0.006            0.000 
   174        -5931.325             0.006            0.000 
   175        -5931.477             0.006            0.000 
   176        -5931.174             0.006            0.000 
   177        -5931.147             0.006            0.000 
   178        -5932.313             0.006            0.000 
   179        -5931.171             0.006            0.000 
   180        -5930.969             0.006            0.000 
   181        -5931.180             0.006            0.000 
   182        -5931.023             0.006            0.000 
   183        -5931.764             0.006            0.000 
   184        -5931.567             0.006            0.000 
   185        -5931.236             0.006            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  47.9 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.0028013356 0.9971986644
[2,] 0.9995644639 0.0004355361
[3,] 0.9997389102 0.0002610898
[4,] 0.0052553182 0.9947446818
[5,] 0.0009057593 0.9990942407
[6,] 0.9988409134 0.0011590866

[[1]]$tau
[1] 0.8414540 0.5245825

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -5986.1
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=281    segment 2=219    segment 3=426    segment 4=309    segment 5=275    segment 6=386 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=289    2=226    3=440    4=316    5=286    6=404 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 1
  w = 1
  w = 1
  w = 1
  w = 1
  w = 1
 tau = 0.390765312975253
 phi = 1
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002233 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.33 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8298.093             1.000            1.000 
     2        -8094.320             0.513            1.000 
     3        -8081.941             0.342            0.025 
     4        -8084.825             0.257            0.025 
     5        -8084.310             0.205            0.002 
     6        -8084.388             0.171            0.002 
     7        -8076.826             0.147            0.001 
     8        -8080.351             0.129            0.001 
     9        -8078.498             0.114            0.000 
    10        -8076.717             0.103            0.000 
    11        -8075.296             0.094            0.000 
    12        -8076.351             0.086            0.000 
    13        -8075.064             0.079            0.000 
    14        -8074.221             0.074            0.000 
    15        -8075.767             0.069            0.000 
    16        -8073.095             0.064            0.000 
    17        -8073.547             0.061            0.000 
    18        -8071.534             0.057            0.000 
    19        -8071.361             0.054            0.000 
    20        -8071.434             0.052            0.000 
    21        -8071.118             0.049            0.000 
    22        -8071.522             0.047            0.000 
    23        -8070.091             0.045            0.000 
    24        -8070.770             0.043            0.000 
    25        -8071.144             0.041            0.000 
    26        -8070.296             0.040            0.000 
    27        -8068.425             0.038            0.000 
    28        -8071.234             0.037            0.000 
    29        -8069.513             0.036            0.000 
    30        -8071.146             0.034            0.000 
    31        -8069.912             0.033            0.000 
    32        -8067.567             0.032            0.000 
    33        -8069.087             0.031            0.000 
    34        -8068.106             0.030            0.000 
    35        -8068.416             0.030            0.000 
    36        -8068.646             0.029            0.000 
    37        -8071.104             0.028            0.000 
    38        -8069.492             0.027            0.000 
    39        -8068.142             0.026            0.000 
    40        -8068.444             0.026            0.000 
    41        -8070.325             0.025            0.000 
    42        -8068.265             0.025            0.000 
    43        -8067.074             0.024            0.000 
    44        -8067.368             0.024            0.000 
    45        -8067.632             0.023            0.000 
    46        -8067.681             0.022            0.000 
    47        -8068.443             0.022            0.000 
    48        -8067.246             0.022            0.000 
    49        -8067.390             0.021            0.000 
    50        -8067.038             0.021            0.000 
    51        -8067.205             0.020            0.000 
    52        -8069.379             0.020            0.000 
    53        -8067.137             0.020            0.000 
    54        -8070.313             0.019            0.000 
    55        -8068.224             0.019            0.000 
    56        -8067.348             0.018            0.000 
    57        -8066.900             0.018            0.000 
    58        -8067.293             0.018            0.000 
    59        -8067.230             0.018            0.000 
    60        -8068.289             0.017            0.000 
    61        -8066.863             0.017            0.000 
    62        -8066.764             0.017            0.000 
    63        -8066.433             0.016            0.000 
    64        -8066.818             0.016            0.000 
    65        -8066.689             0.016            0.000 
    66        -8066.773             0.016            0.000 
    67        -8066.402             0.015            0.000 
    68        -8066.301             0.015            0.000 
    69        -8066.043             0.015            0.000 
    70        -8067.021             0.015            0.000 
    71        -8066.761             0.015            0.000 
    72        -8066.057             0.014            0.000 
    73        -8066.428             0.014            0.000 
    74        -8066.751             0.014            0.000 
    75        -8067.958             0.014            0.000 
    76        -8068.002             0.014            0.000 
    77        -8066.279             0.013            0.000 
    78        -8066.404             0.013            0.000 
    79        -8065.896             0.013            0.000 
    80        -8066.442             0.013            0.000 
    81        -8066.467             0.013            0.000 
    82        -8066.727             0.013            0.000 
    83        -8066.229             0.012            0.000 
    84        -8065.873             0.012            0.000 
    85        -8066.450             0.012            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  19.0 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8081.94
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002281 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.81 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8215.894             1.000            1.000 
     2        -8181.365             0.502            1.000 
     3        -8092.295             0.338            0.011 
     4        -8076.261             0.254            0.011 
     5        -8073.539             0.204            0.004 
     6        -8072.411             0.170            0.004 
     7        -8070.471             0.145            0.002 
     8        -8081.048             0.127            0.002 
     9        -8072.798             0.113            0.001 
    10        -8071.999             0.102            0.001 
    11        -8070.367             0.093            0.001 
    12        -8070.290             0.085            0.001 
    13        -8073.658             0.079            0.000 
    14        -8069.727             0.073            0.000 
    15        -8069.345             0.068            0.000 
    16        -8070.569             0.064            0.000 
    17        -8068.138             0.060            0.000 
    18        -8067.516             0.057            0.000 
    19        -8070.805             0.054            0.000 
    20        -8068.026             0.051            0.000 
    21        -8067.795             0.049            0.000 
    22        -8066.939             0.046            0.000 
    23        -8067.888             0.044            0.000 
    24        -8067.098             0.043            0.000 
    25        -8068.954             0.041            0.000 
    26        -8068.635             0.039            0.000 
    27        -8066.403             0.038            0.000 
    28        -8067.382             0.037            0.000 
    29        -8068.639             0.035            0.000 
    30        -8066.953             0.034            0.000 
    31        -8067.822             0.033            0.000 
    32        -8066.360             0.032            0.000 
    33        -8068.244             0.031            0.000 
    34        -8067.322             0.030            0.000 
    35        -8066.393             0.029            0.000 
    36        -8066.996             0.028            0.000 
    37        -8066.297             0.028            0.000 
    38        -8066.695             0.027            0.000 
    39        -8067.278             0.026            0.000 
    40        -8066.173             0.026            0.000 
    41        -8066.521             0.025            0.000 
    42        -8066.181             0.024            0.000 
    43        -8066.576             0.024            0.000 
    44        -8066.344             0.023            0.000 
    45        -8066.988             0.023            0.000 
    46        -8071.824             0.022            0.000 
    47        -8068.440             0.022            0.000 
    48        -8066.805             0.021            0.000 
    49        -8066.235             0.021            0.000 
    50        -8066.483             0.021            0.000 
    51        -8066.216             0.020            0.000 
    52        -8066.102             0.020            0.000 
    53        -8066.326             0.019            0.000 
    54        -8066.634             0.019            0.000 
    55        -8066.174             0.019            0.000 
    56        -8066.111             0.018            0.000 
    57        -8065.923             0.018            0.000 
    58        -8066.169             0.018            0.000 
    59        -8066.178             0.017            0.000 
    60        -8066.541             0.017            0.000 
    61        -8066.580             0.017            0.000 
    62        -8066.792             0.017            0.000 
    63        -8067.055             0.016            0.000 
    64        -8066.945             0.016            0.000 
    65        -8066.688             0.016            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  16.8 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8092.29
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002255 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.55 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8252.478             1.000            1.000 
     2        -8327.214             0.504            1.000 
     3        -8121.993             0.345            0.025 
     4        -8087.183             0.260            0.025 
     5        -8087.470             0.208            0.009 
     6        -8082.969             0.173            0.009 
     7        -8082.162             0.148            0.004 
     8        -8075.962             0.130            0.004 
     9        -8079.306             0.116            0.001 
    10        -8079.302             0.104            0.001 
    11        -8073.550             0.095            0.001 
    12        -8075.682             0.087            0.001 
    13        -8073.703             0.080            0.001 
    14        -8075.127             0.074            0.001 
    15        -8072.850             0.069            0.000 
    16        -8069.855             0.065            0.000 
    17        -8073.454             0.061            0.000 
    18        -8071.941             0.058            0.000 
    19        -8074.123             0.055            0.000 
    20        -8070.370             0.052            0.000 
    21        -8071.779             0.050            0.000 
    22        -8073.282             0.047            0.000 
    23        -8074.286             0.045            0.000 
    24        -8071.823             0.044            0.000 
    25        -8068.512             0.042            0.000 
    26        -8070.270             0.040            0.000 
    27        -8071.354             0.039            0.000 
    28        -8069.887             0.037            0.000 
    29        -8069.317             0.036            0.000 
    30        -8069.759             0.035            0.000 
    31        -8069.698             0.034            0.000 
    32        -8068.689             0.033            0.000 
    33        -8067.678             0.032            0.000 
    34        -8068.375             0.031            0.000 
    35        -8067.611             0.030            0.000 
    36        -8068.088             0.029            0.000 
    37        -8067.407             0.028            0.000 
    38        -8069.618             0.028            0.000 
    39        -8068.153             0.027            0.000 
    40        -8067.872             0.026            0.000 
    41        -8066.672             0.026            0.000 
    42        -8068.199             0.025            0.000 
    43        -8066.959             0.024            0.000 
    44        -8068.119             0.024            0.000 
    45        -8066.904             0.023            0.000 
    46        -8067.499             0.023            0.000 
    47        -8071.081             0.022            0.000 
    48        -8067.488             0.022            0.000 
    49        -8066.820             0.021            0.000 
    50        -8067.344             0.021            0.000 
    51        -8066.987             0.021            0.000 
    52        -8066.794             0.020            0.000 
    53        -8066.853             0.020            0.000 
    54        -8067.281             0.019            0.000 
    55        -8066.424             0.019            0.000 
    56        -8067.851             0.019            0.000 
    57        -8066.072             0.018            0.000 
    58        -8066.835             0.018            0.000 
    59        -8066.655             0.018            0.000 
    60        -8067.606             0.017            0.000 
    61        -8067.251             0.017            0.000 
    62        -8069.522             0.017            0.000 
    63        -8066.323             0.017            0.000 
    64        -8066.624             0.016            0.000 
    65        -8066.186             0.016            0.000 
    66        -8066.923             0.016            0.000 
    67        -8066.175             0.016            0.000 
    68        -8065.657             0.015            0.000 
    69        -8065.982             0.015            0.000 
    70        -8066.967             0.015            0.000 
    71        -8066.625             0.015            0.000 
    72        -8065.919             0.015            0.000 
    73        -8066.722             0.014            0.000 
    74        -8066.537             0.014            0.000 
    75        -8068.289             0.014            0.000 
    76        -8066.764             0.014            0.000 
    77        -8066.744             0.014            0.000 
    78        -8065.935             0.013            0.000 
    79        -8066.201             0.013            0.000 
    80        -8066.202             0.013            0.000 
    81        -8067.401             0.013            0.000 
    82        -8066.039             0.013            0.000 
    83        -8065.967             0.013            0.000 
    84        -8065.899             0.013            0.000 
    85        -8066.507             0.012            0.000 
    86        -8065.988             0.012            0.000 
    87        -8066.053             0.012            0.000 
    88        -8066.357             0.012            0.000 
    89        -8066.719             0.012            0.000 
    90        -8068.593             0.012            0.000 
    91        -8067.816             0.012            0.000 
    92        -8066.641             0.011            0.000 
    93        -8065.814             0.011            0.000 
    94        -8066.050             0.011            0.000 
    95        -8065.862             0.011            0.000 
    96        -8066.171             0.011            0.000 
    97        -8066.001             0.011            0.000 
    98        -8065.956             0.011            0.000 
    99        -8066.295             0.011            0.000 
   100        -8066.328             0.011            0.000 
   101        -8066.284             0.010            0.000 
   102        -8066.894             0.010            0.000 
   103        -8066.871             0.010            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  20.6 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8121.99
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002334 seconds 
1000 transitions using 10 leapfrog steps per transition would take 23.34 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8230.572             1.000            1.000 
     2        -8326.759             0.506            1.000 
     3        -8081.829             0.347            0.030 
     4        -8080.588             0.261            0.030 
     5        -8078.363             0.208            0.012 
     6        -8081.686             0.174            0.012 
     7        -8075.209             0.149            0.001 
     8        -8074.013             0.130            0.001 
     9        -8077.108             0.116            0.000 
    10        -8074.335             0.104            0.000 
    11        -8071.594             0.095            0.000 
    12        -8073.011             0.087            0.000 
    13        -8071.266             0.080            0.000 
    14        -8069.394             0.075            0.000 
    15        -8076.265             0.070            0.000 
    16        -8072.270             0.065            0.000 
    17        -8071.144             0.062            0.000 
    18        -8068.989             0.058            0.000 
    19        -8073.695             0.055            0.000 
    20        -8069.137             0.052            0.000 
    21        -8069.874             0.050            0.000 
    22        -8071.107             0.048            0.000 
    23        -8070.755             0.046            0.000 
    24        -8070.081             0.044            0.000 
    25        -8070.143             0.042            0.000 
    26        -8069.947             0.040            0.000 
    27        -8069.239             0.039            0.000 
    28        -8068.700             0.037            0.000 
    29        -8068.174             0.036            0.000 
    30        -8068.536             0.035            0.000 
    31        -8069.458             0.034            0.000 
    32        -8070.215             0.033            0.000 
    33        -8069.573             0.032            0.000 
    34        -8068.947             0.031            0.000 
    35        -8069.447             0.030            0.000 
    36        -8068.586             0.029            0.000 
    37        -8070.302             0.028            0.000 
    38        -8069.544             0.028            0.000 
    39        -8068.381             0.027            0.000 
    40        -8069.832             0.026            0.000 
    41        -8068.871             0.026            0.000 
    42        -8072.577             0.025            0.000 
    43        -8067.823             0.024            0.000 
    44        -8067.004             0.024            0.000 
    45        -8067.294             0.023            0.000 
    46        -8066.971             0.023            0.000 
    47        -8066.759             0.022            0.000 
    48        -8067.311             0.022            0.000 
    49        -8067.040             0.021            0.000 
    50        -8069.033             0.021            0.000 
    51        -8067.228             0.021            0.000 
    52        -8066.952             0.020            0.000 
    53        -8070.159             0.020            0.000 
    54        -8069.637             0.019            0.000 
    55        -8067.006             0.019            0.000 
    56        -8067.421             0.019            0.000 
    57        -8066.709             0.018            0.000 
    58        -8067.411             0.018            0.000 
    59        -8067.065             0.018            0.000 
    60        -8066.324             0.018            0.000 
    61        -8066.637             0.017            0.000 
    62        -8068.321             0.017            0.000 
    63        -8066.261             0.017            0.000 
    64        -8066.166             0.016            0.000 
    65        -8066.208             0.016            0.000 
    66        -8066.617             0.016            0.000 
    67        -8067.792             0.016            0.000 
    68        -8066.447             0.016            0.000 
    69        -8067.125             0.015            0.000 
    70        -8066.080             0.015            0.000 
    71        -8066.049             0.015            0.000 
    72        -8066.084             0.015            0.000 
    73        -8065.852             0.014            0.000 
    74        -8067.086             0.014            0.000 
    75        -8066.279             0.014            0.000 
    76        -8065.870             0.014            0.000 
    77        -8068.392             0.014            0.000 
    78        -8066.089             0.014            0.000 
    79        -8066.003             0.013            0.000 
    80        -8066.160             0.013            0.000 
    81        -8066.553             0.013            0.000 
    82        -8066.619             0.013            0.000 
    83        -8066.144             0.013            0.000 
    84        -8066.886             0.013            0.000 
    85        -8066.349             0.012            0.000 
    86        -8066.799             0.012            0.000 
    87        -8066.586             0.012            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  19.1 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8081.83
 mode of lp__ = unnormalized_log_lik = -8064.62last value = -8064.97 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -8064.62last value = -8064.97 dimension of lp__ = 1
 mode of lp_approx after rowSums = -1.84162 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -1.84162 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-8062.78023last value = -8062.91191dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-8062.78023last value = -8062.91191dimension of log_lik = 2481
[1] "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1"
[1] "post 1" "post 1" "post 1" "post 1" "post 1" "post 1"
[1] "post_k 1"
[1] "post_k_entr 0.000554999722454527" "post_k_entr 0.000359999819970504"
[3] "post_k_entr 0.000282999858476813" "post_k_entr 0.00056399971795379" 
[5] "post_k_entr 0.000432999783464523" "post_k_entr 0.000285999856976567"
[1] "post_k_entr last step -0.00248099875929672"
[1] "res_entropy last step -0.00248099875929672"
[1] "entropy -0.00248099875929672"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=555    segment 2=360    segment 3=283    segment 4=564    segment 5=433    segment 6=286 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 0.99977718150826
  w = 0.000104205802406298
  w = 0.999572488820929
  w = 0.000104186506699101
  w = 0.998228799273999
  w = 0.998952642946398
  w = 0.000222818491740168
  w = 0.999895794197594
  w = 0.000427511179071118
  w = 0.999895813493301
  w = 0.0017712007260009
  w = 0.00104735705360174
 tau = 0.554401513466328
  tau = 0.0635089812217571
 phi = 0.5
  phi = 0.5
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004113 seconds 
1000 transitions using 10 leapfrog steps per transition would take 41.13 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8076.491             1.000            1.000 
     2        -8221.611             0.509            1.000 
     3        -7970.726             0.350            0.031 
     4        -7952.504             0.263            0.031 
     5        -7929.276             0.211            0.018 
     6        -7923.890             0.176            0.018 
     7        -7926.836             0.151            0.003 
     8        -7922.122             0.132            0.003 
     9        -7920.960             0.117            0.002 
    10        -7919.589             0.106            0.002 
    11        -7924.115             0.096            0.001 
    12        -7921.046             0.088            0.001 
    13        -7920.584             0.081            0.001 
    14        -7917.845             0.076            0.001 
    15        -7915.849             0.071            0.001 
    16        -7913.843             0.066            0.001 
    17        -7913.770             0.062            0.000 
    18        -7916.774             0.059            0.000 
    19        -7914.415             0.056            0.000 
    20        -7914.353             0.053            0.000 
    21        -7914.089             0.050            0.000 
    22        -7912.847             0.048            0.000 
    23        -7913.956             0.046            0.000 
    24        -7913.223             0.044            0.000 
    25        -7914.813             0.042            0.000 
    26        -7912.294             0.041            0.000 
    27        -7912.727             0.039            0.000 
    28        -7912.029             0.038            0.000 
    29        -7910.750             0.037            0.000 
    30        -7911.004             0.035            0.000 
    31        -7912.165             0.034            0.000 
    32        -7913.245             0.033            0.000 
    33        -7911.467             0.032            0.000 
    34        -7910.473             0.031            0.000 
    35        -7910.414             0.030            0.000 
    36        -7913.529             0.029            0.000 
    37        -7911.737             0.029            0.000 
    38        -7909.831             0.028            0.000 
    39        -7910.189             0.027            0.000 
    40        -7911.001             0.027            0.000 
    41        -7910.161             0.026            0.000 
    42        -7909.967             0.025            0.000 
    43        -7910.999             0.025            0.000 
    44        -7909.751             0.024            0.000 
    45        -7909.761             0.024            0.000 
    46        -7910.154             0.023            0.000 
    47        -7911.181             0.023            0.000 
    48        -7910.135             0.022            0.000 
    49        -7909.326             0.022            0.000 
    50        -7908.645             0.021            0.000 
    51        -7908.806             0.021            0.000 
    52        -7909.299             0.020            0.000 
    53        -7908.632             0.020            0.000 
    54        -7909.892             0.020            0.000 
    55        -7909.858             0.019            0.000 
    56        -7908.454             0.019            0.000 
    57        -7910.028             0.019            0.000 
    58        -7909.600             0.018            0.000 
    59        -7910.729             0.018            0.000 
    60        -7910.605             0.018            0.000 
    61        -7909.104             0.017            0.000 
    62        -7908.610             0.017            0.000 
    63        -7909.420             0.017            0.000 
    64        -7909.935             0.017            0.000 
    65        -7910.064             0.016            0.000 
    66        -7908.551             0.016            0.000 
    67        -7908.792             0.016            0.000 
    68        -7910.756             0.016            0.000 
    69        -7909.276             0.015            0.000 
    70        -7908.698             0.015            0.000 
    71        -7909.198             0.015            0.000 
    72        -7908.542             0.015            0.000 
    73        -7909.056             0.015            0.000 
    74        -7909.622             0.014            0.000 
    75        -7909.157             0.014            0.000 
    76        -7908.487             0.014            0.000 
    77        -7908.931             0.014            0.000 
    78        -7909.577             0.014            0.000 
    79        -7910.548             0.013            0.000 
    80        -7909.215             0.013            0.000 
    81        -7910.383             0.013            0.000 
    82        -7909.435             0.013            0.000 
    83        -7908.982             0.013            0.000 
    84        -7909.521             0.013            0.000 
    85        -7909.348             0.013            0.000 
    86        -7909.487             0.012            0.000 
    87        -7909.263             0.012            0.000 
    88        -7909.565             0.012            0.000 
    89        -7908.335             0.012            0.000 
    90        -7909.140             0.012            0.000 
    91        -7909.062             0.012            0.000 
    92        -7908.709             0.012            0.000 
    93        -7908.807             0.011            0.000 
    94        -7909.128             0.011            0.000 
    95        -7908.837             0.011            0.000 
    96        -7909.126             0.011            0.000 
    97        -7908.666             0.011            0.000 
    98        -7911.403             0.011            0.000 
    99        -7910.512             0.011            0.000 
   100        -7909.929             0.011            0.000 
   101        -7908.380             0.011            0.000 
   102        -7908.500             0.010            0.000 
   103        -7908.687             0.010            0.000 
   104        -7909.018             0.010            0.000 
   105        -7908.491             0.010            0.000 
   106        -7907.851             0.010            0.000 
   107        -7909.797             0.010            0.000 
   108        -7908.901             0.010            0.000 
   109        -7908.770             0.010            0.000 
   110        -7908.785             0.010            0.000 
   111        -7908.844             0.010            0.000 
   112        -7908.138             0.010            0.000 
   113        -7909.108             0.009            0.000 
   114        -7909.185             0.009            0.000 
   115        -7908.820             0.009            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  48.4 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7970.73
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004239 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.39 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8086.708             1.000            1.000 
     2        -7963.420             0.508            1.000 
     3        -7940.126             0.339            0.015 
     4        -7945.751             0.255            0.015 
     5        -7925.233             0.204            0.003 
     6        -7921.790             0.170            0.003 
     7        -7921.846             0.146            0.003 
     8        -7918.486             0.128            0.003 
     9        -7917.959             0.114            0.001 
    10        -7917.464             0.102            0.001 
    11        -7916.933             0.093            0.000 
    12        -7915.552             0.085            0.000 
    13        -7914.478             0.079            0.000 
    14        -7915.651             0.073            0.000 
    15        -7916.687             0.068            0.000 
    16        -7918.645             0.064            0.000 
    17        -7914.335             0.060            0.000 
    18        -7912.948             0.057            0.000 
    19        -7912.587             0.054            0.000 
    20        -7912.100             0.051            0.000 
    21        -7911.173             0.049            0.000 
    22        -7910.816             0.047            0.000 
    23        -7912.668             0.045            0.000 
    24        -7912.304             0.043            0.000 
    25        -7913.688             0.041            0.000 
    26        -7911.703             0.039            0.000 
    27        -7910.931             0.038            0.000 
    28        -7910.999             0.037            0.000 
    29        -7910.925             0.035            0.000 
    30        -7911.161             0.034            0.000 
    31        -7910.974             0.033            0.000 
    32        -7910.901             0.032            0.000 
    33        -7910.250             0.031            0.000 
    34        -7910.428             0.030            0.000 
    35        -7909.902             0.029            0.000 
    36        -7910.574             0.028            0.000 
    37        -7910.485             0.028            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  33.6 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7940.13
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004246 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.46 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8071.086             1.000            1.000 
     2        -8118.477             0.503            1.000 
     3        -7957.754             0.342            0.020 
     4        -7934.216             0.257            0.020 
     5        -7938.951             0.206            0.006 
     6        -7972.252             0.172            0.006 
     7        -7926.971             0.148            0.006 
     8        -7923.895             0.130            0.006 
     9        -7927.166             0.116            0.004 
    10        -7919.484             0.104            0.004 
    11        -7920.609             0.095            0.003 
    12        -7920.781             0.087            0.003 
    13        -7918.687             0.080            0.001 
    14        -7916.597             0.074            0.001 
    15        -7918.151             0.069            0.001 
    16        -7917.180             0.065            0.001 
    17        -7917.662             0.061            0.000 
    18        -7914.528             0.058            0.000 
    19        -7915.271             0.055            0.000 
    20        -7914.152             0.052            0.000 
    21        -7915.968             0.050            0.000 
    22        -7913.372             0.047            0.000 
    23        -7914.672             0.045            0.000 
    24        -7914.017             0.043            0.000 
    25        -7913.642             0.042            0.000 
    26        -7912.915             0.040            0.000 
    27        -7912.204             0.039            0.000 
    28        -7914.208             0.037            0.000 
    29        -7912.410             0.036            0.000 
    30        -7910.851             0.035            0.000 
    31        -7911.601             0.034            0.000 
    32        -7911.590             0.033            0.000 
    33        -7911.342             0.032            0.000 
    34        -7911.738             0.031            0.000 
    35        -7912.132             0.030            0.000 
    36        -7910.531             0.029            0.000 
    37        -7910.541             0.028            0.000 
    38        -7910.534             0.028            0.000 
    39        -7909.915             0.027            0.000 
    40        -7910.375             0.026            0.000 
    41        -7908.789             0.025            0.000 
    42        -7911.273             0.025            0.000 
    43        -7910.828             0.024            0.000 
    44        -7910.163             0.024            0.000 
    45        -7911.224             0.023            0.000 
    46        -7911.059             0.023            0.000 
    47        -7910.255             0.022            0.000 
    48        -7910.834             0.022            0.000 
    49        -7909.776             0.021            0.000 
    50        -7910.655             0.021            0.000 
    51        -7913.232             0.021            0.000 
    52        -7910.284             0.020            0.000 
    53        -7910.235             0.020            0.000 
    54        -7909.617             0.019            0.000 
    55        -7909.001             0.019            0.000 
    56        -7909.883             0.019            0.000 
    57        -7911.469             0.018            0.000 
    58        -7910.535             0.018            0.000 
    59        -7908.755             0.018            0.000 
    60        -7908.837             0.017            0.000 
    61        -7909.959             0.017            0.000 
    62        -7908.942             0.017            0.000 
    63        -7909.216             0.017            0.000 
    64        -7909.260             0.016            0.000 
    65        -7908.786             0.016            0.000 
    66        -7908.541             0.016            0.000 
    67        -7909.157             0.016            0.000 
    68        -7909.318             0.015            0.000 
    69        -7909.642             0.015            0.000 
    70        -7909.757             0.015            0.000 
    71        -7908.968             0.015            0.000 
    72        -7909.331             0.015            0.000 
    73        -7909.318             0.014            0.000 
    74        -7908.958             0.014            0.000 
    75        -7909.153             0.014            0.000 
    76        -7909.045             0.014            0.000 
    77        -7908.096             0.014            0.000 
    78        -7911.686             0.013            0.000 
    79        -7909.978             0.013            0.000 
    80        -7911.005             0.013            0.000 
    81        -7909.820             0.013            0.000 
    82        -7909.760             0.013            0.000 
    83        -7909.423             0.013            0.000 
    84        -7909.832             0.012            0.000 
    85        -7909.637             0.012            0.000 
    86        -7910.546             0.012            0.000 
    87        -7911.130             0.012            0.000 
    88        -7908.579             0.012            0.000 
    89        -7910.072             0.012            0.000 
    90        -7909.206             0.012            0.000 
    91        -7910.693             0.012            0.000 
    92        -7909.860             0.011            0.000 
    93        -7909.520             0.011            0.000 
    94        -7911.302             0.011            0.000 
    95        -7908.482             0.011            0.000 
    96        -7912.653             0.011            0.000 
    97        -7910.047             0.011            0.000 
    98        -7908.486             0.011            0.000 
    99        -7910.504             0.011            0.000 
   100        -7908.852             0.011            0.000 
   101        -7909.178             0.010            0.000 
   102        -7912.440             0.010            0.000 
   103        -7909.299             0.010            0.000 
   104        -7908.689             0.010            0.000 
   105        -7908.585             0.010            0.000 
   106        -7909.348             0.010            0.000 
   107        -7908.608             0.010            0.000 
   108        -7908.790             0.010            0.000 
   109        -7909.452             0.010            0.000 
   110        -7908.491             0.010            0.000 
   111        -7908.948             0.010            0.000 
   112        -7907.722             0.009            0.000 
   113        -7908.220             0.009            0.000 
   114        -7909.422             0.009            0.000 
   115        -7908.421             0.009            0.000 
   116        -7907.864             0.009            0.000 
   117        -7910.223             0.009            0.000 
   118        -7908.465             0.009            0.000 
   119        -7908.747             0.009            0.000 
   120        -7909.520             0.009            0.000 
   121        -7911.265             0.009            0.000 
   122        -7909.618             0.009            0.000 
   123        -7910.327             0.009            0.000 
   124        -7910.309             0.009            0.000 
   125        -7910.598             0.008            0.000 
   126        -7909.244             0.008            0.000 
   127        -7909.380             0.008            0.000 
   128        -7908.826             0.008            0.000 
   129        -7908.640             0.008            0.000 
   130        -7908.981             0.008            0.000 
   131        -7908.777             0.008            0.000 
   132        -7909.326             0.008            0.000 
   133        -7909.310             0.008            0.000 
   134        -7909.753             0.008            0.000 
   135        -7908.510             0.008            0.000 
   136        -7908.292             0.008            0.000 
   137        -7908.487             0.008            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  47.0 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7957.75
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004302 seconds 
1000 transitions using 10 leapfrog steps per transition would take 43.02 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8060.690             1.000            1.000 
     2        -8095.979             0.502            1.000 
     3        -7935.623             0.342            0.020 
     4        -7931.083             0.256            0.020 
     5        -7932.501             0.205            0.004 
     6        -7928.305             0.171            0.004 
     7        -7929.737             0.147            0.001 
     8        -7921.757             0.128            0.001 
     9        -7923.536             0.114            0.001 
    10        -7921.702             0.103            0.001 
    11        -7921.658             0.093            0.001 
    12        -7920.055             0.086            0.001 
    13        -7917.359             0.079            0.000 
    14        -7916.710             0.073            0.000 
    15        -7915.991             0.069            0.000 
    16        -7919.364             0.064            0.000 
    17        -7913.732             0.061            0.000 
    18        -7912.685             0.057            0.000 
    19        -7915.175             0.054            0.000 
    20        -7914.780             0.051            0.000 
    21        -7915.361             0.049            0.000 
    22        -7912.283             0.047            0.000 
    23        -7915.814             0.045            0.000 
    24        -7912.067             0.043            0.000 
    25        -7913.892             0.041            0.000 
    26        -7912.325             0.040            0.000 
    27        -7910.388             0.038            0.000 
    28        -7912.860             0.037            0.000 
    29        -7912.263             0.036            0.000 
    30        -7910.254             0.034            0.000 
    31        -7910.631             0.033            0.000 
    32        -7909.326             0.032            0.000 
    33        -7910.716             0.031            0.000 
    34        -7912.720             0.030            0.000 
    35        -7911.766             0.030            0.000 
    36        -7910.967             0.029            0.000 
    37        -7909.993             0.028            0.000 
    38        -7909.613             0.027            0.000 
    39        -7910.460             0.027            0.000 
    40        -7910.335             0.026            0.000 
    41        -7912.840             0.025            0.000 
    42        -7910.647             0.025            0.000 
    43        -7908.746             0.024            0.000 
    44        -7909.619             0.024            0.000 
    45        -7909.643             0.023            0.000 
    46        -7910.938             0.022            0.000 
    47        -7910.756             0.022            0.000 
    48        -7910.133             0.022            0.000 
    49        -7909.036             0.021            0.000 
    50        -7910.084             0.021            0.000 
    51        -7909.281             0.020            0.000 
    52        -7908.779             0.020            0.000 
    53        -7909.777             0.020            0.000 
    54        -7911.320             0.019            0.000 
    55        -7911.902             0.019            0.000 
    56        -7910.156             0.018            0.000 
    57        -7909.872             0.018            0.000 
    58        -7910.138             0.018            0.000 
    59        -7910.063             0.018            0.000 
    60        -7910.093             0.017            0.000 
    61        -7909.135             0.017            0.000 
    62        -7908.980             0.017            0.000 
    63        -7910.415             0.016            0.000 
    64        -7910.048             0.016            0.000 
    65        -7908.938             0.016            0.000 
    66        -7909.292             0.016            0.000 
    67        -7908.715             0.015            0.000 
    68        -7909.441             0.015            0.000 
    69        -7909.161             0.015            0.000 
    70        -7908.639             0.015            0.000 
    71        -7908.882             0.015            0.000 
    72        -7908.317             0.014            0.000 
    73        -7908.273             0.014            0.000 
    74        -7909.184             0.014            0.000 
    75        -7910.794             0.014            0.000 
    76        -7910.069             0.014            0.000 
    77        -7909.445             0.013            0.000 
    78        -7908.237             0.013            0.000 
    79        -7909.160             0.013            0.000 
    80        -7909.107             0.013            0.000 
    81        -7910.062             0.013            0.000 
    82        -7908.582             0.013            0.000 
    83        -7909.895             0.013            0.000 
    84        -7909.140             0.012            0.000 
    85        -7909.085             0.012            0.000 
    86        -7910.124             0.012            0.000 
    87        -7909.362             0.012            0.000 
    88        -7911.043             0.012            0.000 
    89        -7910.929             0.012            0.000 
    90        -7908.676             0.012            0.000 
    91        -7911.960             0.011            0.000 
    92        -7909.047             0.011            0.000 
    93        -7909.644             0.011            0.000 
    94        -7909.001             0.011            0.000 
    95        -7908.611             0.011            0.000 
    96        -7909.438             0.011            0.000 
    97        -7908.430             0.011            0.000 
    98        -7909.553             0.011            0.000 
    99        -7908.453             0.011            0.000 
   100        -7908.310             0.010            0.000 
   101        -7909.394             0.010            0.000 
   102        -7911.688             0.010            0.000 
   103        -7909.976             0.010            0.000 
   104        -7909.218             0.010            0.000 
   105        -7909.898             0.010            0.000 
   106        -7908.768             0.010            0.000 
   107        -7909.583             0.010            0.000 
   108        -7907.929             0.010            0.000 
   109        -7909.735             0.010            0.000 
   110        -7908.058             0.009            0.000 
   111        -7908.665             0.009            0.000 
   112        -7908.664             0.009            0.000 
   113        -7908.102             0.009            0.000 
   114        -7908.357             0.009            0.000 
   115        -7909.592             0.009            0.000 
   116        -7910.082             0.009            0.000 
   117        -7909.411             0.009            0.000 
   118        -7912.408             0.009            0.000 
   119        -7910.295             0.009            0.000 
   120        -7911.408             0.009            0.000 
   121        -7908.837             0.009            0.000 
   122        -7909.650             0.009            0.000 
   123        -7909.743             0.008            0.000 
   124        -7910.443             0.008            0.000 
   125        -7908.731             0.008            0.000 
   126        -7909.079             0.008            0.000 
   127        -7909.755             0.008            0.000 
   128        -7911.184             0.008            0.000 
   129        -7909.046             0.008            0.000 
   130        -7909.133             0.008            0.000 
   131        -7910.012             0.008            0.000 
   132        -7908.478             0.008            0.000 
   133        -7907.823             0.008            0.000 
   134        -7908.956             0.008            0.000 
   135        -7908.228             0.008            0.000 
   136        -7910.525             0.008            0.000 
   137        -7908.693             0.008            0.000 
   138        -7909.088             0.008            0.000 
   139        -7908.665             0.008            0.000 
   140        -7909.833             0.007            0.000 
   141        -7908.872             0.007            0.000 
   142        -7909.195             0.007            0.000 
   143        -7909.517             0.007            0.000 
   144        -7908.110             0.007            0.000 
   145        -7908.519             0.007            0.000 
   146        -7909.719             0.007            0.000 
   147        -7908.475             0.007            0.000 
   148        -7910.337             0.007            0.000 
   149        -7907.786             0.007            0.000 
   150        -7908.559             0.007            0.000 
   151        -7909.967             0.007            0.000 
   152        -7908.283             0.007            0.000 
   153        -7909.115             0.007            0.000 
   154        -7909.398             0.007            0.000 
   155        -7908.889             0.007            0.000 
   156        -7909.113             0.007            0.000 
   157        -7909.022             0.007            0.000 
   158        -7908.575             0.007            0.000 
   159        -7909.525             0.007            0.000 
   160        -7908.412             0.007            0.000 
   161        -7908.383             0.007            0.000 
   162        -7909.417             0.006            0.000 
   163        -7908.980             0.006            0.000 
   164        -7908.807             0.006            0.000 
   165        -7908.286             0.006            0.000 
   166        -7908.366             0.006            0.000 
   167        -7908.425             0.006            0.000 
   168        -7908.828             0.006            0.000 
   169        -7908.416             0.006            0.000 
   170        -7908.656             0.006            0.000 
   171        -7908.552             0.006            0.000 
   172        -7909.026             0.006            0.000 
   173        -7909.087             0.006            0.000 
   174        -7908.749             0.006            0.000 
   175        -7909.128             0.006            0.000 
   176        -7908.630             0.006            0.000 
   177        -7908.980             0.006            0.000 
   178        -7909.134             0.006            0.000 
   179        -7909.093             0.006            0.000 
   180        -7909.406             0.006            0.000 
   181        -7908.885             0.006            0.000 
   182        -7908.950             0.006            0.000 
   183        -7908.231             0.006            0.000 
   184        -7908.922             0.006            0.000 
   185        -7908.481             0.006            0.000 
   186        -7908.432             0.006            0.000 
   187        -7908.366             0.006            0.000 
   188        -7908.394             0.006            0.000 
   189        -7910.267             0.006            0.000 
   190        -7908.841             0.006            0.000 
   191        -7908.742             0.005            0.000 
   192        -7908.166             0.005            0.000 
   193        -7908.430             0.005            0.000 
   194        -7908.683             0.005            0.000 
   195        -7909.010             0.005            0.000 
   196        -7908.703             0.005            0.000 
   197        -7908.833             0.005            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  64.3 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7935.62
 mode of lp__ = unnormalized_log_lik = -7918.75last value = -7919.72 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -7918.75last value = -7919.72 dimension of lp__ = 1
 mode of lp_approx after rowSums = -7.44325 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -7.44325 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-7887.31707last value = -7887.4778dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-7887.31707last value = -7887.4778dimension of log_lik = 2481
 [1] "w_ICL 0.99998"     "w_ICL 0.00378021"  "w_ICL 0.060887"   
 [4] "w_ICL 0.999921"    "w_ICL 0.999925"    "w_ICL 0.00651398" 
 [7] "w_ICL 0.000688715" "w_ICL 0.999946"    "w_ICL 0.999261"   
[10] "w_ICL 0.00073915"  "w_ICL 0.998988"    "w_ICL 0.00166605" 
 [1] "post 0.99998"     "post 0.00378021"  "post 0.060887"    "post 0.999921"   
 [5] "post 0.999925"    "post 0.00651398"  "post 0.000688715" "post 0.999946"   
 [9] "post 0.999261"    "post 0.00073915"  "post 0.998988"    "post 0.00166605" 
[1] "post_k 0.99998"
[1] "post_k_entr -0.0105448892767605"  "post_k_entr -0.00683992817952032"
[3] "post_k_entr -0.00537694354112292" "post_k_entr -0.0107158874812485" 
[5] "post_k_entr -0.00822691361592306" "post_k_entr -0.00543394294261892"
[1] "post_k_entr last step 0.0471385050371942"
[1] "res_entropy last step 0.0471385050371942"
[1] "post_k 0.00378021"
[1] "post_k_entr -11.7021304396734" "post_k_entr -7.59057109600436"
[3] "post_k_entr -5.96703227824787" "post_k_entr -11.8918947170735"
[5] "post_k_entr -9.12977023491635" "post_k_entr -6.03028703738124"
[1] "post_k_entr last step 52.3116858032967"
[1] "res_entropy last step 52.3588243083339"
[1] "entropy 52.3588243083339"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=555    segment 2=360    segment 3=283    segment 4=564    segment 5=433    segment 6=286 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 0.999777181508229
  w = 0.000104205802406156
  w = 0.999572488820978
  w = 0.000104186506699219
  w = 0.998228799273881
  w = 0.998952642946481
  w = 0.000222818491771356
  w = 0.999895794197594
  w = 0.00042751117902171
  w = 0.999895813493301
  w = 0.00177120072611914
  w = 0.0010473570535189
 tau = 0.55440151346633
  tau = 0.0635089812217571
 phi = 0.5
  phi = 0.5
 kappa = 5[1] "These are the values used for initializing the model c(0.999777181508229, 0.000104205802406156, 0.999572488820978, 0.000104186506699219, 0.998228799273881, 0.998952642946481, 0.000222818491771356, 0.999895794197594, 0.00042751117902171, 0.999895813493301, 0.00177120072611914, 0.0010473570535189)"
[2] "These are the values used for initializing the model c(0.55440151346633, 0.0635089812217571)"                                                                                                                                                                                                            
[3] "These are the values used for initializing the model c(0.5, 0.5)"                                                                                                                                                                                                                                        
[4] "These are the values used for initializing the model 5"                                                                                                                                                                                                                                                  
Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004148 seconds 
1000 transitions using 10 leapfrog steps per transition would take 41.48 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8078.371             1.000            1.000 
     2        -8127.885             0.503            1.000 
     3        -7974.826             0.342            0.019 
     4        -7939.983             0.257            0.019 
     5        -7962.345             0.206            0.006 
     6        -8065.878             0.174            0.013 
     7        -7955.809             0.151            0.013 
     8        -7934.089             0.133            0.013 
     9        -7928.060             0.118            0.006 
    10        -7924.629             0.106            0.006 
    11        -7923.514             0.097            0.004 
    12        -7920.296             0.089            0.004 
    13        -7917.343             0.082            0.003 
    14        -7924.503             0.076            0.003 
    15        -7919.876             0.071            0.003 
    16        -7917.792             0.067            0.003 
    17        -7918.303             0.063            0.001 
    18        -7917.388             0.059            0.001 
    19        -7914.725             0.056            0.001 
    20        -7914.793             0.053            0.001 
    21        -7915.695             0.051            0.001 
    22        -7914.319             0.048            0.001 
    23        -7914.710             0.046            0.000 
    24        -7915.300             0.044            0.000 
    25        -7912.991             0.043            0.000 
    26        -7913.670             0.041            0.000 
    27        -7913.072             0.040            0.000 
    28        -7912.949             0.038            0.000 
    29        -7912.641             0.037            0.000 
    30        -7915.030             0.036            0.000 
    31        -7913.107             0.034            0.000 
    32        -7912.435             0.033            0.000 
    33        -7912.061             0.032            0.000 
    34        -7915.902             0.031            0.000 
    35        -7912.473             0.031            0.000 
    36        -7911.782             0.030            0.000 
    37        -7910.170             0.029            0.000 
    38        -7912.942             0.028            0.000 
    39        -7911.299             0.027            0.000 
    40        -7910.760             0.027            0.000 
    41        -7911.597             0.026            0.000 
    42        -7909.673             0.025            0.000 
    43        -7909.675             0.025            0.000 
    44        -7910.134             0.024            0.000 
    45        -7912.103             0.024            0.000 
    46        -7911.146             0.023            0.000 
    47        -7908.995             0.023            0.000 
    48        -7912.032             0.022            0.000 
    49        -7909.754             0.022            0.000 
    50        -7909.593             0.021            0.000 
    51        -7908.802             0.021            0.000 
    52        -7910.043             0.021            0.000 
    53        -7909.339             0.020            0.000 
    54        -7909.703             0.020            0.000 
    55        -7910.089             0.019            0.000 
    56        -7910.007             0.019            0.000 
    57        -7910.314             0.019            0.000 
    58        -7908.596             0.018            0.000 
    59        -7908.507             0.018            0.000 
    60        -7908.530             0.018            0.000 
    61        -7908.868             0.018            0.000 
    62        -7912.507             0.017            0.000 
    63        -7909.135             0.017            0.000 
    64        -7909.606             0.017            0.000 
    65        -7909.187             0.017            0.000 
    66        -7908.574             0.016            0.000 
    67        -7912.352             0.016            0.000 
    68        -7912.322             0.016            0.000 
    69        -7909.870             0.016            0.000 
    70        -7909.550             0.015            0.000 
    71        -7908.301             0.015            0.000 
    72        -7909.433             0.015            0.000 
    73        -7909.806             0.015            0.000 
    74        -7910.117             0.015            0.000 
    75        -7908.857             0.014            0.000 
    76        -7911.937             0.014            0.000 
    77        -7908.286             0.014            0.000 
    78        -7909.390             0.014            0.000 
    79        -7909.949             0.014            0.000 
    80        -7908.847             0.013            0.000 
    81        -7909.302             0.013            0.000 
    82        -7910.485             0.013            0.000 
    83        -7909.831             0.013            0.000 
    84        -7908.963             0.013            0.000 
    85        -7910.154             0.013            0.000 
    86        -7908.162             0.013            0.000 
    87        -7909.227             0.012            0.000 
    88        -7909.675             0.012            0.000 
    89        -7909.635             0.012            0.000 
    90        -7911.920             0.012            0.000 
    91        -7910.902             0.012            0.000 
    92        -7909.432             0.012            0.000 
    93        -7908.955             0.012            0.000 
    94        -7910.530             0.011            0.000 
    95        -7908.854             0.011            0.000 
    96        -7909.072             0.011            0.000 
    97        -7908.729             0.011            0.000 
    98        -7909.287             0.011            0.000 
    99        -7908.956             0.011            0.000 
   100        -7908.626             0.011            0.000 
   101        -7908.556             0.011            0.000 
   102        -7908.553             0.011            0.000 
   103        -7907.963             0.010            0.000 
   104        -7909.251             0.010            0.000 
   105        -7908.862             0.010            0.000 
   106        -7908.627             0.010            0.000 
   107        -7909.035             0.010            0.000 
   108        -7910.295             0.010            0.000 
   109        -7908.198             0.010            0.000 
   110        -7909.489             0.010            0.000 
   111        -7909.065             0.010            0.000 
   112        -7908.565             0.010            0.000 
   113        -7909.553             0.010            0.000 
   114        -7908.266             0.009            0.000 
   115        -7908.145             0.009            0.000 
   116        -7908.857             0.009            0.000 
   117        -7908.928             0.009            0.000 
   118        -7908.754             0.009            0.000 
   119        -7910.721             0.009            0.000 
   120        -7909.357             0.009            0.000 
   121        -7909.943             0.009            0.000 
   122        -7910.369             0.009            0.000 
   123        -7908.757             0.009            0.000 
   124        -7908.470             0.009            0.000 
   125        -7908.762             0.009            0.000 
   126        -7909.183             0.009            0.000 
   127        -7909.096             0.009            0.000 
   128        -7908.331             0.008            0.000 
   129        -7909.588             0.008            0.000 
   130        -7908.911             0.008            0.000 
   131        -7908.770             0.008            0.000 
   132        -7909.007             0.008            0.000 
   133        -7909.152             0.008            0.000 
   134        -7909.294             0.008            0.000 
   135        -7910.609             0.008            0.000 
   136        -7909.573             0.008            0.000 
   137        -7908.287             0.008            0.000 
   138        -7908.093             0.008            0.000 
   139        -7910.021             0.008            0.000 
   140        -7909.435             0.008            0.000 
   141        -7911.701             0.008            0.000 
   142        -7908.728             0.008            0.000 
   143        -7908.423             0.008            0.000 
   144        -7910.739             0.008            0.000 
   145        -7908.383             0.007            0.000 
   146        -7909.139             0.007            0.000 
   147        -7908.696             0.007            0.000 
   148        -7908.188             0.007            0.000 
   149        -7909.263             0.007            0.000 
   150        -7910.623             0.007            0.000 
   151        -7908.744             0.007            0.000 
   152        -7908.751             0.007            0.000 
   153        -7909.727             0.007            0.000 
   154        -7908.753             0.007            0.000 
   155        -7909.462             0.007            0.000 
   156        -7908.383             0.007            0.000 
   157        -7908.565             0.007            0.000 
   158        -7909.446             0.007            0.000 
   159        -7909.429             0.007            0.000 
   160        -7908.691             0.007            0.000 
   161        -7909.552             0.007            0.000 
   162        -7909.794             0.007            0.000 
   163        -7908.831             0.007            0.000 
   164        -7908.790             0.007            0.000 
   165        -7908.579             0.007            0.000 
   166        -7910.917             0.007            0.000 
   167        -7909.134             0.006            0.000 
   168        -7908.703             0.006            0.000 
   169        -7909.274             0.006            0.000 
   170        -7908.540             0.006            0.000 
   171        -7909.380             0.006            0.000 
   172        -7909.383             0.006            0.000 
   173        -7909.552             0.006            0.000 
   174        -7908.808             0.006            0.000 
   175        -7909.582             0.006            0.000 
   176        -7908.463             0.006            0.000 
   177        -7908.560             0.006            0.000 
   178        -7911.125             0.006            0.000 
   179        -7910.016             0.006            0.000 
   180        -7908.555             0.006            0.000 
   181        -7910.079             0.006            0.000 
   182        -7909.463             0.006            0.000 
   183        -7908.033             0.006            0.000 
   184        -7908.587             0.006            0.000 
   185        -7909.035             0.006            0.000 
   186        -7908.601             0.006            0.000 
   187        -7910.339             0.006            0.000 
   188        -7909.313             0.006            0.000 
   189        -7908.639             0.006            0.000 
   190        -7908.042             0.006            0.000 
   191        -7910.455             0.006            0.000 
   192        -7908.754             0.006            0.000 
   193        -7908.553             0.006            0.000 
   194        -7908.542             0.006            0.000 
   195        -7908.605             0.006            0.000 
   196        -7911.449             0.006            0.000 
   197        -7908.510             0.006            0.000 
   198        -7908.408             0.006            0.000 
   199        -7908.597             0.005            0.000 
   200        -7908.331             0.005            0.000 
   201        -7908.321             0.005            0.000 
   202        -7907.743             0.005            0.000 
   203        -7909.182             0.005            0.000 
   204        -7908.711             0.005            0.000 
   205        -7909.434             0.005            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  65.8 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7974.83
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004203 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.03 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8088.545             1.000            1.000 
     2        -8001.789             0.505            1.000 
     3        -7947.502             0.339            0.011 
     4        -7943.516             0.255            0.011 
     5        -7945.534             0.204            0.007 
     6        -7932.935             0.170            0.007 
     7        -7925.916             0.146            0.002 
     8        -7928.178             0.128            0.002 
     9        -7928.739             0.113            0.001 
    10        -7931.130             0.102            0.001 
    11        -7923.703             0.093            0.001 
    12        -7923.129             0.085            0.001 
    13        -7926.544             0.079            0.001 
    14        -7923.550             0.073            0.001 
    15        -7921.882             0.068            0.000 
    16        -7933.043             0.064            0.001 
    17        -7926.065             0.060            0.001 
    18        -7918.259             0.057            0.001 
    19        -7920.570             0.054            0.001 
    20        -7916.478             0.051            0.001 
    21        -7916.939             0.049            0.001 
    22        -7915.213             0.047            0.001 
    23        -7921.340             0.045            0.001 
    24        -7913.620             0.043            0.001 
    25        -7913.713             0.041            0.001 
    26        -7914.865             0.040            0.001 
    27        -7917.554             0.038            0.000 
    28        -7916.964             0.037            0.000 
    29        -7912.236             0.036            0.000 
    30        -7915.102             0.034            0.000 
    31        -7913.774             0.033            0.000 
    32        -7912.685             0.032            0.000 
    33        -7913.165             0.031            0.000 
    34        -7912.232             0.030            0.000 
    35        -7912.507             0.029            0.000 
    36        -7912.146             0.029            0.000 
    37        -7913.920             0.028            0.000 
    38        -7912.172             0.027            0.000 
    39        -7911.569             0.026            0.000 
    40        -7911.076             0.026            0.000 
    41        -7911.303             0.025            0.000 
    42        -7913.774             0.025            0.000 
    43        -7910.472             0.024            0.000 
    44        -7914.614             0.023            0.000 
    45        -7912.997             0.023            0.000 
    46        -7911.651             0.022            0.000 
    47        -7910.330             0.022            0.000 
    48        -7912.000             0.022            0.000 
    49        -7911.555             0.021            0.000 
    50        -7909.720             0.021            0.000 
    51        -7909.372             0.020            0.000 
    52        -7912.978             0.020            0.000 
    53        -7909.437             0.020            0.000 
    54        -7909.669             0.019            0.000 
    55        -7911.039             0.019            0.000 
    56        -7909.180             0.019            0.000 
    57        -7912.330             0.018            0.000 
    58        -7908.491             0.018            0.000 
    59        -7909.353             0.018            0.000 
    60        -7910.124             0.017            0.000 
    61        -7909.543             0.017            0.000 
    62        -7910.123             0.017            0.000 
    63        -7909.783             0.016            0.000 
    64        -7910.336             0.016            0.000 
    65        -7908.447             0.016            0.000 
    66        -7909.030             0.016            0.000 
    67        -7909.084             0.015            0.000 
    68        -7909.976             0.015            0.000 
    69        -7909.467             0.015            0.000 
    70        -7909.240             0.015            0.000 
    71        -7910.826             0.015            0.000 
    72        -7909.016             0.014            0.000 
    73        -7908.467             0.014            0.000 
    74        -7909.323             0.014            0.000 
    75        -7910.259             0.014            0.000 
    76        -7909.608             0.014            0.000 
    77        -7910.262             0.013            0.000 
    78        -7908.963             0.013            0.000 
    79        -7908.289             0.013            0.000 
    80        -7908.832             0.013            0.000 
    81        -7909.454             0.013            0.000 
    82        -7909.917             0.013            0.000 
    83        -7909.894             0.013            0.000 
    84        -7908.013             0.012            0.000 
    85        -7908.415             0.012            0.000 
    86        -7908.415             0.012            0.000 
    87        -7908.587             0.012            0.000 
    88        -7909.018             0.012            0.000 
    89        -7908.726             0.012            0.000 
    90        -7908.732             0.012            0.000 
    91        -7908.821             0.011            0.000 
    92        -7911.188             0.011            0.000 
    93        -7910.165             0.011            0.000 
    94        -7911.134             0.011            0.000 
    95        -7909.806             0.011            0.000 
    96        -7911.559             0.011            0.000 
    97        -7912.539             0.011            0.000 
    98        -7909.685             0.011            0.000 
    99        -7909.473             0.011            0.000 
   100        -7909.788             0.010            0.000 
   101        -7909.281             0.010            0.000 
   102        -7908.635             0.010            0.000 
   103        -7909.101             0.010            0.000 
   104        -7909.794             0.010            0.000 
   105        -7914.569             0.010            0.000 
   106        -7914.520             0.010            0.000 
   107        -7914.995             0.010            0.000 
   108        -7912.474             0.010            0.000 
   109        -7909.898             0.010            0.000 
   110        -7908.677             0.009            0.000 
   111        -7909.559             0.009            0.000 
   112        -7909.215             0.009            0.000 
   113        -7909.420             0.009            0.000 
   114        -7908.178             0.009            0.000 
   115        -7911.135             0.009            0.000 
   116        -7909.121             0.009            0.000 
   117        -7908.305             0.009            0.000 
   118        -7908.749             0.009            0.000 
   119        -7909.810             0.009            0.000 
   120        -7910.684             0.009            0.000 
   121        -7908.966             0.009            0.000 
   122        -7908.337             0.009            0.000 
   123        -7909.111             0.008            0.000 
   124        -7908.550             0.008            0.000 
   125        -7908.190             0.008            0.000 
   126        -7908.149             0.008            0.000 
   127        -7908.463             0.008            0.000 
   128        -7910.043             0.008            0.000 
   129        -7909.155             0.008            0.000 
   130        -7908.743             0.008            0.000 
   131        -7908.296             0.008            0.000 
   132        -7908.375             0.008            0.000 
   133        -7909.370             0.008            0.000 
   134        -7908.733             0.008            0.000 
   135        -7908.263             0.008            0.000 
   136        -7908.883             0.008            0.000 
   137        -7909.100             0.008            0.000 
   138        -7910.297             0.008            0.000 
   139        -7908.760             0.008            0.000 
   140        -7908.216             0.007            0.000 
   141        -7908.526             0.007            0.000 
   142        -7908.308             0.007            0.000 
   143        -7908.520             0.007            0.000 
   144        -7908.353             0.007            0.000 
   145        -7910.050             0.007            0.000 
   146        -7908.184             0.007            0.000 
   147        -7908.482             0.007            0.000 
   148        -7909.652             0.007            0.000 
   149        -7908.592             0.007            0.000 
   150        -7910.557             0.007            0.000 
   151        -7908.484             0.007            0.000 
   152        -7910.222             0.007            0.000 
   153        -7910.430             0.007            0.000 
   154        -7910.556             0.007            0.000 
   155        -7909.810             0.007            0.000 
   156        -7909.019             0.007            0.000 
   157        -7908.616             0.007            0.000 
   158        -7909.407             0.007            0.000 
   159        -7908.391             0.007            0.000 
   160        -7909.510             0.007            0.000 
   161        -7910.253             0.007            0.000 
   162        -7910.522             0.006            0.000 
   163        -7909.287             0.006            0.000 
   164        -7909.930             0.006            0.000 
   165        -7910.416             0.006            0.000 
   166        -7908.802             0.006            0.000 
   167        -7908.359             0.006            0.000 
   168        -7908.463             0.006            0.000 
   169        -7908.263             0.006            0.000 
   170        -7908.595             0.006            0.000 
   171        -7909.774             0.006            0.000 
   172        -7908.778             0.006            0.000 
   173        -7909.057             0.006            0.000 
   174        -7909.620             0.006            0.000 
   175        -7908.782             0.006            0.000 
   176        -7910.047             0.006            0.000 
   177        -7909.298             0.006            0.000 
   178        -7908.662             0.006            0.000 
   179        -7909.511             0.006            0.000 
   180        -7909.196             0.006            0.000 
   181        -7908.557             0.006            0.000 
   182        -7908.440             0.006            0.000 
   183        -7909.990             0.006            0.000 
   184        -7909.437             0.006            0.000 
   185        -7908.430             0.006            0.000 
   186        -7908.450             0.006            0.000 
   187        -7910.250             0.006            0.000 
   188        -7908.451             0.006            0.000 
   189        -7909.363             0.006            0.000 
   190        -7909.895             0.006            0.000 
   191        -7908.818             0.006            0.000 
   192        -7908.383             0.005            0.000 
   193        -7911.800             0.005            0.000 
   194        -7910.211             0.005            0.000 
   195        -7909.915             0.005            0.000 
   196        -7908.333             0.005            0.000 
   197        -7909.431             0.005            0.000 
   198        -7908.143             0.005            0.000 
   199        -7908.884             0.005            0.000 
   200        -7909.445             0.005            0.000 
   201        -7908.752             0.005            0.000 
   202        -7908.192             0.005            0.000 
   203        -7909.867             0.005            0.000 
   204        -7909.982             0.005            0.000 
   205        -7909.077             0.005            0.000 
   206        -7909.376             0.005            0.000 
   207        -7909.227             0.005            0.000 
   208        -7908.685             0.005            0.000 
   209        -7909.326             0.005            0.000 
   210        -7909.338             0.005            0.000 
   211        -7908.743             0.005            0.000 
   212        -7909.059             0.005            0.000 
   213        -7909.006             0.005            0.000 
   214        -7909.328             0.005            0.000 
   215        -7911.084             0.005            0.000 
   216        -7908.320             0.005            0.000 
   217        -7909.062             0.005            0.000 
   218        -7908.073             0.005            0.000 
   219        -7908.826             0.005            0.000 
   220        -7910.006             0.005            0.000 
   221        -7909.297             0.005            0.000 
   222        -7908.221             0.005            0.000 
   223        -7908.992             0.005            0.000 
   224        -7909.777             0.005            0.000 
   225        -7908.504             0.005            0.000 
   226        -7908.301             0.005            0.000 
   227        -7911.118             0.005            0.000 
   228        -7909.157             0.005            0.000 
   229        -7908.918             0.005            0.000 
   230        -7908.661             0.005            0.000 
   231        -7908.013             0.005            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  71.6 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7947.5
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004252 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.52 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8072.092             1.000            1.000 
     2        -8108.703             0.502            1.000 
     3        -7979.844             0.340            0.016 
     4        -7939.186             0.256            0.016 
     5        -7934.202             0.205            0.005 
     6        -7926.791             0.171            0.005 
     7        -7925.719             0.147            0.005 
     8        -7922.427             0.128            0.005 
     9        -7921.398             0.114            0.001 
    10        -7919.674             0.103            0.001 
    11        -7917.343             0.094            0.001 
    12        -7920.386             0.086            0.001 
    13        -7917.637             0.079            0.000 
    14        -7917.320             0.074            0.000 
    15        -7914.181             0.069            0.000 
    16        -7916.794             0.064            0.000 
    17        -7914.294             0.061            0.000 
    18        -7916.023             0.057            0.000 
    19        -7916.877             0.054            0.000 
    20        -7912.600             0.052            0.000 
    21        -7913.435             0.049            0.000 
    22        -7914.846             0.047            0.000 
    23        -7912.724             0.045            0.000 
    24        -7911.520             0.043            0.000 
    25        -7911.209             0.041            0.000 
    26        -7911.009             0.040            0.000 
    27        -7913.067             0.038            0.000 
    28        -7910.979             0.037            0.000 
    29        -7910.977             0.036            0.000 
    30        -7909.562             0.034            0.000 
    31        -7910.862             0.033            0.000 
    32        -7909.370             0.032            0.000 
    33        -7909.931             0.031            0.000 
    34        -7909.911             0.030            0.000 
    35        -7910.979             0.030            0.000 
    36        -7915.429             0.029            0.000 
    37        -7910.174             0.028            0.000 
    38        -7909.169             0.027            0.000 
    39        -7911.930             0.027            0.000 
    40        -7911.095             0.026            0.000 
    41        -7911.640             0.025            0.000 
    42        -7909.386             0.025            0.000 
    43        -7909.907             0.024            0.000 
    44        -7910.602             0.024            0.000 
    45        -7909.064             0.023            0.000 
    46        -7909.951             0.023            0.000 
    47        -7909.519             0.022            0.000 
    48        -7913.841             0.022            0.000 
    49        -7910.252             0.021            0.000 
    50        -7909.658             0.021            0.000 
    51        -7909.337             0.020            0.000 
    52        -7908.481             0.020            0.000 
    53        -7908.817             0.020            0.000 
    54        -7909.101             0.019            0.000 
    55        -7907.954             0.019            0.000 
    56        -7910.316             0.019            0.000 
    57        -7909.130             0.018            0.000 
    58        -7909.190             0.018            0.000 
    59        -7909.195             0.018            0.000 
    60        -7908.805             0.017            0.000 
    61        -7908.601             0.017            0.000 
    62        -7909.729             0.017            0.000 
    63        -7910.111             0.016            0.000 
    64        -7912.241             0.016            0.000 
    65        -7909.306             0.016            0.000 
    66        -7910.427             0.016            0.000 
    67        -7908.592             0.016            0.000 
    68        -7909.721             0.015            0.000 
    69        -7907.990             0.015            0.000 
    70        -7908.839             0.015            0.000 
    71        -7909.667             0.015            0.000 
    72        -7908.880             0.014            0.000 
    73        -7909.215             0.014            0.000 
    74        -7908.963             0.014            0.000 
    75        -7910.249             0.014            0.000 
    76        -7908.632             0.014            0.000 
    77        -7908.999             0.014            0.000 
    78        -7909.891             0.013            0.000 
    79        -7909.242             0.013            0.000 
    80        -7908.887             0.013            0.000 
    81        -7909.764             0.013            0.000 
    82        -7909.571             0.013            0.000 
    83        -7908.815             0.013            0.000 
    84        -7909.843             0.012            0.000 
    85        -7910.007             0.012            0.000 
    86        -7910.007             0.012            0.000 
    87        -7910.141             0.012            0.000 
    88        -7908.401             0.012            0.000 
    89        -7908.647             0.012            0.000 
    90        -7908.703             0.012            0.000 
    91        -7909.111             0.011            0.000 
    92        -7908.412             0.011            0.000 
    93        -7908.884             0.011            0.000 
    94        -7910.258             0.011            0.000 
    95        -7909.622             0.011            0.000 
    96        -7908.658             0.011            0.000 
    97        -7908.872             0.011            0.000 
    98        -7908.932             0.011            0.000 
    99        -7909.249             0.011            0.000 
   100        -7908.884             0.010            0.000 
   101        -7909.307             0.010            0.000 
   102        -7908.656             0.010            0.000 
   103        -7908.256             0.010            0.000 
   104        -7910.070             0.010            0.000 
   105        -7909.374             0.010            0.000 
   106        -7909.025             0.010            0.000 
   107        -7908.954             0.010            0.000 
   108        -7908.520             0.010            0.000 
   109        -7908.716             0.010            0.000 
   110        -7908.622             0.009            0.000 
   111        -7909.943             0.009            0.000 
   112        -7908.867             0.009            0.000 
   113        -7908.756             0.009            0.000 
   114        -7909.181             0.009            0.000 
   115        -7909.200             0.009            0.000 
   116        -7913.180             0.009            0.000 
   117        -7909.638             0.009            0.000 
   118        -7908.440             0.009            0.000 
   119        -7911.418             0.009            0.000 
   120        -7913.149             0.009            0.000 
   121        -7909.331             0.009            0.000 
   122        -7909.419             0.009            0.000 
   123        -7910.146             0.008            0.000 
   124        -7908.983             0.008            0.000 
   125        -7909.240             0.008            0.000 
   126        -7908.822             0.008            0.000 
   127        -7908.400             0.008            0.000 
   128        -7908.225             0.008            0.000 
   129        -7908.550             0.008            0.000 
   130        -7907.918             0.008            0.000 
   131        -7908.896             0.008            0.000 
   132        -7908.902             0.008            0.000 
   133        -7909.639             0.008            0.000 
   134        -7909.423             0.008            0.000 
   135        -7908.222             0.008            0.000 
   136        -7908.344             0.008            0.000 
   137        -7909.239             0.008            0.000 
   138        -7908.250             0.008            0.000 
   139        -7908.609             0.008            0.000 
   140        -7909.354             0.007            0.000 
   141        -7908.520             0.007            0.000 
   142        -7908.557             0.007            0.000 
   143        -7908.785             0.007            0.000 
   144        -7908.757             0.007            0.000 
   145        -7908.833             0.007            0.000 
   146        -7909.333             0.007            0.000 
   147        -7909.209             0.007            0.000 
   148        -7910.030             0.007            0.000 
   149        -7910.085             0.007            0.000 
   150        -7910.030             0.007            0.000 
   151        -7909.451             0.007            0.000 
   152        -7909.135             0.007            0.000 
   153        -7909.874             0.007            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  46.2 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7979.84
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004261 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.61 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -7966.417             1.000            1.000 
     2        -8400.435             0.526            1.000 
     3        -7965.128             0.369            0.055 
     4        -7944.215             0.277            0.055 
     5        -7946.969             0.222            0.052 
     6        -7934.669             0.185            0.052 
     7        -7932.569             0.159            0.003 
     8        -7945.198             0.139            0.003 
     9        -7926.143             0.124            0.002 
    10        -7928.436             0.112            0.002 
    11        -7924.553             0.101            0.002 
    12        -7920.628             0.093            0.002 
    13        -7919.878             0.086            0.002 
    14        -7922.156             0.080            0.002 
    15        -7918.836             0.074            0.000 
    16        -7916.234             0.070            0.000 
    17        -7915.570             0.066            0.000 
    18        -7917.892             0.062            0.000 
    19        -7920.412             0.059            0.000 
    20        -7917.549             0.056            0.000 
    21        -7917.168             0.053            0.000 
    22        -7916.474             0.051            0.000 
    23        -7919.312             0.049            0.000 
    24        -7916.536             0.047            0.000 
    25        -7916.056             0.045            0.000 
    26        -7916.246             0.043            0.000 
    27        -7916.253             0.041            0.000 
    28        -7913.849             0.040            0.000 
    29        -7913.395             0.039            0.000 
    30        -7914.007             0.037            0.000 
    31        -7913.586             0.036            0.000 
    32        -7912.947             0.035            0.000 
    33        -7912.306             0.034            0.000 
    34        -7912.958             0.033            0.000 
    35        -7915.250             0.032            0.000 
    36        -7911.808             0.031            0.000 
    37        -7912.532             0.030            0.000 
    38        -7913.239             0.030            0.000 
    39        -7909.459             0.029            0.000 
    40        -7911.480             0.028            0.000 
    41        -7912.218             0.027            0.000 
    42        -7910.941             0.027            0.000 
    43        -7911.252             0.026            0.000 
    44        -7910.727             0.026            0.000 
    45        -7909.405             0.025            0.000 
    46        -7911.111             0.024            0.000 
    47        -7910.692             0.024            0.000 
    48        -7910.683             0.023            0.000 
    49        -7912.567             0.023            0.000 
    50        -7912.195             0.022            0.000 
    51        -7910.802             0.022            0.000 
    52        -7909.956             0.022            0.000 
    53        -7910.017             0.021            0.000 
    54        -7912.748             0.021            0.000 
    55        -7909.770             0.020            0.000 
    56        -7910.067             0.020            0.000 
    57        -7910.858             0.020            0.000 
    58        -7909.113             0.019            0.000 
    59        -7909.520             0.019            0.000 
    60        -7909.822             0.019            0.000 
    61        -7910.309             0.018            0.000 
    62        -7910.525             0.018            0.000 
    63        -7908.735             0.018            0.000 
    64        -7908.987             0.018            0.000 
    65        -7909.628             0.017            0.000 
    66        -7908.989             0.017            0.000 
    67        -7909.870             0.017            0.000 
    68        -7909.405             0.017            0.000 
    69        -7908.957             0.016            0.000 
    70        -7908.268             0.016            0.000 
    71        -7912.080             0.016            0.000 
    72        -7909.623             0.016            0.000 
    73        -7908.583             0.015            0.000 
    74        -7909.072             0.015            0.000 
    75        -7910.905             0.015            0.000 
    76        -7910.387             0.015            0.000 
    77        -7908.837             0.015            0.000 
    78        -7908.339             0.014            0.000 
    79        -7909.156             0.014            0.000 
    80        -7909.605             0.014            0.000 
    81        -7909.091             0.014            0.000 
    82        -7909.340             0.014            0.000 
    83        -7910.139             0.014            0.000 
    84        -7909.119             0.013            0.000 
    85        -7910.061             0.013            0.000 
    86        -7910.009             0.013            0.000 
    87        -7908.709             0.013            0.000 
    88        -7910.396             0.013            0.000 
    89        -7908.826             0.013            0.000 
    90        -7908.555             0.013            0.000 
    91        -7908.799             0.012            0.000 
    92        -7909.248             0.012            0.000 
    93        -7909.868             0.012            0.000 
    94        -7909.345             0.012            0.000 
    95        -7908.445             0.012            0.000 
    96        -7908.972             0.012            0.000 
    97        -7909.448             0.012            0.000 
    98        -7909.755             0.012            0.000 
    99        -7909.232             0.011            0.000 
   100        -7907.838             0.011            0.000 
   101        -7907.889             0.011            0.000 
   102        -7909.226             0.011            0.000 
   103        -7909.074             0.011            0.000 
   104        -7908.447             0.011            0.000 
   105        -7908.746             0.011            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  46.7 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7965.13
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=555    segment 2=360    segment 3=283    segment 4=564    segment 5=433    segment 6=286 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Saving 7 x 7 in image
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 1
  w = 1
  w = 1
  w = 1
  w = 1
  w = 1
 tau = 0.390765312975253
 phi = 1
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002295 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.95 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8298.093             1.000            1.000 
     2        -8094.320             0.513            1.000 
     3        -8081.941             0.342            0.025 
     4        -8084.825             0.257            0.025 
     5        -8084.310             0.205            0.002 
     6        -8084.388             0.171            0.002 
     7        -8076.826             0.147            0.001 
     8        -8080.351             0.129            0.001 
     9        -8078.498             0.114            0.000 
    10        -8076.717             0.103            0.000 
    11        -8075.296             0.094            0.000 
    12        -8076.351             0.086            0.000 
    13        -8075.064             0.079            0.000 
    14        -8074.221             0.074            0.000 
    15        -8075.767             0.069            0.000 
    16        -8073.095             0.064            0.000 
    17        -8073.547             0.061            0.000 
    18        -8071.534             0.057            0.000 
    19        -8071.361             0.054            0.000 
    20        -8071.434             0.052            0.000 
    21        -8071.118             0.049            0.000 
    22        -8071.522             0.047            0.000 
    23        -8070.091             0.045            0.000 
    24        -8070.770             0.043            0.000 
    25        -8071.144             0.041            0.000 
    26        -8070.296             0.040            0.000 
    27        -8068.425             0.038            0.000 
    28        -8071.234             0.037            0.000 
    29        -8069.513             0.036            0.000 
    30        -8071.146             0.034            0.000 
    31        -8069.912             0.033            0.000 
    32        -8067.567             0.032            0.000 
    33        -8069.087             0.031            0.000 
    34        -8068.106             0.030            0.000 
    35        -8068.416             0.030            0.000 
    36        -8068.646             0.029            0.000 
    37        -8071.104             0.028            0.000 
    38        -8069.492             0.027            0.000 
    39        -8068.142             0.026            0.000 
    40        -8068.444             0.026            0.000 
    41        -8070.325             0.025            0.000 
    42        -8068.265             0.025            0.000 
    43        -8067.074             0.024            0.000 
    44        -8067.368             0.024            0.000 
    45        -8067.632             0.023            0.000 
    46        -8067.681             0.022            0.000 
    47        -8068.443             0.022            0.000 
    48        -8067.246             0.022            0.000 
    49        -8067.390             0.021            0.000 
    50        -8067.038             0.021            0.000 
    51        -8067.205             0.020            0.000 
    52        -8069.379             0.020            0.000 
    53        -8067.137             0.020            0.000 
    54        -8070.313             0.019            0.000 
    55        -8068.224             0.019            0.000 
    56        -8067.348             0.018            0.000 
    57        -8066.900             0.018            0.000 
    58        -8067.293             0.018            0.000 
    59        -8067.230             0.018            0.000 
    60        -8068.289             0.017            0.000 
    61        -8066.863             0.017            0.000 
    62        -8066.764             0.017            0.000 
    63        -8066.433             0.016            0.000 
    64        -8066.818             0.016            0.000 
    65        -8066.689             0.016            0.000 
    66        -8066.773             0.016            0.000 
    67        -8066.402             0.015            0.000 
    68        -8066.301             0.015            0.000 
    69        -8066.043             0.015            0.000 
    70        -8067.021             0.015            0.000 
    71        -8066.761             0.015            0.000 
    72        -8066.057             0.014            0.000 
    73        -8066.428             0.014            0.000 
    74        -8066.751             0.014            0.000 
    75        -8067.958             0.014            0.000 
    76        -8068.002             0.014            0.000 
    77        -8066.279             0.013            0.000 
    78        -8066.404             0.013            0.000 
    79        -8065.896             0.013            0.000 
    80        -8066.442             0.013            0.000 
    81        -8066.467             0.013            0.000 
    82        -8066.727             0.013            0.000 
    83        -8066.229             0.012            0.000 
    84        -8065.873             0.012            0.000 
    85        -8066.450             0.012            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  24.0 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8081.94
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002284 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.84 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8215.894             1.000            1.000 
     2        -8181.365             0.502            1.000 
     3        -8092.295             0.338            0.011 
     4        -8076.261             0.254            0.011 
     5        -8073.539             0.204            0.004 
     6        -8072.411             0.170            0.004 
     7        -8070.471             0.145            0.002 
     8        -8081.048             0.127            0.002 
     9        -8072.798             0.113            0.001 
    10        -8071.999             0.102            0.001 
    11        -8070.367             0.093            0.001 
    12        -8070.290             0.085            0.001 
    13        -8073.658             0.079            0.000 
    14        -8069.727             0.073            0.000 
    15        -8069.345             0.068            0.000 
    16        -8070.569             0.064            0.000 
    17        -8068.138             0.060            0.000 
    18        -8067.516             0.057            0.000 
    19        -8070.805             0.054            0.000 
    20        -8068.026             0.051            0.000 
    21        -8067.795             0.049            0.000 
    22        -8066.939             0.046            0.000 
    23        -8067.888             0.044            0.000 
    24        -8067.098             0.043            0.000 
    25        -8068.954             0.041            0.000 
    26        -8068.635             0.039            0.000 
    27        -8066.403             0.038            0.000 
    28        -8067.382             0.037            0.000 
    29        -8068.639             0.035            0.000 
    30        -8066.953             0.034            0.000 
    31        -8067.822             0.033            0.000 
    32        -8066.360             0.032            0.000 
    33        -8068.244             0.031            0.000 
    34        -8067.322             0.030            0.000 
    35        -8066.393             0.029            0.000 
    36        -8066.996             0.028            0.000 
    37        -8066.297             0.028            0.000 
    38        -8066.695             0.027            0.000 
    39        -8067.278             0.026            0.000 
    40        -8066.173             0.026            0.000 
    41        -8066.521             0.025            0.000 
    42        -8066.181             0.024            0.000 
    43        -8066.576             0.024            0.000 
    44        -8066.344             0.023            0.000 
    45        -8066.988             0.023            0.000 
    46        -8071.824             0.022            0.000 
    47        -8068.440             0.022            0.000 
    48        -8066.805             0.021            0.000 
    49        -8066.235             0.021            0.000 
    50        -8066.483             0.021            0.000 
    51        -8066.216             0.020            0.000 
    52        -8066.102             0.020            0.000 
    53        -8066.326             0.019            0.000 
    54        -8066.634             0.019            0.000 
    55        -8066.174             0.019            0.000 
    56        -8066.111             0.018            0.000 
    57        -8065.923             0.018            0.000 
    58        -8066.169             0.018            0.000 
    59        -8066.178             0.017            0.000 
    60        -8066.541             0.017            0.000 
    61        -8066.580             0.017            0.000 
    62        -8066.792             0.017            0.000 
    63        -8067.055             0.016            0.000 
    64        -8066.945             0.016            0.000 
    65        -8066.688             0.016            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  19.0 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8092.29
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.00231 seconds 
1000 transitions using 10 leapfrog steps per transition would take 23.1 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8252.478             1.000            1.000 
     2        -8327.214             0.504            1.000 
     3        -8121.993             0.345            0.025 
     4        -8087.183             0.260            0.025 
     5        -8087.470             0.208            0.009 
     6        -8082.969             0.173            0.009 
     7        -8082.162             0.148            0.004 
     8        -8075.962             0.130            0.004 
     9        -8079.306             0.116            0.001 
    10        -8079.302             0.104            0.001 
    11        -8073.550             0.095            0.001 
    12        -8075.682             0.087            0.001 
    13        -8073.703             0.080            0.001 
    14        -8075.127             0.074            0.001 
    15        -8072.850             0.069            0.000 
    16        -8069.855             0.065            0.000 
    17        -8073.454             0.061            0.000 
    18        -8071.941             0.058            0.000 
    19        -8074.123             0.055            0.000 
    20        -8070.370             0.052            0.000 
    21        -8071.779             0.050            0.000 
    22        -8073.282             0.047            0.000 
    23        -8074.286             0.045            0.000 
    24        -8071.823             0.044            0.000 
    25        -8068.512             0.042            0.000 
    26        -8070.270             0.040            0.000 
    27        -8071.354             0.039            0.000 
    28        -8069.887             0.037            0.000 
    29        -8069.317             0.036            0.000 
    30        -8069.759             0.035            0.000 
    31        -8069.698             0.034            0.000 
    32        -8068.689             0.033            0.000 
    33        -8067.678             0.032            0.000 
    34        -8068.375             0.031            0.000 
    35        -8067.611             0.030            0.000 
    36        -8068.088             0.029            0.000 
    37        -8067.407             0.028            0.000 
    38        -8069.618             0.028            0.000 
    39        -8068.153             0.027            0.000 
    40        -8067.872             0.026            0.000 
    41        -8066.672             0.026            0.000 
    42        -8068.199             0.025            0.000 
    43        -8066.959             0.024            0.000 
    44        -8068.119             0.024            0.000 
    45        -8066.904             0.023            0.000 
    46        -8067.499             0.023            0.000 
    47        -8071.081             0.022            0.000 
    48        -8067.488             0.022            0.000 
    49        -8066.820             0.021            0.000 
    50        -8067.344             0.021            0.000 
    51        -8066.987             0.021            0.000 
    52        -8066.794             0.020            0.000 
    53        -8066.853             0.020            0.000 
    54        -8067.281             0.019            0.000 
    55        -8066.424             0.019            0.000 
    56        -8067.851             0.019            0.000 
    57        -8066.072             0.018            0.000 
    58        -8066.835             0.018            0.000 
    59        -8066.655             0.018            0.000 
    60        -8067.606             0.017            0.000 
    61        -8067.251             0.017            0.000 
    62        -8069.522             0.017            0.000 
    63        -8066.323             0.017            0.000 
    64        -8066.624             0.016            0.000 
    65        -8066.186             0.016            0.000 
    66        -8066.923             0.016            0.000 
    67        -8066.175             0.016            0.000 
    68        -8065.657             0.015            0.000 
    69        -8065.982             0.015            0.000 
    70        -8066.967             0.015            0.000 
    71        -8066.625             0.015            0.000 
    72        -8065.919             0.015            0.000 
    73        -8066.722             0.014            0.000 
    74        -8066.537             0.014            0.000 
    75        -8068.289             0.014            0.000 
    76        -8066.764             0.014            0.000 
    77        -8066.744             0.014            0.000 
    78        -8065.935             0.013            0.000 
    79        -8066.201             0.013            0.000 
    80        -8066.202             0.013            0.000 
    81        -8067.401             0.013            0.000 
    82        -8066.039             0.013            0.000 
    83        -8065.967             0.013            0.000 
    84        -8065.899             0.013            0.000 
    85        -8066.507             0.012            0.000 
    86        -8065.988             0.012            0.000 
    87        -8066.053             0.012            0.000 
    88        -8066.357             0.012            0.000 
    89        -8066.719             0.012            0.000 
    90        -8068.593             0.012            0.000 
    91        -8067.816             0.012            0.000 
    92        -8066.641             0.011            0.000 
    93        -8065.814             0.011            0.000 
    94        -8066.050             0.011            0.000 
    95        -8065.862             0.011            0.000 
    96        -8066.171             0.011            0.000 
    97        -8066.001             0.011            0.000 
    98        -8065.956             0.011            0.000 
    99        -8066.295             0.011            0.000 
   100        -8066.328             0.011            0.000 
   101        -8066.284             0.010            0.000 
   102        -8066.894             0.010            0.000 
   103        -8066.871             0.010            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  28.7 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8121.99
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.002296 seconds 
1000 transitions using 10 leapfrog steps per transition would take 22.96 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8230.572             1.000            1.000 
     2        -8326.759             0.506            1.000 
     3        -8081.829             0.347            0.030 
     4        -8080.588             0.261            0.030 
     5        -8078.363             0.208            0.012 
     6        -8081.686             0.174            0.012 
     7        -8075.209             0.149            0.001 
     8        -8074.013             0.130            0.001 
     9        -8077.108             0.116            0.000 
    10        -8074.335             0.104            0.000 
    11        -8071.594             0.095            0.000 
    12        -8073.011             0.087            0.000 
    13        -8071.266             0.080            0.000 
    14        -8069.394             0.075            0.000 
    15        -8076.265             0.070            0.000 
    16        -8072.270             0.065            0.000 
    17        -8071.144             0.062            0.000 
    18        -8068.989             0.058            0.000 
    19        -8073.695             0.055            0.000 
    20        -8069.137             0.052            0.000 
    21        -8069.874             0.050            0.000 
    22        -8071.107             0.048            0.000 
    23        -8070.755             0.046            0.000 
    24        -8070.081             0.044            0.000 
    25        -8070.143             0.042            0.000 
    26        -8069.947             0.040            0.000 
    27        -8069.239             0.039            0.000 
    28        -8068.700             0.037            0.000 
    29        -8068.174             0.036            0.000 
    30        -8068.536             0.035            0.000 
    31        -8069.458             0.034            0.000 
    32        -8070.215             0.033            0.000 
    33        -8069.573             0.032            0.000 
    34        -8068.947             0.031            0.000 
    35        -8069.447             0.030            0.000 
    36        -8068.586             0.029            0.000 
    37        -8070.302             0.028            0.000 
    38        -8069.544             0.028            0.000 
    39        -8068.381             0.027            0.000 
    40        -8069.832             0.026            0.000 
    41        -8068.871             0.026            0.000 
    42        -8072.577             0.025            0.000 
    43        -8067.823             0.024            0.000 
    44        -8067.004             0.024            0.000 
    45        -8067.294             0.023            0.000 
    46        -8066.971             0.023            0.000 
    47        -8066.759             0.022            0.000 
    48        -8067.311             0.022            0.000 
    49        -8067.040             0.021            0.000 
    50        -8069.033             0.021            0.000 
    51        -8067.228             0.021            0.000 
    52        -8066.952             0.020            0.000 
    53        -8070.159             0.020            0.000 
    54        -8069.637             0.019            0.000 
    55        -8067.006             0.019            0.000 
    56        -8067.421             0.019            0.000 
    57        -8066.709             0.018            0.000 
    58        -8067.411             0.018            0.000 
    59        -8067.065             0.018            0.000 
    60        -8066.324             0.018            0.000 
    61        -8066.637             0.017            0.000 
    62        -8068.321             0.017            0.000 
    63        -8066.261             0.017            0.000 
    64        -8066.166             0.016            0.000 
    65        -8066.208             0.016            0.000 
    66        -8066.617             0.016            0.000 
    67        -8067.792             0.016            0.000 
    68        -8066.447             0.016            0.000 
    69        -8067.125             0.015            0.000 
    70        -8066.080             0.015            0.000 
    71        -8066.049             0.015            0.000 
    72        -8066.084             0.015            0.000 
    73        -8065.852             0.014            0.000 
    74        -8067.086             0.014            0.000 
    75        -8066.279             0.014            0.000 
    76        -8065.870             0.014            0.000 
    77        -8068.392             0.014            0.000 
    78        -8066.089             0.014            0.000 
    79        -8066.003             0.013            0.000 
    80        -8066.160             0.013            0.000 
    81        -8066.553             0.013            0.000 
    82        -8066.619             0.013            0.000 
    83        -8066.144             0.013            0.000 
    84        -8066.886             0.013            0.000 
    85        -8066.349             0.012            0.000 
    86        -8066.799             0.012            0.000 
    87        -8066.586             0.012            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  19.2 seconds.
[[1]]
[[1]]$w
     [,1]
[1,]    1
[2,]    1
[3,]    1
[4,]    1
[5,]    1
[6,]    1

[[1]]$tau
[1] 0.3907653

[[1]]$phi
[1] 1

[[1]]$kappa
[1] 5


ELBO for this run: -8081.83
 mode of lp__ = unnormalized_log_lik = -8064.62last value = -8064.97 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -8064.62last value = -8064.97 dimension of lp__ = 1
 mode of lp_approx after rowSums = -1.84162 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -1.84162 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-8062.78023last value = -8062.91191dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-8062.78023last value = -8062.91191dimension of log_lik = 2481
[1] "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1" "w_ICL 1"
[1] "post 1" "post 1" "post 1" "post 1" "post 1" "post 1"
[1] "post_k 1"
[1] "post_k_entr 0.000554999722454527" "post_k_entr 0.000359999819970504"
[3] "post_k_entr 0.000282999858476813" "post_k_entr 0.00056399971795379" 
[5] "post_k_entr 0.000432999783464523" "post_k_entr 0.000285999856976567"
[1] "post_k_entr last step -0.00248099875929672"
[1] "res_entropy last step -0.00248099875929672"
[1] "entropy -0.00248099875929672"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=555    segment 2=360    segment 3=283    segment 4=564    segment 5=433    segment 6=286 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 0.99977718150826
  w = 0.000104205802406298
  w = 0.999572488820929
  w = 0.000104186506699101
  w = 0.998228799273999
  w = 0.998952642946398
  w = 0.000222818491740168
  w = 0.999895794197594
  w = 0.000427511179071118
  w = 0.999895813493301
  w = 0.0017712007260009
  w = 0.00104735705360174
 tau = 0.554401513466328
  tau = 0.0635089812217571
 phi = 0.5
  phi = 0.5
 kappa = 5Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004234 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.34 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8076.491             1.000            1.000 
     2        -8221.611             0.509            1.000 
     3        -7970.726             0.350            0.031 
     4        -7952.504             0.263            0.031 
     5        -7929.276             0.211            0.018 
     6        -7923.890             0.176            0.018 
     7        -7926.836             0.151            0.003 
     8        -7922.122             0.132            0.003 
     9        -7920.960             0.117            0.002 
    10        -7919.589             0.106            0.002 
    11        -7924.115             0.096            0.001 
    12        -7921.046             0.088            0.001 
    13        -7920.584             0.081            0.001 
    14        -7917.845             0.076            0.001 
    15        -7915.849             0.071            0.001 
    16        -7913.843             0.066            0.001 
    17        -7913.770             0.062            0.000 
    18        -7916.774             0.059            0.000 
    19        -7914.415             0.056            0.000 
    20        -7914.353             0.053            0.000 
    21        -7914.089             0.050            0.000 
    22        -7912.847             0.048            0.000 
    23        -7913.956             0.046            0.000 
    24        -7913.223             0.044            0.000 
    25        -7914.813             0.042            0.000 
    26        -7912.294             0.041            0.000 
    27        -7912.727             0.039            0.000 
    28        -7912.029             0.038            0.000 
    29        -7910.750             0.037            0.000 
    30        -7911.004             0.035            0.000 
    31        -7912.165             0.034            0.000 
    32        -7913.245             0.033            0.000 
    33        -7911.467             0.032            0.000 
    34        -7910.473             0.031            0.000 
    35        -7910.414             0.030            0.000 
    36        -7913.529             0.029            0.000 
    37        -7911.737             0.029            0.000 
    38        -7909.831             0.028            0.000 
    39        -7910.189             0.027            0.000 
    40        -7911.001             0.027            0.000 
    41        -7910.161             0.026            0.000 
    42        -7909.967             0.025            0.000 
    43        -7910.999             0.025            0.000 
    44        -7909.751             0.024            0.000 
    45        -7909.761             0.024            0.000 
    46        -7910.154             0.023            0.000 
    47        -7911.181             0.023            0.000 
    48        -7910.135             0.022            0.000 
    49        -7909.326             0.022            0.000 
    50        -7908.645             0.021            0.000 
    51        -7908.806             0.021            0.000 
    52        -7909.299             0.020            0.000 
    53        -7908.632             0.020            0.000 
    54        -7909.892             0.020            0.000 
    55        -7909.858             0.019            0.000 
    56        -7908.454             0.019            0.000 
    57        -7910.028             0.019            0.000 
    58        -7909.600             0.018            0.000 
    59        -7910.729             0.018            0.000 
    60        -7910.605             0.018            0.000 
    61        -7909.104             0.017            0.000 
    62        -7908.610             0.017            0.000 
    63        -7909.420             0.017            0.000 
    64        -7909.935             0.017            0.000 
    65        -7910.064             0.016            0.000 
    66        -7908.551             0.016            0.000 
    67        -7908.792             0.016            0.000 
    68        -7910.756             0.016            0.000 
    69        -7909.276             0.015            0.000 
    70        -7908.698             0.015            0.000 
    71        -7909.198             0.015            0.000 
    72        -7908.542             0.015            0.000 
    73        -7909.056             0.015            0.000 
    74        -7909.622             0.014            0.000 
    75        -7909.157             0.014            0.000 
    76        -7908.487             0.014            0.000 
    77        -7908.931             0.014            0.000 
    78        -7909.577             0.014            0.000 
    79        -7910.548             0.013            0.000 
    80        -7909.215             0.013            0.000 
    81        -7910.383             0.013            0.000 
    82        -7909.435             0.013            0.000 
    83        -7908.982             0.013            0.000 
    84        -7909.521             0.013            0.000 
    85        -7909.348             0.013            0.000 
    86        -7909.487             0.012            0.000 
    87        -7909.263             0.012            0.000 
    88        -7909.565             0.012            0.000 
    89        -7908.335             0.012            0.000 
    90        -7909.140             0.012            0.000 
    91        -7909.062             0.012            0.000 
    92        -7908.709             0.012            0.000 
    93        -7908.807             0.011            0.000 
    94        -7909.128             0.011            0.000 
    95        -7908.837             0.011            0.000 
    96        -7909.126             0.011            0.000 
    97        -7908.666             0.011            0.000 
    98        -7911.403             0.011            0.000 
    99        -7910.512             0.011            0.000 
   100        -7909.929             0.011            0.000 
   101        -7908.380             0.011            0.000 
   102        -7908.500             0.010            0.000 
   103        -7908.687             0.010            0.000 
   104        -7909.018             0.010            0.000 
   105        -7908.491             0.010            0.000 
   106        -7907.851             0.010            0.000 
   107        -7909.797             0.010            0.000 
   108        -7908.901             0.010            0.000 
   109        -7908.770             0.010            0.000 
   110        -7908.785             0.010            0.000 
   111        -7908.844             0.010            0.000 
   112        -7908.138             0.010            0.000 
   113        -7909.108             0.009            0.000 
   114        -7909.185             0.009            0.000 
   115        -7908.820             0.009            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  48.3 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7970.73
Attempt 2 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004295 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.95 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8086.708             1.000            1.000 
     2        -7963.420             0.508            1.000 
     3        -7940.126             0.339            0.015 
     4        -7945.751             0.255            0.015 
     5        -7925.233             0.204            0.003 
     6        -7921.790             0.170            0.003 
     7        -7921.846             0.146            0.003 
     8        -7918.486             0.128            0.003 
     9        -7917.959             0.114            0.001 
    10        -7917.464             0.102            0.001 
    11        -7916.933             0.093            0.000 
    12        -7915.552             0.085            0.000 
    13        -7914.478             0.079            0.000 
    14        -7915.651             0.073            0.000 
    15        -7916.687             0.068            0.000 
    16        -7918.645             0.064            0.000 
    17        -7914.335             0.060            0.000 
    18        -7912.948             0.057            0.000 
    19        -7912.587             0.054            0.000 
    20        -7912.100             0.051            0.000 
    21        -7911.173             0.049            0.000 
    22        -7910.816             0.047            0.000 
    23        -7912.668             0.045            0.000 
    24        -7912.304             0.043            0.000 
    25        -7913.688             0.041            0.000 
    26        -7911.703             0.039            0.000 
    27        -7910.931             0.038            0.000 
    28        -7910.999             0.037            0.000 
    29        -7910.925             0.035            0.000 
    30        -7911.161             0.034            0.000 
    31        -7910.974             0.033            0.000 
    32        -7910.901             0.032            0.000 
    33        -7910.250             0.031            0.000 
    34        -7910.428             0.030            0.000 
    35        -7909.902             0.029            0.000 
    36        -7910.574             0.028            0.000 
    37        -7910.485             0.028            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  33.6 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7940.13
Attempt 3 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004237 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.37 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8071.086             1.000            1.000 
     2        -8118.477             0.503            1.000 
     3        -7957.754             0.342            0.020 
     4        -7934.216             0.257            0.020 
     5        -7938.951             0.206            0.006 
     6        -7972.252             0.172            0.006 
     7        -7926.971             0.148            0.006 
     8        -7923.895             0.130            0.006 
     9        -7927.166             0.116            0.004 
    10        -7919.484             0.104            0.004 
    11        -7920.609             0.095            0.003 
    12        -7920.781             0.087            0.003 
    13        -7918.687             0.080            0.001 
    14        -7916.597             0.074            0.001 
    15        -7918.151             0.069            0.001 
    16        -7917.180             0.065            0.001 
    17        -7917.662             0.061            0.000 
    18        -7914.528             0.058            0.000 
    19        -7915.271             0.055            0.000 
    20        -7914.152             0.052            0.000 
    21        -7915.968             0.050            0.000 
    22        -7913.372             0.047            0.000 
    23        -7914.672             0.045            0.000 
    24        -7914.017             0.043            0.000 
    25        -7913.642             0.042            0.000 
    26        -7912.915             0.040            0.000 
    27        -7912.204             0.039            0.000 
    28        -7914.208             0.037            0.000 
    29        -7912.410             0.036            0.000 
    30        -7910.851             0.035            0.000 
    31        -7911.601             0.034            0.000 
    32        -7911.590             0.033            0.000 
    33        -7911.342             0.032            0.000 
    34        -7911.738             0.031            0.000 
    35        -7912.132             0.030            0.000 
    36        -7910.531             0.029            0.000 
    37        -7910.541             0.028            0.000 
    38        -7910.534             0.028            0.000 
    39        -7909.915             0.027            0.000 
    40        -7910.375             0.026            0.000 
    41        -7908.789             0.025            0.000 
    42        -7911.273             0.025            0.000 
    43        -7910.828             0.024            0.000 
    44        -7910.163             0.024            0.000 
    45        -7911.224             0.023            0.000 
    46        -7911.059             0.023            0.000 
    47        -7910.255             0.022            0.000 
    48        -7910.834             0.022            0.000 
    49        -7909.776             0.021            0.000 
    50        -7910.655             0.021            0.000 
    51        -7913.232             0.021            0.000 
    52        -7910.284             0.020            0.000 
    53        -7910.235             0.020            0.000 
    54        -7909.617             0.019            0.000 
    55        -7909.001             0.019            0.000 
    56        -7909.883             0.019            0.000 
    57        -7911.469             0.018            0.000 
    58        -7910.535             0.018            0.000 
    59        -7908.755             0.018            0.000 
    60        -7908.837             0.017            0.000 
    61        -7909.959             0.017            0.000 
    62        -7908.942             0.017            0.000 
    63        -7909.216             0.017            0.000 
    64        -7909.260             0.016            0.000 
    65        -7908.786             0.016            0.000 
    66        -7908.541             0.016            0.000 
    67        -7909.157             0.016            0.000 
    68        -7909.318             0.015            0.000 
    69        -7909.642             0.015            0.000 
    70        -7909.757             0.015            0.000 
    71        -7908.968             0.015            0.000 
    72        -7909.331             0.015            0.000 
    73        -7909.318             0.014            0.000 
    74        -7908.958             0.014            0.000 
    75        -7909.153             0.014            0.000 
    76        -7909.045             0.014            0.000 
    77        -7908.096             0.014            0.000 
    78        -7911.686             0.013            0.000 
    79        -7909.978             0.013            0.000 
    80        -7911.005             0.013            0.000 
    81        -7909.820             0.013            0.000 
    82        -7909.760             0.013            0.000 
    83        -7909.423             0.013            0.000 
    84        -7909.832             0.012            0.000 
    85        -7909.637             0.012            0.000 
    86        -7910.546             0.012            0.000 
    87        -7911.130             0.012            0.000 
    88        -7908.579             0.012            0.000 
    89        -7910.072             0.012            0.000 
    90        -7909.206             0.012            0.000 
    91        -7910.693             0.012            0.000 
    92        -7909.860             0.011            0.000 
    93        -7909.520             0.011            0.000 
    94        -7911.302             0.011            0.000 
    95        -7908.482             0.011            0.000 
    96        -7912.653             0.011            0.000 
    97        -7910.047             0.011            0.000 
    98        -7908.486             0.011            0.000 
    99        -7910.504             0.011            0.000 
   100        -7908.852             0.011            0.000 
   101        -7909.178             0.010            0.000 
   102        -7912.440             0.010            0.000 
   103        -7909.299             0.010            0.000 
   104        -7908.689             0.010            0.000 
   105        -7908.585             0.010            0.000 
   106        -7909.348             0.010            0.000 
   107        -7908.608             0.010            0.000 
   108        -7908.790             0.010            0.000 
   109        -7909.452             0.010            0.000 
   110        -7908.491             0.010            0.000 
   111        -7908.948             0.010            0.000 
   112        -7907.722             0.009            0.000 
   113        -7908.220             0.009            0.000 
   114        -7909.422             0.009            0.000 
   115        -7908.421             0.009            0.000 
   116        -7907.864             0.009            0.000 
   117        -7910.223             0.009            0.000 
   118        -7908.465             0.009            0.000 
   119        -7908.747             0.009            0.000 
   120        -7909.520             0.009            0.000 
   121        -7911.265             0.009            0.000 
   122        -7909.618             0.009            0.000 
   123        -7910.327             0.009            0.000 
   124        -7910.309             0.009            0.000 
   125        -7910.598             0.008            0.000 
   126        -7909.244             0.008            0.000 
   127        -7909.380             0.008            0.000 
   128        -7908.826             0.008            0.000 
   129        -7908.640             0.008            0.000 
   130        -7908.981             0.008            0.000 
   131        -7908.777             0.008            0.000 
   132        -7909.326             0.008            0.000 
   133        -7909.310             0.008            0.000 
   134        -7909.753             0.008            0.000 
   135        -7908.510             0.008            0.000 
   136        -7908.292             0.008            0.000 
   137        -7908.487             0.008            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  46.9 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7957.75
Attempt 4 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004281 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.81 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
Iteration: 100 / 250 [ 40%]  (Adaptation) 
Iteration: 150 / 250 [ 60%]  (Adaptation) 
Iteration: 200 / 250 [ 80%]  (Adaptation) 
Success! Found best value [eta = 1] earlier than expected. 
Begin stochastic gradient ascent. 
  iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  
     1        -8060.690             1.000            1.000 
     2        -8095.979             0.502            1.000 
     3        -7935.623             0.342            0.020 
     4        -7931.083             0.256            0.020 
     5        -7932.501             0.205            0.004 
     6        -7928.305             0.171            0.004 
     7        -7929.737             0.147            0.001 
     8        -7921.757             0.128            0.001 
     9        -7923.536             0.114            0.001 
    10        -7921.702             0.103            0.001 
    11        -7921.658             0.093            0.001 
    12        -7920.055             0.086            0.001 
    13        -7917.359             0.079            0.000 
    14        -7916.710             0.073            0.000 
    15        -7915.991             0.069            0.000 
    16        -7919.364             0.064            0.000 
    17        -7913.732             0.061            0.000 
    18        -7912.685             0.057            0.000 
    19        -7915.175             0.054            0.000 
    20        -7914.780             0.051            0.000 
    21        -7915.361             0.049            0.000 
    22        -7912.283             0.047            0.000 
    23        -7915.814             0.045            0.000 
    24        -7912.067             0.043            0.000 
    25        -7913.892             0.041            0.000 
    26        -7912.325             0.040            0.000 
    27        -7910.388             0.038            0.000 
    28        -7912.860             0.037            0.000 
    29        -7912.263             0.036            0.000 
    30        -7910.254             0.034            0.000 
    31        -7910.631             0.033            0.000 
    32        -7909.326             0.032            0.000 
    33        -7910.716             0.031            0.000 
    34        -7912.720             0.030            0.000 
    35        -7911.766             0.030            0.000 
    36        -7910.967             0.029            0.000 
    37        -7909.993             0.028            0.000 
    38        -7909.613             0.027            0.000 
    39        -7910.460             0.027            0.000 
    40        -7910.335             0.026            0.000 
    41        -7912.840             0.025            0.000 
    42        -7910.647             0.025            0.000 
    43        -7908.746             0.024            0.000 
    44        -7909.619             0.024            0.000 
    45        -7909.643             0.023            0.000 
    46        -7910.938             0.022            0.000 
    47        -7910.756             0.022            0.000 
    48        -7910.133             0.022            0.000 
    49        -7909.036             0.021            0.000 
    50        -7910.084             0.021            0.000 
    51        -7909.281             0.020            0.000 
    52        -7908.779             0.020            0.000 
    53        -7909.777             0.020            0.000 
    54        -7911.320             0.019            0.000 
    55        -7911.902             0.019            0.000 
    56        -7910.156             0.018            0.000 
    57        -7909.872             0.018            0.000 
    58        -7910.138             0.018            0.000 
    59        -7910.063             0.018            0.000 
    60        -7910.093             0.017            0.000 
    61        -7909.135             0.017            0.000 
    62        -7908.980             0.017            0.000 
    63        -7910.415             0.016            0.000 
    64        -7910.048             0.016            0.000 
    65        -7908.938             0.016            0.000 
    66        -7909.292             0.016            0.000 
    67        -7908.715             0.015            0.000 
    68        -7909.441             0.015            0.000 
    69        -7909.161             0.015            0.000 
    70        -7908.639             0.015            0.000 
    71        -7908.882             0.015            0.000 
    72        -7908.317             0.014            0.000 
    73        -7908.273             0.014            0.000 
    74        -7909.184             0.014            0.000 
    75        -7910.794             0.014            0.000 
    76        -7910.069             0.014            0.000 
    77        -7909.445             0.013            0.000 
    78        -7908.237             0.013            0.000 
    79        -7909.160             0.013            0.000 
    80        -7909.107             0.013            0.000 
    81        -7910.062             0.013            0.000 
    82        -7908.582             0.013            0.000 
    83        -7909.895             0.013            0.000 
    84        -7909.140             0.012            0.000 
    85        -7909.085             0.012            0.000 
    86        -7910.124             0.012            0.000 
    87        -7909.362             0.012            0.000 
    88        -7911.043             0.012            0.000 
    89        -7910.929             0.012            0.000 
    90        -7908.676             0.012            0.000 
    91        -7911.960             0.011            0.000 
    92        -7909.047             0.011            0.000 
    93        -7909.644             0.011            0.000 
    94        -7909.001             0.011            0.000 
    95        -7908.611             0.011            0.000 
    96        -7909.438             0.011            0.000 
    97        -7908.430             0.011            0.000 
    98        -7909.553             0.011            0.000 
    99        -7908.453             0.011            0.000 
   100        -7908.310             0.010            0.000 
   101        -7909.394             0.010            0.000 
   102        -7911.688             0.010            0.000 
   103        -7909.976             0.010            0.000 
   104        -7909.218             0.010            0.000 
   105        -7909.898             0.010            0.000 
   106        -7908.768             0.010            0.000 
   107        -7909.583             0.010            0.000 
   108        -7907.929             0.010            0.000 
   109        -7909.735             0.010            0.000 
   110        -7908.058             0.009            0.000 
   111        -7908.665             0.009            0.000 
   112        -7908.664             0.009            0.000 
   113        -7908.102             0.009            0.000 
   114        -7908.357             0.009            0.000 
   115        -7909.592             0.009            0.000 
   116        -7910.082             0.009            0.000 
   117        -7909.411             0.009            0.000 
   118        -7912.408             0.009            0.000 
   119        -7910.295             0.009            0.000 
   120        -7911.408             0.009            0.000 
   121        -7908.837             0.009            0.000 
   122        -7909.650             0.009            0.000 
   123        -7909.743             0.008            0.000 
   124        -7910.443             0.008            0.000 
   125        -7908.731             0.008            0.000 
   126        -7909.079             0.008            0.000 
   127        -7909.755             0.008            0.000 
   128        -7911.184             0.008            0.000 
   129        -7909.046             0.008            0.000 
   130        -7909.133             0.008            0.000 
   131        -7910.012             0.008            0.000 
   132        -7908.478             0.008            0.000 
   133        -7907.823             0.008            0.000 
   134        -7908.956             0.008            0.000 
   135        -7908.228             0.008            0.000 
   136        -7910.525             0.008            0.000 
   137        -7908.693             0.008            0.000 
   138        -7909.088             0.008            0.000 
   139        -7908.665             0.008            0.000 
   140        -7909.833             0.007            0.000 
   141        -7908.872             0.007            0.000 
   142        -7909.195             0.007            0.000 
   143        -7909.517             0.007            0.000 
   144        -7908.110             0.007            0.000 
   145        -7908.519             0.007            0.000 
   146        -7909.719             0.007            0.000 
   147        -7908.475             0.007            0.000 
   148        -7910.337             0.007            0.000 
   149        -7907.786             0.007            0.000 
   150        -7908.559             0.007            0.000 
   151        -7909.967             0.007            0.000 
   152        -7908.283             0.007            0.000 
   153        -7909.115             0.007            0.000 
   154        -7909.398             0.007            0.000 
   155        -7908.889             0.007            0.000 
   156        -7909.113             0.007            0.000 
   157        -7909.022             0.007            0.000 
   158        -7908.575             0.007            0.000 
   159        -7909.525             0.007            0.000 
   160        -7908.412             0.007            0.000 
   161        -7908.383             0.007            0.000 
   162        -7909.417             0.006            0.000 
   163        -7908.980             0.006            0.000 
   164        -7908.807             0.006            0.000 
   165        -7908.286             0.006            0.000 
   166        -7908.366             0.006            0.000 
   167        -7908.425             0.006            0.000 
   168        -7908.828             0.006            0.000 
   169        -7908.416             0.006            0.000 
   170        -7908.656             0.006            0.000 
   171        -7908.552             0.006            0.000 
   172        -7909.026             0.006            0.000 
   173        -7909.087             0.006            0.000 
   174        -7908.749             0.006            0.000 
   175        -7909.128             0.006            0.000 
   176        -7908.630             0.006            0.000 
   177        -7908.980             0.006            0.000 
   178        -7909.134             0.006            0.000 
   179        -7909.093             0.006            0.000 
   180        -7909.406             0.006            0.000 
   181        -7908.885             0.006            0.000 
   182        -7908.950             0.006            0.000 
   183        -7908.231             0.006            0.000 
   184        -7908.922             0.006            0.000 
   185        -7908.481             0.006            0.000 
   186        -7908.432             0.006            0.000 
   187        -7908.366             0.006            0.000 
   188        -7908.394             0.006            0.000 
   189        -7910.267             0.006            0.000 
   190        -7908.841             0.006            0.000 
   191        -7908.742             0.005            0.000 
   192        -7908.166             0.005            0.000 
   193        -7908.430             0.005            0.000 
   194        -7908.683             0.005            0.000 
   195        -7909.010             0.005            0.000 
   196        -7908.703             0.005            0.000 
   197        -7908.833             0.005            0.000   MEDIAN ELBO CONVERGED 
Drawing a sample of size 1000 from the approximate posterior...  
COMPLETED. 
Finished in  64.3 seconds.
[[1]]
[[1]]$w
             [,1]         [,2]
[1,] 0.9997771815 0.0002228185
[2,] 0.0001042058 0.9998957942
[3,] 0.9995724888 0.0004275112
[4,] 0.0001041865 0.9998958135
[5,] 0.9982287993 0.0017712007
[6,] 0.9989526429 0.0010473571

[[1]]$tau
[1] 0.55440151 0.06350898

[[1]]$phi
[1] 0.5 0.5

[[1]]$kappa
[1] 5


ELBO for this run: -7935.62
 mode of lp__ = unnormalized_log_lik = -7918.75last value = -7919.72 dimension of lp__ = 1000
  mode of lp__ = unnormalized_log_lik = -7918.75last value = -7919.72 dimension of lp__ = 1
 mode of lp_approx after rowSums = -7.44325 dimension of lp_approx__ = 1000
  mode of lp_approx after rowSums = -7.44325 dimension of lp_approx__ = 1
 mode of log_lik after rosSums = likelihood from generated quantities-7887.31707last value = -7887.4778dimension of log_lik = 1000
  mode of log_lik after rosSums = likelihood from generated quantities-7887.31707last value = -7887.4778dimension of log_lik = 2481
 [1] "w_ICL 0.99998"     "w_ICL 0.00378021"  "w_ICL 0.060887"   
 [4] "w_ICL 0.999921"    "w_ICL 0.999925"    "w_ICL 0.00651398" 
 [7] "w_ICL 0.000688715" "w_ICL 0.999946"    "w_ICL 0.999261"   
[10] "w_ICL 0.00073915"  "w_ICL 0.998988"    "w_ICL 0.00166605" 
 [1] "post 0.99998"     "post 0.00378021"  "post 0.060887"    "post 0.999921"   
 [5] "post 0.999925"    "post 0.00651398"  "post 0.000688715" "post 0.999946"   
 [9] "post 0.999261"    "post 0.00073915"  "post 0.998988"    "post 0.00166605" 
[1] "post_k 0.99998"
[1] "post_k_entr -0.0105448892767605"  "post_k_entr -0.00683992817952032"
[3] "post_k_entr -0.00537694354112292" "post_k_entr -0.0107158874812485" 
[5] "post_k_entr -0.00822691361592306" "post_k_entr -0.00543394294261892"
[1] "post_k_entr last step 0.0471385050371942"
[1] "res_entropy last step 0.0471385050371942"
[1] "post_k 0.00378021"
[1] "post_k_entr -11.7021304396734" "post_k_entr -7.59057109600436"
[3] "post_k_entr -5.96703227824787" "post_k_entr -11.8918947170735"
[5] "post_k_entr -9.12977023491635" "post_k_entr -6.03028703738124"
[1] "post_k_entr last step 52.3116858032967"
[1] "res_entropy last step 52.3588243083339"
[1] "entropy 52.3588243083339"
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Scale for x is already present.
Adding another scale for x, which will replace the existing scale.
Number of mutations per segment:    segment 1=555    segment 2=360    segment 3=283    segment 4=564    segment 5=433    segment 6=286 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
Number of mutations per segment:    1=575    2=379    3=290    4=581    5=445    6=293 `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
these are the peaks used to filter out mutations 
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
These are the Karyotypes extracted from the all_sim data, used in peaks
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
[1] 1 2 3 4 5 6
These are the Karyotypes directly from the simulation, used for peaks in the model
 [1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
These are the peaks which are passed in the inference task, more reliable let's say
          [,1]      [,2]
[1,] 0.2487437 0.4974874
[2,] 0.4950000 0.9900000
[3,] 0.4950000 0.9900000
[4,] 0.3311037 0.6622074
[5,] 0.3311037 0.6622074
[6,] 0.4950000 0.9900000
[1] "2:2" "2:0" "2:0" "2:1" "2:1" "2:0"
w = 0.999777181508229
  w = 0.000104205802406156
  w = 0.999572488820978
  w = 0.000104186506699219
  w = 0.998228799273881
  w = 0.998952642946481
  w = 0.000222818491771356
  w = 0.999895794197594
  w = 0.00042751117902171
  w = 0.999895813493301
  w = 0.00177120072611914
  w = 0.0010473570535189
 tau = 0.55440151346633
  tau = 0.0635089812217571
 phi = 0.5
  phi = 0.5
 kappa = 5[1] "These are the values used for initializing the model c(0.999777181508229, 0.000104205802406156, 0.999572488820978, 0.000104186506699219, 0.998228799273881, 0.998952642946481, 0.000222818491771356, 0.999895794197594, 0.00042751117902171, 0.999895813493301, 0.00177120072611914, 0.0010473570535189)"
[2] "These are the values used for initializing the model c(0.55440151346633, 0.0635089812217571)"                                                                                                                                                                                                            
[3] "These are the values used for initializing the model c(0.5, 0.5)"                                                                                                                                                                                                                                        
[4] "These are the values used for initializing the model 5"                                                                                                                                                                                                                                                  
Attempt 1 of 4
------------------------------------------------------------ 
EXPERIMENTAL ALGORITHM: 
  This procedure has not been thoroughly tested and may be unstable 
  or buggy. The interface is subject to change. 
------------------------------------------------------------ 
Gradient evaluation took 0.004209 seconds 
1000 transitions using 10 leapfrog steps per transition would take 42.09 seconds. 
Adjust your expectations accordingly! 
Begin eta adaptation. 
Iteration:   1 / 250 [  0%]  (Adaptation) 
Iteration:  50 / 250 [ 20%]  (Adaptation) 
